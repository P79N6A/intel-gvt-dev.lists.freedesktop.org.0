Delivered-To: linux.kernel.mailinglists@gmail.com
Received: by 2002:a81:3684:0:0:0:0:0 with SMTP id d126csp3168821ywa;
        Tue, 19 Feb 2019 03:02:02 -0800 (PST)
X-Google-Smtp-Source: AHgI3Ia96kEi7LLRbFuQ+ZMd8VHhAuoBFv8NwzSu5zLCYZOlUqeedCbSS+WD5B4jgc1mpFSIFYSP
X-Received: by 2002:a62:fc10:: with SMTP id e16mr29258740pfh.83.1550574121932;
        Tue, 19 Feb 2019 03:02:01 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1550574121; cv=none;
        d=google.com; s=arc-20160816;
        b=YEv0nQie4kXmQ6ZUlWuu3ACjnRZtrqQX0sUdHOLEU5rAXlRL0SxLHxwkZfcUFXLKVX
         P7Q1pJjY8hT5JGTOC1cQyEoyO4MeGBdw78RtMVrnIO9w5VrnbBMGWC0qa/ThXMvpFeHl
         KwSd16f2nc8zbRFKTEJC16YJu3DIXGQuBJF5rzDTwJUqN7ktNDvzSbkM1bYvp5WB4dcv
         /TQwM2SgkhUt7hdifwXeyz26d1Q/4Qz4WGVhs80PnnQkrTKFZiEXfWvoaIjy9yq+asRp
         nbPzfGKsc92sMxRSwEmVJmTXJYhnUMMmqDffT2j4zLN9dF/RPewMnZjj9sqE/cBzKJtK
         m0jA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-archive:list-unsubscribe:list-id
         :precedence:user-agent:in-reply-to:content-disposition:mime-version
         :references:message-id:subject:to:from:date:delivered-to;
        bh=OzNJcyhyE/apMhTWJAxiIwJ+l6a/kXsMmb/Meheg1DU=;
        b=nllKqYJsn1RI+q3ei49tuHzl3HSEzqA19BR/2FtSGPKU6NbpYqUW8jkVGZYYDcJqEh
         C8YpIKFNUHCyXg5srBKftNafMD+/C8eVyoYyfsCYNSfPka0tBwB+VaJ/G/WXZ5JaL93v
         yRTzrvcnu2eSCE2VEz+boC96Kyd8kaHp9eXaTsaLes/WTHqxrbFYzB3fGTGPPbc0JDOX
         yZwENuhCz98mdzDSaR+14V05DE7z+cnUFVJk/GlLKyQOlveVoFsNNZ3DuvMRXk6dwkOG
         RP7lkcX08GdUtFLaeDlRfl3uod2XkQwYVtUa+s7Z90tixgnN5Zzp25Eawx1FNAe0cOrR
         a0ig==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 2610:10:20:722:a800:ff:fe36:1795 as permitted sender) smtp.mailfrom=intel-gvt-dev-bounces@lists.freedesktop.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=redhat.com
Return-Path: <intel-gvt-dev-bounces@lists.freedesktop.org>
Received: from gabe.freedesktop.org (gabe.freedesktop.org. [2610:10:20:722:a800:ff:fe36:1795])
        by mx.google.com with ESMTPS id u19si7978767pga.567.2019.02.19.03.02.01
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Tue, 19 Feb 2019 03:02:01 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 2610:10:20:722:a800:ff:fe36:1795 as permitted sender) client-ip=2610:10:20:722:a800:ff:fe36:1795;
Authentication-Results: mx.google.com;
       spf=pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 2610:10:20:722:a800:ff:fe36:1795 as permitted sender) smtp.mailfrom=intel-gvt-dev-bounces@lists.freedesktop.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=redhat.com
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 27169892AD;
	Tue, 19 Feb 2019 11:02:01 +0000 (UTC)
X-Original-To: intel-gvt-dev@lists.freedesktop.org
Delivered-To: intel-gvt-dev@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 59371892A9
 for <intel-gvt-dev@lists.freedesktop.org>;
 Tue, 19 Feb 2019 11:01:59 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.phx2.redhat.com
 [10.5.11.16])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id E30F5C05D41E;
 Tue, 19 Feb 2019 11:01:57 +0000 (UTC)
Received: from work-vm (unknown [10.36.118.35])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id 579F6171F6;
 Tue, 19 Feb 2019 11:01:48 +0000 (UTC)
Date: Tue, 19 Feb 2019 11:01:45 +0000
From: "Dr. David Alan Gilbert" <dgilbert@redhat.com>
To: Yan Zhao <yan.y.zhao@intel.com>
Subject: Re: [PATCH 2/5] vfio/migration: support device of device config
 capability
Message-ID: <20190219110144.GA2941@work-vm>
References: <1550566254-3545-1-git-send-email-yan.y.zhao@intel.com>
 <1550566347-3648-1-git-send-email-yan.y.zhao@intel.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <1550566347-3648-1-git-send-email-yan.y.zhao@intel.com>
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.16
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.32]); Tue, 19 Feb 2019 11:01:58 +0000 (UTC)
X-BeenThere: intel-gvt-dev@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: "Intel GVT \(Graphics Virtualization\) development list"
 <intel-gvt-dev.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gvt-dev>
List-Post: <mailto:intel-gvt-dev@lists.freedesktop.org>
List-Help: <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=subscribe>
Cc: cjia@nvidia.com, kvm@vger.kernel.org, aik@ozlabs.ru,
 Zhengxiao.zx@alibaba-inc.com, shuangtai.tst@alibaba-inc.com,
 qemu-devel@nongnu.org, kwankhede@nvidia.com, eauger@redhat.com,
 yi.l.liu@intel.com, eskultet@redhat.com, ziye.yang@intel.com,
 mlevitsk@redhat.com, pasic@linux.ibm.com, arei.gonglei@huawei.com,
 felipe@nutanix.com, Ken.Xue@amd.com, kevin.tian@intel.com,
 alex.williamson@redhat.com, intel-gvt-dev@lists.freedesktop.org,
 changpeng.liu@intel.com, cohuck@redhat.com, zhi.a.wang@intel.com,
 jonathan.davies@nutanix.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gvt-dev-bounces@lists.freedesktop.org
Sender: "intel-gvt-dev" <intel-gvt-dev-bounces@lists.freedesktop.org>

KiBZYW4gWmhhbyAoeWFuLnkuemhhb0BpbnRlbC5jb20pIHdyb3RlOgo+IERldmljZSBjb25maWcg
aXMgdGhlIGRlZmF1bHQgZGF0YSB0aGF0IGV2ZXJ5IGRldmljZSBzaG91bGQgaGF2ZS4gc28KPiBk
ZXZpY2UgY29uZmlnIGNhcGFiaWxpdHkgaXMgYnkgZGVmYXVsdCBvbiwgbm8gbmVlZCB0byBzZXQu
Cj4gCj4gLSBDdXJyZW50bHkgdHdvIHR5cGUgb2YgcmVzb3VyY2VzIGFyZSBzYXZlZC9sb2FkZWQg
Zm9yIGRldmljZSBvZiBkZXZpY2UKPiAgIGNvbmZpZyBjYXBhYmlsaXR5Ogo+ICAgR2VuZXJhbCBQ
Q0kgY29uZmlnIGRhdGEsIGFuZCBEZXZpY2UgY29uZmlnIGRhdGEuCj4gICBUaGV5IGFyZSBjb3Bp
ZXMgYXMgYSB3aG9sZSB3aGVuIHByZWNvcHkgaXMgc3RvcHBlZC4KPiAKPiBNaWdyYXRpb24gc2V0
dXAgZmxvdzoKPiAtIFNldHVwIGRldmljZSBzdGF0ZSByZWdpb25zLCBjaGVjayBpdHMgZGV2aWNl
IHN0YXRlIHZlcnNpb24gYW5kIGNhcGFiaWxpdGllcy4KPiAgIE1tYXAgRGV2aWNlIENvbmZpZyBS
ZWdpb24gYW5kIERpcnR5IEJpdG1hcCBSZWdpb24sIGlmIGF2YWlsYWJsZS4KPiAtIElmIGRldmlj
ZSBzdGF0ZSByZWdpb25zIGFyZSBmYWlsZWQgdG8gZ2V0IHNldHVwLCBhIG1pZ3JhdGlvbiBibG9j
a2VyIGlzCj4gICByZWdpc3RlcmVkIGluc3RlYWQuCj4gLSBBZGRlZCBTYXZlVk1IYW5kbGVycyB0
byByZWdpc3RlciBkZXZpY2Ugc3RhdGUgc2F2ZS9sb2FkIGhhbmRsZXJzLgo+IC0gUmVnaXN0ZXIg
Vk0gc3RhdGUgY2hhbmdlIGhhbmRsZXIgdG8gc2V0IGRldmljZSdzIHJ1bm5pbmcvc3RvcCBzdGF0
ZXMuCj4gLSBPbiBtaWdyYXRpb24gc3RhcnR1cCBvbiBzb3VyY2UgbWFjaGluZSwgc2V0IGRldmlj
ZSdzIHN0YXRlIHRvCj4gICBWRklPX0RFVklDRV9TVEFURV9MT0dHSU5HCj4gCj4gU2lnbmVkLW9m
Zi1ieTogWWFuIFpoYW8gPHlhbi55LnpoYW9AaW50ZWwuY29tPgo+IFNpZ25lZC1vZmYtYnk6IFl1
bGVpIFpoYW5nIDx5dWxlaS56aGFuZ0BpbnRlbC5jb20+Cj4gLS0tCj4gIGh3L3ZmaW8vTWFrZWZp
bGUub2JqcyAgICAgICAgIHwgICAyICstCj4gIGh3L3ZmaW8vbWlncmF0aW9uLmMgICAgICAgICAg
IHwgNjMzICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwo+ICBody92
ZmlvL3BjaS5jICAgICAgICAgICAgICAgICB8ICAgMSAtCj4gIGh3L3ZmaW8vcGNpLmggICAgICAg
ICAgICAgICAgIHwgIDI1ICstCj4gIGluY2x1ZGUvaHcvdmZpby92ZmlvLWNvbW1vbi5oIHwgICAx
ICsKPiAgNSBmaWxlcyBjaGFuZ2VkLCA2NTkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkK
PiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGh3L3ZmaW8vbWlncmF0aW9uLmMKPiAKPiBkaWZmIC0tZ2l0
IGEvaHcvdmZpby9NYWtlZmlsZS5vYmpzIGIvaHcvdmZpby9NYWtlZmlsZS5vYmpzCj4gaW5kZXgg
OGIzZjY2NC4uZjMyZmYxOSAxMDA2NDQKPiAtLS0gYS9ody92ZmlvL01ha2VmaWxlLm9ianMKPiAr
KysgYi9ody92ZmlvL01ha2VmaWxlLm9ianMKPiBAQCAtMSw2ICsxLDYgQEAKPiAgaWZlcSAoJChD
T05GSUdfTElOVVgpLCB5KQo+ICBvYmotJChDT05GSUdfU09GVE1NVSkgKz0gY29tbW9uLm8KPiAt
b2JqLSQoQ09ORklHX1BDSSkgKz0gcGNpLm8gcGNpLXF1aXJrcy5vIGRpc3BsYXkubwo+ICtvYmot
JChDT05GSUdfUENJKSArPSBwY2kubyBwY2ktcXVpcmtzLm8gZGlzcGxheS5vIG1pZ3JhdGlvbi5v
Cj4gIG9iai0kKENPTkZJR19WRklPX0NDVykgKz0gY2N3Lm8KPiAgb2JqLSQoQ09ORklHX1NPRlRN
TVUpICs9IHBsYXRmb3JtLm8KPiAgb2JqLSQoQ09ORklHX1ZGSU9fWEdNQUMpICs9IGNhbHhlZGEt
eGdtYWMubwo+IGRpZmYgLS1naXQgYS9ody92ZmlvL21pZ3JhdGlvbi5jIGIvaHcvdmZpby9taWdy
YXRpb24uYwo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMC4uMTZkNjM5NQo+
IC0tLSAvZGV2L251bGwKPiArKysgYi9ody92ZmlvL21pZ3JhdGlvbi5jCj4gQEAgLTAsMCArMSw2
MzMgQEAKPiArI2luY2x1ZGUgInFlbXUvb3NkZXAuaCIKPiArCj4gKyNpbmNsdWRlICJody92Zmlv
L3ZmaW8tY29tbW9uLmgiCj4gKyNpbmNsdWRlICJtaWdyYXRpb24vYmxvY2tlci5oIgo+ICsjaW5j
bHVkZSAibWlncmF0aW9uL3JlZ2lzdGVyLmgiCj4gKyNpbmNsdWRlICJxYXBpL2Vycm9yLmgiCj4g
KyNpbmNsdWRlICJwY2kuaCIKPiArI2luY2x1ZGUgInN5c2VtdS9rdm0uaCIKPiArI2luY2x1ZGUg
ImV4ZWMvcmFtX2FkZHIuaCIKPiArCj4gKyNkZWZpbmUgVkZJT19TQVZFX0ZMQUdfU0VUVVAgMAo+
ICsjZGVmaW5lIFZGSU9fU0FWRV9GTEFHX1BDSSAxCj4gKyNkZWZpbmUgVkZJT19TQVZFX0ZMQUdf
REVWQ09ORklHIDIKPiArI2RlZmluZSBWRklPX1NBVkVfRkxBR19ERVZNRU1PUlkgNAo+ICsjZGVm
aW5lIFZGSU9fU0FWRV9GTEFHX0NPTlRJTlVFIDgKPiArCj4gK3N0YXRpYyBpbnQgdmZpb19kZXZp
Y2Vfc3RhdGVfcmVnaW9uX3NldHVwKFZGSU9QQ0lEZXZpY2UgKnZkZXYsCj4gKyAgICAgICAgVkZJ
T1JlZ2lvbiAqcmVnaW9uLCB1aW50MzJfdCBzdWJ0eXBlLCBjb25zdCBjaGFyICpuYW1lKQo+ICt7
Cj4gKyAgICBWRklPRGV2aWNlICp2YmFzZWRldiA9ICZ2ZGV2LT52YmFzZWRldjsKPiArICAgIHN0
cnVjdCB2ZmlvX3JlZ2lvbl9pbmZvICppbmZvOwo+ICsgICAgaW50IHJldDsKPiArCj4gKyAgICBy
ZXQgPSB2ZmlvX2dldF9kZXZfcmVnaW9uX2luZm8odmJhc2VkZXYsIFZGSU9fUkVHSU9OX1RZUEVf
REVWSUNFX1NUQVRFLAo+ICsgICAgICAgICAgICBzdWJ0eXBlLCAmaW5mbyk7Cj4gKyAgICBpZiAo
cmV0KSB7Cj4gKyAgICAgICAgZXJyb3JfcmVwb3J0KCJGYWlsZWQgdG8gZ2V0IGluZm8gb2YgcmVn
aW9uICVzIiwgbmFtZSk7Cj4gKyAgICAgICAgcmV0dXJuIHJldDsKPiArICAgIH0KPiArCj4gKyAg
ICBpZiAodmZpb19yZWdpb25fc2V0dXAoT0JKRUNUKHZkZXYpLCB2YmFzZWRldiwKPiArICAgICAg
ICAgICAgcmVnaW9uLCBpbmZvLT5pbmRleCwgbmFtZSkpIHsKPiArICAgICAgICBlcnJvcl9yZXBv
cnQoIkZhaWxlZCB0byBzZXR1cCBtaWdydGlvbiByZWdpb24gJXMiLCBuYW1lKTsKPiArICAgICAg
ICByZXR1cm4gcmV0Owo+ICsgICAgfQo+ICsKPiArICAgIGlmICh2ZmlvX3JlZ2lvbl9tbWFwKHJl
Z2lvbikpIHsKPiArICAgICAgICBlcnJvcl9yZXBvcnQoIkZhaWxlZCB0byBtbWFwIG1pZ3J0aW9u
IHJlZ2lvbiAlcyIsIG5hbWUpOwo+ICsgICAgfQo+ICsKPiArICAgIHJldHVybiAwOwo+ICt9Cj4g
Kwo+ICtib29sIHZmaW9fZGV2aWNlX2RhdGFfY2FwX3N5c3RlbV9tZW1vcnkoVkZJT1BDSURldmlj
ZSAqdmRldikKPiArewo+ICsgICByZXR1cm4gISEodmRldi0+bWlncmF0aW9uLT5kYXRhX2NhcHMg
JiBWRklPX0RFVklDRV9EQVRBX0NBUF9TWVNURU1fTUVNT1JZKTsKPiArfQo+ICsKPiArYm9vbCB2
ZmlvX2RldmljZV9kYXRhX2NhcF9kZXZpY2VfbWVtb3J5KFZGSU9QQ0lEZXZpY2UgKnZkZXYpCj4g
K3sKPiArICAgcmV0dXJuICEhKHZkZXYtPm1pZ3JhdGlvbi0+ZGF0YV9jYXBzICYgVkZJT19ERVZJ
Q0VfREFUQV9DQVBfREVWSUNFX01FTU9SWSk7Cj4gK30KPiArCj4gK3N0YXRpYyBib29sIHZmaW9f
ZGV2aWNlX3N0YXRlX3JlZ2lvbl9tbWFwZWQoVkZJT1JlZ2lvbiAqcmVnaW9uKQo+ICt7Cj4gKyAg
ICBib29sIG1tYXBlZCA9IHRydWU7Cj4gKyAgICBpZiAocmVnaW9uLT5ucl9tbWFwcyAhPSAxIHx8
IHJlZ2lvbi0+bW1hcHNbMF0ub2Zmc2V0IHx8Cj4gKyAgICAgICAgICAgIChyZWdpb24tPnNpemUg
IT0gcmVnaW9uLT5tbWFwc1swXS5zaXplKSB8fAo+ICsgICAgICAgICAgICAocmVnaW9uLT5tbWFw
c1swXS5tbWFwID09IE5VTEwpKSB7Cj4gKyAgICAgICAgbW1hcGVkID0gZmFsc2U7Cj4gKyAgICB9
Cj4gKwo+ICsgICAgcmV0dXJuIG1tYXBlZDsKPiArfQo+ICsKPiArc3RhdGljIGludCB2ZmlvX2dl
dF9kZXZpY2VfY29uZmlnX3NpemUoVkZJT1BDSURldmljZSAqdmRldikKPiArewo+ICsgICAgVkZJ
T0RldmljZSAqdmJhc2VkZXYgPSAmdmRldi0+dmJhc2VkZXY7Cj4gKyAgICBWRklPUmVnaW9uICpy
ZWdpb25fY3RsID0KPiArICAgICAgICAmdmRldi0+bWlncmF0aW9uLT5yZWdpb25bVkZJT19ERVZT
VEFURV9SRUdJT05fQ1RMXTsKPiArICAgIFZGSU9SZWdpb24gKnJlZ2lvbl9jb25maWcgPQo+ICsg
ICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9EQVRB
X0NPTkZJR107Cj4gKyAgICB1aW50NjRfdCBsZW47Cj4gKyAgICBpbnQgc3o7Cj4gKwo+ICsgICAg
c3ogPSBzaXplb2YobGVuKTsKPiArICAgIGlmIChwcmVhZCh2YmFzZWRldi0+ZmQsICZsZW4sIHN6
LAo+ICsgICAgICAgICAgICAgICAgcmVnaW9uX2N0bC0+ZmRfb2Zmc2V0ICsKPiArICAgICAgICAg
ICAgICAgIG9mZnNldG9mKHN0cnVjdCB2ZmlvX2RldmljZV9zdGF0ZV9jdGwsIGRldmljZV9jb25m
aWcuc2l6ZSkpCj4gKyAgICAgICAgICAgICE9IHN6KSB7Cj4gKyAgICAgICAgZXJyb3JfcmVwb3J0
KCJ2ZmlvOiBGYWlsZWQgdG8gZ2V0IGxlbmd0aCBvZiBkZXZpY2UgY29uZmlnIik7Cj4gKyAgICAg
ICAgcmV0dXJuIC0xOwo+ICsgICAgfQo+ICsgICAgaWYgKGxlbiA+IHJlZ2lvbl9jb25maWctPnNp
emUpIHsKPiArICAgICAgICBlcnJvcl9yZXBvcnQoInZmaW86IEVycm9yIGRldmljZSBjb25maWcg
bGVuZ3RoIik7Cj4gKyAgICAgICAgcmV0dXJuIC0xOwo+ICsgICAgfQo+ICsgICAgdmRldi0+bWln
cmF0aW9uLT5kZXZjb25maWdfc2l6ZSA9IGxlbjsKPiArCj4gKyAgICByZXR1cm4gMDsKPiArfQo+
ICsKPiArc3RhdGljIGludCB2ZmlvX3NldF9kZXZpY2VfY29uZmlnX3NpemUoVkZJT1BDSURldmlj
ZSAqdmRldiwgdWludDY0X3Qgc2l6ZSkKPiArewo+ICsgICAgVkZJT0RldmljZSAqdmJhc2VkZXYg
PSAmdmRldi0+dmJhc2VkZXY7Cj4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fY3RsID0KPiArICAg
ICAgICAmdmRldi0+bWlncmF0aW9uLT5yZWdpb25bVkZJT19ERVZTVEFURV9SRUdJT05fQ1RMXTsK
PiArICAgIFZGSU9SZWdpb24gKnJlZ2lvbl9jb25maWcgPQo+ICsgICAgICAgICZ2ZGV2LT5taWdy
YXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9EQVRBX0NPTkZJR107Cj4gKyAgICBp
bnQgc3o7Cj4gKwo+ICsgICAgaWYgKHNpemUgPiByZWdpb25fY29uZmlnLT5zaXplKSB7Cj4gKyAg
ICAgICAgcmV0dXJuIC0xOwo+ICsgICAgfQo+ICsKPiArICAgIHN6ID0gc2l6ZW9mKHNpemUpOwo+
ICsgICAgaWYgKHB3cml0ZSh2YmFzZWRldi0+ZmQsICZzaXplLCBzeiwKPiArICAgICAgICAgICAg
ICAgIHJlZ2lvbl9jdGwtPmZkX29mZnNldCArCj4gKyAgICAgICAgICAgICAgICBvZmZzZXRvZihz
dHJ1Y3QgdmZpb19kZXZpY2Vfc3RhdGVfY3RsLCBkZXZpY2VfY29uZmlnLnNpemUpKQo+ICsgICAg
ICAgICAgICAhPSBzeikgewo+ICsgICAgICAgIGVycm9yX3JlcG9ydCgidmZpbzogRmFpbGVkIHRv
IHNldCBsZW5ndGggb2YgZGV2aWNlIGNvbmZpZyIpOwo+ICsgICAgICAgIHJldHVybiAtMTsKPiAr
ICAgIH0KPiArICAgIHZkZXYtPm1pZ3JhdGlvbi0+ZGV2Y29uZmlnX3NpemUgPSBzaXplOwo+ICsg
ICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmZpb19zYXZlX2RhdGFfZGV2aWNl
X2NvbmZpZyhWRklPUENJRGV2aWNlICp2ZGV2LCBRRU1VRmlsZSAqZikKPiArewo+ICsgICAgVkZJ
T0RldmljZSAqdmJhc2VkZXYgPSAmdmRldi0+dmJhc2VkZXY7Cj4gKyAgICBWRklPUmVnaW9uICpy
ZWdpb25fY3RsID0KPiArICAgICAgICAmdmRldi0+bWlncmF0aW9uLT5yZWdpb25bVkZJT19ERVZT
VEFURV9SRUdJT05fQ1RMXTsKPiArICAgIFZGSU9SZWdpb24gKnJlZ2lvbl9jb25maWcgPQo+ICsg
ICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9EQVRB
X0NPTkZJR107Cj4gKyAgICB2b2lkICpkZXN0Owo+ICsgICAgdWludDMyX3Qgc3o7Cj4gKyAgICB1
aW50OF90ICpidWYgPSBOVUxMOwo+ICsgICAgdWludDMyX3QgYWN0aW9uID0gVkZJT19ERVZJQ0Vf
REFUQV9BQ1RJT05fR0VUX0JVRkZFUjsKPiArICAgIHVpbnQ2NF90IGxlbiA9IHZkZXYtPm1pZ3Jh
dGlvbi0+ZGV2Y29uZmlnX3NpemU7Cj4gKwo+ICsgICAgcWVtdV9wdXRfYmU2NChmLCBsZW4pOwo+
ICsKPiArICAgIHN6ID0gc2l6ZW9mKGFjdGlvbik7Cj4gKyAgICBpZiAocHdyaXRlKHZiYXNlZGV2
LT5mZCwgJmFjdGlvbiwgc3osCj4gKyAgICAgICAgICAgICAgICByZWdpb25fY3RsLT5mZF9vZmZz
ZXQgKwo+ICsgICAgICAgICAgICAgICAgb2Zmc2V0b2Yoc3RydWN0IHZmaW9fZGV2aWNlX3N0YXRl
X2N0bCwgZGV2aWNlX2NvbmZpZy5hY3Rpb24pKQo+ICsgICAgICAgICAgICAhPSBzeikgewo+ICsg
ICAgICAgIGVycm9yX3JlcG9ydCgidmZpbzogYWN0aW9uIGZhaWx1cmUgZm9yIGRldmljZSBjb25m
aWcgZ2V0IGJ1ZmZlciIpOwo+ICsgICAgICAgIHJldHVybiAtMTsKPiArICAgIH0KPiArCj4gKyAg
ICBpZiAoIXZmaW9fZGV2aWNlX3N0YXRlX3JlZ2lvbl9tbWFwZWQocmVnaW9uX2NvbmZpZykpIHsK
PiArICAgICAgICBidWYgPSBnX21hbGxvYyhsZW4pOwo+ICsgICAgICAgIGlmIChidWYgPT0gTlVM
TCkgewo+ICsgICAgICAgICAgICBlcnJvcl9yZXBvcnQoInZmaW86IEZhaWxlZCB0byBhbGxvY2F0
ZSBtZW1vcnkgZm9yIG1pZ3JhdGUiKTsKPiArICAgICAgICAgICAgcmV0dXJuIC0xOwo+ICsgICAg
ICAgIH0KCmdfbWFsbG9jIG5ldmVyIHJldHVybnMgTlVMTDsgaXQgYWJvcnRzIG9uIGZhaWx1cmUg
dG8gYWxsb2NhdGUuClNvIHlvdSBjYW4gZWl0aGVyIGRyb3AgdGhlIGNoZWNrLCBvciBteSBwcmVm
ZXJlbmNlIGlzIHRvIHVzZQpnX3RyeV9tYWxsb2MgZm9yIGxhcmdlL3Vua25vd24gYXJlYXMsIGFu
ZCBpdCBjYW4gcmV0dXJuIE5VTEwuCgo+ICsgICAgICAgIGlmIChwcmVhZCh2YmFzZWRldi0+ZmQs
IGJ1ZiwgbGVuLCByZWdpb25fY29uZmlnLT5mZF9vZmZzZXQpICE9IGxlbikgewo+ICsgICAgICAg
ICAgICBlcnJvcl9yZXBvcnQoInZmaW86IEZhaWxlZCByZWFkIGRldmljZSBjb25maWcgYnVmZmVy
Iik7Cj4gKyAgICAgICAgICAgIHJldHVybiAtMTsKPiArICAgICAgICB9Cj4gKyAgICAgICAgcWVt
dV9wdXRfYnVmZmVyKGYsIGJ1ZiwgbGVuKTsKPiArICAgICAgICBnX2ZyZWUoYnVmKTsKPiArICAg
IH0gZWxzZSB7Cj4gKyAgICAgICAgZGVzdCA9IHJlZ2lvbl9jb25maWctPm1tYXBzWzBdLm1tYXA7
Cj4gKyAgICAgICAgcWVtdV9wdXRfYnVmZmVyKGYsIGRlc3QsIGxlbik7Cj4gKyAgICB9Cj4gKyAg
ICByZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCB2ZmlvX2xvYWRfZGF0YV9kZXZpY2Vf
Y29uZmlnKFZGSU9QQ0lEZXZpY2UgKnZkZXYsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBRRU1VRmlsZSAqZiwgdWludDY0X3QgbGVuKQo+ICt7Cj4gKyAgICBWRklPRGV2aWNlICp2YmFz
ZWRldiA9ICZ2ZGV2LT52YmFzZWRldjsKPiArICAgIFZGSU9SZWdpb24gKnJlZ2lvbl9jdGwgPQo+
ICsgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9D
VExdOwo+ICsgICAgVkZJT1JlZ2lvbiAqcmVnaW9uX2NvbmZpZyA9Cj4gKyAgICAgICAgJnZkZXYt
Pm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9OX0RBVEFfQ09ORklHXTsKPiAr
ICAgIHZvaWQgKmRlc3Q7Cj4gKyAgICB1aW50MzJfdCBzejsKPiArICAgIHVpbnQ4X3QgKmJ1ZiA9
IE5VTEw7Cj4gKyAgICB1aW50MzJfdCBhY3Rpb24gPSBWRklPX0RFVklDRV9EQVRBX0FDVElPTl9T
RVRfQlVGRkVSOwo+ICsKPiArICAgIHZmaW9fc2V0X2RldmljZV9jb25maWdfc2l6ZSh2ZGV2LCBs
ZW4pOwo+ICsKPiArICAgIGlmICghdmZpb19kZXZpY2Vfc3RhdGVfcmVnaW9uX21tYXBlZChyZWdp
b25fY29uZmlnKSkgewo+ICsgICAgICAgIGJ1ZiA9IGdfbWFsbG9jKGxlbik7Cj4gKyAgICAgICAg
aWYgKGJ1ZiA9PSBOVUxMKSB7Cj4gKyAgICAgICAgICAgIGVycm9yX3JlcG9ydCgidmZpbzogRmFp
bGVkIHRvIGFsbG9jYXRlIG1lbW9yeSBmb3IgbWlncmF0ZSIpOwo+ICsgICAgICAgICAgICByZXR1
cm4gLTE7Cj4gKyAgICAgICAgfQo+ICsgICAgICAgIHFlbXVfZ2V0X2J1ZmZlcihmLCBidWYsIGxl
bik7Cj4gKyAgICAgICAgaWYgKHB3cml0ZSh2YmFzZWRldi0+ZmQsIGJ1ZiwgbGVuLAo+ICsgICAg
ICAgICAgICAgICAgICAgIHJlZ2lvbl9jb25maWctPmZkX29mZnNldCkgIT0gbGVuKSB7Cj4gKyAg
ICAgICAgICAgIGVycm9yX3JlcG9ydCgidmZpbzogRmFpbGVkIHRvIHdyaXRlIGRldmllIGNvbmZp
ZyBidWZmZXIiKTsKPiArICAgICAgICAgICAgcmV0dXJuIC0xOwo+ICsgICAgICAgIH0KPiArICAg
ICAgICBnX2ZyZWUoYnVmKTsKPiArICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgZGVzdCA9IHJlZ2lv
bl9jb25maWctPm1tYXBzWzBdLm1tYXA7Cj4gKyAgICAgICAgcWVtdV9nZXRfYnVmZmVyKGYsIGRl
c3QsIGxlbik7Cj4gKyAgICB9Cj4gKwo+ICsgICAgc3ogPSBzaXplb2YoYWN0aW9uKTsKPiArICAg
IGlmIChwd3JpdGUodmJhc2VkZXYtPmZkLCAmYWN0aW9uLCBzeiwKPiArICAgICAgICAgICAgICAg
IHJlZ2lvbl9jdGwtPmZkX29mZnNldCArCj4gKyAgICAgICAgICAgICAgICBvZmZzZXRvZihzdHJ1
Y3QgdmZpb19kZXZpY2Vfc3RhdGVfY3RsLCBkZXZpY2VfY29uZmlnLmFjdGlvbikpCj4gKyAgICAg
ICAgICAgICE9IHN6KSB7Cj4gKyAgICAgICAgZXJyb3JfcmVwb3J0KCJ2ZmlvOiBhY3Rpb24gZmFp
bHVyZSBmb3IgZGV2aWNlIGNvbmZpZyBzZXQgYnVmZmVyIik7Cj4gKyAgICAgICAgcmV0dXJuIC0x
Owo+ICsgICAgfQo+ICsKPiArICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZm
aW9fc2V0X2RpcnR5X3BhZ2VfYml0bWFwX2NodW5rKFZGSU9QQ0lEZXZpY2UgKnZkZXYsCj4gKyAg
ICAgICAgdWludDY0X3Qgc3RhcnRfYWRkciwgdWludDY0X3QgcGFnZV9ucikKPiArewo+ICsKPiAr
ICAgIFZGSU9EZXZpY2UgKnZiYXNlZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+ICsgICAgVkZJT1Jl
Z2lvbiAqcmVnaW9uX2N0bCA9Cj4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZG
SU9fREVWU1RBVEVfUkVHSU9OX0NUTF07Cj4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fYml0bWFw
ID0KPiArICAgICAgICAmdmRldi0+bWlncmF0aW9uLT5yZWdpb25bVkZJT19ERVZTVEFURV9SRUdJ
T05fREFUQV9CSVRNQVBdOwo+ICsgICAgdW5zaWduZWQgbG9uZyBiaXRtYXBfc2l6ZSA9Cj4gKyAg
ICAgICAgICAgICAgICAgICAgQklUU19UT19MT05HUyhwYWdlX25yKSAqIHNpemVvZih1bnNpZ25l
ZCBsb25nKTsKPiArICAgIHVpbnQzMl90IHN6Owo+ICsKPiArICAgIHN0cnVjdCB7Cj4gKyAgICAg
ICAgX191NjQgc3RhcnRfYWRkcjsKPiArICAgICAgICBfX3U2NCBwYWdlX25yOwo+ICsgICAgfSBz
eXN0ZW1fbWVtb3J5Owo+ICsgICAgc3lzdGVtX21lbW9yeS5zdGFydF9hZGRyID0gc3RhcnRfYWRk
cjsKPiArICAgIHN5c3RlbV9tZW1vcnkucGFnZV9uciA9IHBhZ2VfbnI7Cj4gKyAgICBzeiA9IHNp
emVvZihzeXN0ZW1fbWVtb3J5KTsKPiArICAgIGlmIChwd3JpdGUodmJhc2VkZXYtPmZkLCAmc3lz
dGVtX21lbW9yeSwgc3osCj4gKyAgICAgICAgICAgICAgICByZWdpb25fY3RsLT5mZF9vZmZzZXQg
Kwo+ICsgICAgICAgICAgICAgICAgb2Zmc2V0b2Yoc3RydWN0IHZmaW9fZGV2aWNlX3N0YXRlX2N0
bCwgc3lzdGVtX21lbW9yeSkpCj4gKyAgICAgICAgICAgICE9IHN6KSB7Cj4gKyAgICAgICAgZXJy
b3JfcmVwb3J0KCJ2ZmlvOiBGYWlsZWQgdG8gc2V0IHN5c3RlbSBtZW1vcnkgcmFuZ2UgZm9yIGRp
cnR5IHBhZ2VzIik7Cj4gKyAgICAgICAgcmV0dXJuIC0xOwo+ICsgICAgfQo+ICsKPiArICAgIGlm
ICghdmZpb19kZXZpY2Vfc3RhdGVfcmVnaW9uX21tYXBlZChyZWdpb25fYml0bWFwKSkgewo+ICsg
ICAgICAgIHZvaWQgKmJpdG1hcCA9IGdfbWFsbG9jMChiaXRtYXBfc2l6ZSk7Cj4gKwo+ICsgICAg
ICAgIGlmIChwcmVhZCh2YmFzZWRldi0+ZmQsIGJpdG1hcCwgYml0bWFwX3NpemUsCj4gKyAgICAg
ICAgICAgICAgICAgICAgcmVnaW9uX2JpdG1hcC0+ZmRfb2Zmc2V0KSAhPSBiaXRtYXBfc2l6ZSkg
ewo+ICsgICAgICAgICAgICBlcnJvcl9yZXBvcnQoInZmaW86IEZhaWxlZCB0byByZWFkIGRpcnR5
IGJpdG1hcCBkYXRhIik7Cj4gKyAgICAgICAgICAgIHJldHVybiAtMTsKPiArICAgICAgICB9Cj4g
Kwo+ICsgICAgICAgIGNwdV9waHlzaWNhbF9tZW1vcnlfc2V0X2RpcnR5X2xlYml0bWFwKGJpdG1h
cCwgc3RhcnRfYWRkciwgcGFnZV9ucik7Cj4gKwo+ICsgICAgICAgIGdfZnJlZShiaXRtYXApOwo+
ICsgICAgfSBlbHNlIHsKPiArICAgICAgICBjcHVfcGh5c2ljYWxfbWVtb3J5X3NldF9kaXJ0eV9s
ZWJpdG1hcCgKPiArICAgICAgICAgICAgICAgICAgICByZWdpb25fYml0bWFwLT5tbWFwc1swXS5t
bWFwLAo+ICsgICAgICAgICAgICAgICAgICAgIHN0YXJ0X2FkZHIsIHBhZ2VfbnIpOwo+ICsgICAg
fQo+ICsgICByZXR1cm4gMDsKPiArfQo+ICsKPiAraW50IHZmaW9fc2V0X2RpcnR5X3BhZ2VfYml0
bWFwKFZGSU9QQ0lEZXZpY2UgKnZkZXYsCj4gKyAgICAgICAgdWludDY0X3Qgc3RhcnRfYWRkciwg
dWludDY0X3QgcGFnZV9ucikKPiArewo+ICsgICAgVkZJT1JlZ2lvbiAqcmVnaW9uX2JpdG1hcCA9
Cj4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9O
X0RBVEFfQklUTUFQXTsKPiArICAgIHVuc2lnbmVkIGxvbmcgY2h1bmtfc2l6ZSA9IHJlZ2lvbl9i
aXRtYXAtPnNpemU7Cj4gKyAgICB1aW50NjRfdCBjaHVua19wZ19uciA9IChjaHVua19zaXplIC8g
c2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSAqCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgQklUU19QRVJfTE9ORzsKPiArCj4gKyAgICB1aW50NjRfdCBjbnRfbGVmdDsKPiArICAgIGlu
dCByYyA9IDA7Cj4gKwo+ICsgICAgY250X2xlZnQgPSBwYWdlX25yOwo+ICsKPiArICAgIHdoaWxl
IChjbnRfbGVmdCA+PSBjaHVua19wZ19ucikgewo+ICsgICAgICAgIHJjID0gdmZpb19zZXRfZGly
dHlfcGFnZV9iaXRtYXBfY2h1bmsodmRldiwgc3RhcnRfYWRkciwgY2h1bmtfcGdfbnIpOwo+ICsg
ICAgICAgIGlmIChyYykgewo+ICsgICAgICAgICAgICBnb3RvIGV4aXQ7Cj4gKyAgICAgICAgfQo+
ICsgICAgICAgIGNudF9sZWZ0IC09IGNodW5rX3BnX25yOwo+ICsgICAgICAgIHN0YXJ0X2FkZHIg
Kz0gc3RhcnRfYWRkcjsKPiArICAgfQo+ICsgICByYyA9IHZmaW9fc2V0X2RpcnR5X3BhZ2VfYml0
bWFwX2NodW5rKHZkZXYsIHN0YXJ0X2FkZHIsIGNudF9sZWZ0KTsKPiArCj4gK2V4aXQ6Cj4gKyAg
IHJldHVybiByYzsKPiArfQo+ICsKPiArc3RhdGljIGludCB2ZmlvX3NldF9kZXZpY2Vfc3RhdGUo
VkZJT1BDSURldmljZSAqdmRldiwKPiArICAgICAgICB1aW50MzJfdCBkZXZfc3RhdGUpCj4gK3sK
PiArICAgIFZGSU9EZXZpY2UgKnZiYXNlZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+ICsgICAgVkZJ
T1JlZ2lvbiAqcmVnaW9uID0KPiArICAgICAgICAmdmRldi0+bWlncmF0aW9uLT5yZWdpb25bVkZJ
T19ERVZTVEFURV9SRUdJT05fQ1RMXTsKPiArICAgIHVpbnQzMl90IHN6ID0gc2l6ZW9mKGRldl9z
dGF0ZSk7Cj4gKwo+ICsgICAgaWYgKCF2ZGV2LT5taWdyYXRpb24pIHsKPiArICAgICAgICByZXR1
cm4gLTE7Cj4gKyAgICB9Cj4gKwo+ICsgICAgaWYgKHB3cml0ZSh2YmFzZWRldi0+ZmQsICZkZXZf
c3RhdGUsIHN6LAo+ICsgICAgICAgICAgICAgIHJlZ2lvbi0+ZmRfb2Zmc2V0ICsKPiArICAgICAg
ICAgICAgICBvZmZzZXRvZihzdHJ1Y3QgdmZpb19kZXZpY2Vfc3RhdGVfY3RsLCBkZXZpY2Vfc3Rh
dGUpKQo+ICsgICAgICAgICAgICAhPSBzeikgewo+ICsgICAgICAgIGVycm9yX3JlcG9ydCgidmZp
bzogRmFpbGVkIHRvIHNldCBkZXZpY2Ugc3RhdGUgJWQiLCBkZXZfc3RhdGUpOwo+ICsgICAgICAg
IHJldHVybiAtMTsKPiArICAgIH0KPiArICAgIHZkZXYtPm1pZ3JhdGlvbi0+ZGV2aWNlX3N0YXRl
ID0gZGV2X3N0YXRlOwo+ICsgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmZp
b19nZXRfZGV2aWNlX2RhdGFfY2FwcyhWRklPUENJRGV2aWNlICp2ZGV2KQo+ICt7Cj4gKyAgICBW
RklPRGV2aWNlICp2YmFzZWRldiA9ICZ2ZGV2LT52YmFzZWRldjsKPiArICAgIFZGSU9SZWdpb24g
KnJlZ2lvbiA9Cj4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RB
VEVfUkVHSU9OX0NUTF07Cj4gKwo+ICsgICAgdWludDMyX3QgY2FwczsKPiArICAgIHVpbnQzMl90
IHNpemUgPSBzaXplb2YoY2Fwcyk7Cj4gKwo+ICsgICAgaWYgKHByZWFkKHZiYXNlZGV2LT5mZCwg
JmNhcHMsIHNpemUsCj4gKyAgICAgICAgICAgICAgICByZWdpb24tPmZkX29mZnNldCArCj4gKyAg
ICAgICAgICAgICAgICBvZmZzZXRvZihzdHJ1Y3QgdmZpb19kZXZpY2Vfc3RhdGVfY3RsLCBjYXBz
KSkKPiArICAgICAgICAgICAgIT0gc2l6ZSkgewo+ICsgICAgICAgIGVycm9yX3JlcG9ydCgiJXMg
RmFpbGVkIHRvIHJlYWQgZGF0YSBjYXBzIG9mIGRldmljZSBzdGF0ZXMiLAo+ICsgICAgICAgICAg
ICAgICAgdmJhc2VkZXYtPm5hbWUpOwo+ICsgICAgICAgIHJldHVybiAtMTsKPiArICAgIH0KPiAr
ICAgIHZkZXYtPm1pZ3JhdGlvbi0+ZGF0YV9jYXBzID0gY2FwczsKPiArICAgIHJldHVybiAwOwo+
ICt9Cj4gKwo+ICsKPiArc3RhdGljIGludCB2ZmlvX2NoZWNrX2RldnN0YXRlX3ZlcnNpb24oVkZJ
T1BDSURldmljZSAqdmRldikKPiArewo+ICsgICAgVkZJT0RldmljZSAqdmJhc2VkZXYgPSAmdmRl
di0+dmJhc2VkZXY7Cj4gKyAgICBWRklPUmVnaW9uICpyZWdpb24gPQo+ICsgICAgICAgICZ2ZGV2
LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9DVExdOwo+ICsKPiArICAg
IHVpbnQzMl90IHZlcnNpb247Cj4gKyAgICB1aW50MzJfdCBzaXplID0gc2l6ZW9mKHZlcnNpb24p
Owo+ICsKPiArICAgIGlmIChwcmVhZCh2YmFzZWRldi0+ZmQsICZ2ZXJzaW9uLCBzaXplLAo+ICsg
ICAgICAgICAgICAgICAgcmVnaW9uLT5mZF9vZmZzZXQgKwo+ICsgICAgICAgICAgICAgICAgb2Zm
c2V0b2Yoc3RydWN0IHZmaW9fZGV2aWNlX3N0YXRlX2N0bCwgdmVyc2lvbikpCj4gKyAgICAgICAg
ICAgICE9IHNpemUpIHsKPiArICAgICAgICBlcnJvcl9yZXBvcnQoIiVzIEZhaWxlZCB0byByZWFk
IHZlcnNpb24gb2YgZGV2aWNlIHN0YXRlIGludGVyZmFjZXMiLAo+ICsgICAgICAgICAgICAgICAg
dmJhc2VkZXYtPm5hbWUpOwo+ICsgICAgICAgIHJldHVybiAtMTsKPiArICAgIH0KPiArCj4gKyAg
ICBpZiAodmVyc2lvbiAhPSBWRklPX0RFVklDRV9TVEFURV9JTlRFUkZBQ0VfVkVSU0lPTikgewo+
ICsgICAgICAgIGVycm9yX3JlcG9ydCgiJXMgbWlncmF0aW9uIHZlcnNpb24gbWlzbWF0Y2gsIHJp
Z2h0IHZlcnNpb24gaXMgJWQiLAo+ICsgICAgICAgICAgICAgICAgdmJhc2VkZXYtPm5hbWUsIFZG
SU9fREVWSUNFX1NUQVRFX0lOVEVSRkFDRV9WRVJTSU9OKTsKPiArICAgICAgICByZXR1cm4gLTE7
Cj4gKyAgICB9Cj4gKwo+ICsgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZm
aW9fdm1fY2hhbmdlX3N0YXRlX2hhbmRsZXIodm9pZCAqcHYsIGludCBydW5uaW5nLCBSdW5TdGF0
ZSBzdGF0ZSkKPiArewo+ICsgICAgVkZJT1BDSURldmljZSAqdmRldiA9IHB2Owo+ICsgICAgdWlu
dDMyX3QgZGV2X3N0YXRlID0gdmRldi0+bWlncmF0aW9uLT5kZXZpY2Vfc3RhdGU7Cj4gKwo+ICsg
ICAgaWYgKCFydW5uaW5nKSB7Cj4gKyAgICAgICAgZGV2X3N0YXRlIHw9IFZGSU9fREVWSUNFX1NU
QVRFX1NUT1A7Cj4gKyAgICB9IGVsc2Ugewo+ICsgICAgICAgIGRldl9zdGF0ZSAmPSB+VkZJT19E
RVZJQ0VfU1RBVEVfU1RPUDsKPiArICAgIH0KPiArCj4gKyAgICB2ZmlvX3NldF9kZXZpY2Vfc3Rh
dGUodmRldiwgZGV2X3N0YXRlKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmZpb19zYXZlX2xp
dmVfcGVuZGluZyhRRU1VRmlsZSAqZiwgdm9pZCAqb3BhcXVlLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90IG1heF9zaXplLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90ICpyZXNfcHJlY29weV9vbmx5LAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90ICpyZXNfY29tcGF0aWJsZSwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCAqcmVzX3Bvc3RfY29w
eV9vbmx5KQo+ICt7Cj4gKyAgICBWRklPUENJRGV2aWNlICp2ZGV2ID0gb3BhcXVlOwo+ICsKPiAr
ICAgIGlmICghdmZpb19kZXZpY2VfZGF0YV9jYXBfZGV2aWNlX21lbW9yeSh2ZGV2KSkgewo+ICsg
ICAgICAgIHJldHVybjsKPiArICAgIH0KPiArCj4gKyAgICByZXR1cm47Cj4gK30KPiArCj4gK3N0
YXRpYyBpbnQgdmZpb19zYXZlX2l0ZXJhdGUoUUVNVUZpbGUgKmYsIHZvaWQgKm9wYXF1ZSkKPiAr
ewo+ICsgICAgVkZJT1BDSURldmljZSAqdmRldiA9IG9wYXF1ZTsKPiArCj4gKyAgICBpZiAoIXZm
aW9fZGV2aWNlX2RhdGFfY2FwX2RldmljZV9tZW1vcnkodmRldikpIHsKPiArICAgICAgICByZXR1
cm4gMDsKPiArICAgIH0KPiArCj4gKyAgICByZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZv
aWQgdmZpb19wY2lfbG9hZF9jb25maWcoVkZJT1BDSURldmljZSAqdmRldiwgUUVNVUZpbGUgKmYp
Cj4gK3sKPiArICAgIFBDSURldmljZSAqcGRldiA9ICZ2ZGV2LT5wZGV2Owo+ICsgICAgdWludDMy
X3QgY3RsLCBtc2lfbG8sIG1zaV9oaSwgbXNpX2RhdGEsIGJhcl9jZmcsIGk7Cj4gKyAgICBib29s
IG1zaV82NGJpdDsKPiArCj4gKyAgICAvKiByZXRvcmUgcGNpIGJhciBjb25maWd1cmF0aW9uICov
Cj4gKyAgICBjdGwgPSBwY2lfZGVmYXVsdF9yZWFkX2NvbmZpZyhwZGV2LCBQQ0lfQ09NTUFORCwg
Mik7Cj4gKyAgICB2ZmlvX3BjaV93cml0ZV9jb25maWcocGRldiwgUENJX0NPTU1BTkQsCj4gKyAg
ICAgICAgICAgIGN0bCAmICghKFBDSV9DT01NQU5EX0lPIHwgUENJX0NPTU1BTkRfTUVNT1JZKSks
IDIpOwo+ICsgICAgZm9yIChpID0gMDsgaSA8IFBDSV9ST01fU0xPVDsgaSsrKSB7Cj4gKyAgICAg
ICAgYmFyX2NmZyA9IHFlbXVfZ2V0X2JlMzIoZik7Cj4gKyAgICAgICAgdmZpb19wY2lfd3JpdGVf
Y29uZmlnKHBkZXYsIFBDSV9CQVNFX0FERFJFU1NfMCArIGkgKiA0LCBiYXJfY2ZnLCA0KTsKPiAr
ICAgIH0KPiArICAgIHZmaW9fcGNpX3dyaXRlX2NvbmZpZyhwZGV2LCBQQ0lfQ09NTUFORCwKPiAr
ICAgICAgICAgICAgY3RsIHwgUENJX0NPTU1BTkRfSU8gfCBQQ0lfQ09NTUFORF9NRU1PUlksIDIp
Owo+ICsKPiArICAgIC8qIHJlc3RvcmUgbXNpIGNvbmZpZ3VyYXRpb24gKi8KPiArICAgIGN0bCA9
IHBjaV9kZWZhdWx0X3JlYWRfY29uZmlnKHBkZXYsIHBkZXYtPm1zaV9jYXAgKyBQQ0lfTVNJX0ZM
QUdTLCAyKTsKPiArICAgIG1zaV82NGJpdCA9ICEhKGN0bCAmIFBDSV9NU0lfRkxBR1NfNjRCSVQp
Owo+ICsKPiArICAgIHZmaW9fcGNpX3dyaXRlX2NvbmZpZygmdmRldi0+cGRldiwKPiArICAgICAg
ICAgICAgcGRldi0+bXNpX2NhcCArIFBDSV9NU0lfRkxBR1MsCj4gKyAgICAgICAgICAgIGN0bCAm
ICghUENJX01TSV9GTEFHU19FTkFCTEUpLCAyKTsKPiArCj4gKyAgICBtc2lfbG8gPSBxZW11X2dl
dF9iZTMyKGYpOwo+ICsgICAgdmZpb19wY2lfd3JpdGVfY29uZmlnKHBkZXYsIHBkZXYtPm1zaV9j
YXAgKyBQQ0lfTVNJX0FERFJFU1NfTE8sIG1zaV9sbywgNCk7Cj4gKwo+ICsgICAgaWYgKG1zaV82
NGJpdCkgewo+ICsgICAgICAgIG1zaV9oaSA9IHFlbXVfZ2V0X2JlMzIoZik7Cj4gKyAgICAgICAg
dmZpb19wY2lfd3JpdGVfY29uZmlnKHBkZXYsIHBkZXYtPm1zaV9jYXAgKyBQQ0lfTVNJX0FERFJF
U1NfSEksCj4gKyAgICAgICAgICAgICAgICBtc2lfaGksIDQpOwo+ICsgICAgfQo+ICsgICAgbXNp
X2RhdGEgPSBxZW11X2dldF9iZTMyKGYpOwo+ICsgICAgdmZpb19wY2lfd3JpdGVfY29uZmlnKHBk
ZXYsCj4gKyAgICAgICAgICAgIHBkZXYtPm1zaV9jYXAgKyAobXNpXzY0Yml0ID8gUENJX01TSV9E
QVRBXzY0IDogUENJX01TSV9EQVRBXzMyKSwKPiArICAgICAgICAgICAgbXNpX2RhdGEsIDIpOwo+
ICsKPiArICAgIHZmaW9fcGNpX3dyaXRlX2NvbmZpZygmdmRldi0+cGRldiwgcGRldi0+bXNpX2Nh
cCArIFBDSV9NU0lfRkxBR1MsCj4gKyAgICAgICAgICAgIGN0bCB8IFBDSV9NU0lfRkxBR1NfRU5B
QkxFLCAyKTsKCkl0IHdvdWxkIHByb2JhYmx5IGJlIGJlc3QgdG8gdXNlIGEgVk1TdGF0ZURlc2Ny
aXB0aW9uIGFuZCB0aGUgbWFjcm9zCmZvciB0aGlzIGlmIHBvc3NpYmxlOyBJIGJldCB5b3UnbGwg
d2FudCB0byBhZGQgbW9yZSBmaWVsZHMgaW4gdGhlIGZ1dHVyZQpmb3IgZXhhbXBsZS4KQWxzbyB3
aGF0IGhhcHBlbnMgaWYgdGhlIGRhdGEgcmVhZCBmcm9tIHRoZSBtaWdyYXRpb24gc3RyZWFtIGlz
IGJhZCBvcgpkb2Vzbid0IGFncmVlIHdpdGggdGhpcyBkZXZpY2VzIGhhcmR3YXJlPyBIb3cgZG9l
cyB0aGlzIGZhaWw/Cgo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZmaW9fbG9hZF9zdGF0ZShRRU1V
RmlsZSAqZiwgdm9pZCAqb3BhcXVlLCBpbnQgdmVyc2lvbl9pZCkKPiArewo+ICsgICAgVkZJT1BD
SURldmljZSAqdmRldiA9IG9wYXF1ZTsKPiArICAgIGludCBmbGFnOwo+ICsgICAgdWludDY0X3Qg
bGVuOwo+ICsgICAgaW50IHJldCA9IDA7Cj4gKwo+ICsgICAgaWYgKHZlcnNpb25faWQgIT0gVkZJ
T19ERVZJQ0VfU1RBVEVfSU5URVJGQUNFX1ZFUlNJT04pIHsKPiArICAgICAgICByZXR1cm4gLUVJ
TlZBTDsKPiArICAgIH0KPiArCj4gKyAgICBkbyB7Cj4gKyAgICAgICAgZmxhZyA9IHFlbXVfZ2V0
X2J5dGUoZik7Cj4gKwo+ICsgICAgICAgIHN3aXRjaCAoZmxhZyAmIH5WRklPX1NBVkVfRkxBR19D
T05USU5VRSkgewo+ICsgICAgICAgIGNhc2UgVkZJT19TQVZFX0ZMQUdfU0VUVVA6Cj4gKyAgICAg
ICAgICAgIGJyZWFrOwo+ICsgICAgICAgIGNhc2UgVkZJT19TQVZFX0ZMQUdfUENJOgo+ICsgICAg
ICAgICAgICB2ZmlvX3BjaV9sb2FkX2NvbmZpZyh2ZGV2LCBmKTsKPiArICAgICAgICAgICAgYnJl
YWs7Cj4gKyAgICAgICAgY2FzZSBWRklPX1NBVkVfRkxBR19ERVZDT05GSUc6Cj4gKyAgICAgICAg
ICAgIGxlbiA9IHFlbXVfZ2V0X2JlNjQoZik7Cj4gKyAgICAgICAgICAgIHZmaW9fbG9hZF9kYXRh
X2RldmljZV9jb25maWcodmRldiwgZiwgbGVuKTsKPiArICAgICAgICAgICAgYnJlYWs7Cj4gKyAg
ICAgICAgZGVmYXVsdDoKPiArICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsKPiArICAgICAgICB9
Cj4gKyAgICB9IHdoaWxlIChmbGFnICYgVkZJT19TQVZFX0ZMQUdfQ09OVElOVUUpOwo+ICsKPiAr
ICAgIHJldHVybiByZXQ7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZmaW9fcGNpX3NhdmVfY29u
ZmlnKFZGSU9QQ0lEZXZpY2UgKnZkZXYsIFFFTVVGaWxlICpmKQo+ICt7Cj4gKyAgICBQQ0lEZXZp
Y2UgKnBkZXYgPSAmdmRldi0+cGRldjsKPiArICAgIHVpbnQzMl90IG1zaV9jZmcsIG1zaV9sbywg
bXNpX2hpLCBtc2lfZGF0YSwgYmFyX2NmZywgaTsKPiArICAgIGJvb2wgbXNpXzY0Yml0Owo+ICsK
PiArICAgIGZvciAoaSA9IDA7IGkgPCBQQ0lfUk9NX1NMT1Q7IGkrKykgewo+ICsgICAgICAgIGJh
cl9jZmcgPSBwY2lfZGVmYXVsdF9yZWFkX2NvbmZpZyhwZGV2LCBQQ0lfQkFTRV9BRERSRVNTXzAg
KyBpICogNCwgNCk7Cj4gKyAgICAgICAgcWVtdV9wdXRfYmUzMihmLCBiYXJfY2ZnKTsKPiArICAg
IH0KPiArCj4gKyAgICBtc2lfY2ZnID0gcGNpX2RlZmF1bHRfcmVhZF9jb25maWcocGRldiwgcGRl
di0+bXNpX2NhcCArIFBDSV9NU0lfRkxBR1MsIDIpOwo+ICsgICAgbXNpXzY0Yml0ID0gISEobXNp
X2NmZyAmIFBDSV9NU0lfRkxBR1NfNjRCSVQpOwo+ICsKPiArICAgIG1zaV9sbyA9IHBjaV9kZWZh
dWx0X3JlYWRfY29uZmlnKHBkZXYsCj4gKyAgICAgICAgICAgIHBkZXYtPm1zaV9jYXAgKyBQQ0lf
TVNJX0FERFJFU1NfTE8sIDQpOwo+ICsgICAgcWVtdV9wdXRfYmUzMihmLCBtc2lfbG8pOwo+ICsK
PiArICAgIGlmIChtc2lfNjRiaXQpIHsKPiArICAgICAgICBtc2lfaGkgPSBwY2lfZGVmYXVsdF9y
ZWFkX2NvbmZpZyhwZGV2LAo+ICsgICAgICAgICAgICAgICAgcGRldi0+bXNpX2NhcCArIFBDSV9N
U0lfQUREUkVTU19ISSwKPiArICAgICAgICAgICAgICAgIDQpOwo+ICsgICAgICAgIHFlbXVfcHV0
X2JlMzIoZiwgbXNpX2hpKTsKPiArICAgIH0KPiArCj4gKyAgICBtc2lfZGF0YSA9IHBjaV9kZWZh
dWx0X3JlYWRfY29uZmlnKHBkZXYsCj4gKyAgICAgICAgICAgIHBkZXYtPm1zaV9jYXAgKyAobXNp
XzY0Yml0ID8gUENJX01TSV9EQVRBXzY0IDogUENJX01TSV9EQVRBXzMyKSwKPiArICAgICAgICAg
ICAgMik7Cj4gKyAgICBxZW11X3B1dF9iZTMyKGYsIG1zaV9kYXRhKTsKPiArCj4gK30KPiArCj4g
K3N0YXRpYyBpbnQgdmZpb19zYXZlX2NvbXBsZXRlX3ByZWNvcHkoUUVNVUZpbGUgKmYsIHZvaWQg
Km9wYXF1ZSkKPiArewo+ICsgICAgVkZJT1BDSURldmljZSAqdmRldiA9IG9wYXF1ZTsKPiArICAg
IGludCByYyA9IDA7Cj4gKwo+ICsgICAgcWVtdV9wdXRfYnl0ZShmLCBWRklPX1NBVkVfRkxBR19Q
Q0kgfCBWRklPX1NBVkVfRkxBR19DT05USU5VRSk7Cj4gKyAgICB2ZmlvX3BjaV9zYXZlX2NvbmZp
Zyh2ZGV2LCBmKTsKPiArCj4gKyAgICBxZW11X3B1dF9ieXRlKGYsIFZGSU9fU0FWRV9GTEFHX0RF
VkNPTkZJRyk7Cj4gKyAgICByYyArPSB2ZmlvX2dldF9kZXZpY2VfY29uZmlnX3NpemUodmRldik7
Cj4gKyAgICByYyArPSB2ZmlvX3NhdmVfZGF0YV9kZXZpY2VfY29uZmlnKHZkZXYsIGYpOwo+ICsK
PiArICAgIHJldHVybiByYzsKPiArfQo+ICsKPiArc3RhdGljIGludCB2ZmlvX3NhdmVfc2V0dXAo
UUVNVUZpbGUgKmYsIHZvaWQgKm9wYXF1ZSkKPiArewo+ICsgICAgVkZJT1BDSURldmljZSAqdmRl
diA9IG9wYXF1ZTsKPiArICAgIHFlbXVfcHV0X2J5dGUoZiwgVkZJT19TQVZFX0ZMQUdfU0VUVVAp
Owo+ICsKPiArICAgIHZmaW9fc2V0X2RldmljZV9zdGF0ZSh2ZGV2LCBWRklPX0RFVklDRV9TVEFU
RV9SVU5OSU5HIHwKPiArICAgICAgICAgICAgVkZJT19ERVZJQ0VfU1RBVEVfTE9HR0lORyk7Cj4g
KyAgICByZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCB2ZmlvX2xvYWRfc2V0dXAoUUVN
VUZpbGUgKmYsIHZvaWQgKm9wYXF1ZSkKPiArewo+ICsgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4g
K3N0YXRpYyB2b2lkIHZmaW9fc2F2ZV9jbGVhbnVwKHZvaWQgKm9wYXF1ZSkKPiArewo+ICsgICAg
VkZJT1BDSURldmljZSAqdmRldiA9IG9wYXF1ZTsKPiArICAgIHVpbnQzMl90IGRldl9zdGF0ZSA9
IHZkZXYtPm1pZ3JhdGlvbi0+ZGV2aWNlX3N0YXRlOwo+ICsKPiArICAgIGRldl9zdGF0ZSAmPSB+
VkZJT19ERVZJQ0VfU1RBVEVfTE9HR0lORzsKPiArCj4gKyAgICB2ZmlvX3NldF9kZXZpY2Vfc3Rh
dGUodmRldiwgZGV2X3N0YXRlKTsKPiArfQo+ICsKPiArc3RhdGljIFNhdmVWTUhhbmRsZXJzIHNh
dmV2bV92ZmlvX2hhbmRsZXJzID0gewo+ICsgICAgLnNhdmVfc2V0dXAgPSB2ZmlvX3NhdmVfc2V0
dXAsCj4gKyAgICAuc2F2ZV9saXZlX3BlbmRpbmcgPSB2ZmlvX3NhdmVfbGl2ZV9wZW5kaW5nLAo+
ICsgICAgLnNhdmVfbGl2ZV9pdGVyYXRlID0gdmZpb19zYXZlX2l0ZXJhdGUsCj4gKyAgICAuc2F2
ZV9saXZlX2NvbXBsZXRlX3ByZWNvcHkgPSB2ZmlvX3NhdmVfY29tcGxldGVfcHJlY29weSwKPiAr
ICAgIC5zYXZlX2NsZWFudXAgPSB2ZmlvX3NhdmVfY2xlYW51cCwKPiArICAgIC5sb2FkX3NldHVw
ID0gdmZpb19sb2FkX3NldHVwLAo+ICsgICAgLmxvYWRfc3RhdGUgPSB2ZmlvX2xvYWRfc3RhdGUs
Cj4gK307Cj4gKwo+ICtpbnQgdmZpb19taWdyYXRpb25faW5pdChWRklPUENJRGV2aWNlICp2ZGV2
LCBFcnJvciAqKmVycnApCj4gK3sKPiArICAgIGludCByZXQ7Cj4gKyAgICBFcnJvciAqbG9jYWxf
ZXJyID0gTlVMTDsKPiArICAgIHZkZXYtPm1pZ3JhdGlvbiA9IGdfbmV3MChWRklPTWlncmF0aW9u
LCAxKTsKPiArCj4gKyAgICBpZiAodmZpb19kZXZpY2Vfc3RhdGVfcmVnaW9uX3NldHVwKHZkZXYs
Cj4gKyAgICAgICAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVf
UkVHSU9OX0NUTF0sCj4gKyAgICAgICAgICAgICAgVkZJT19SRUdJT05fU1VCVFlQRV9ERVZJQ0Vf
U1RBVEVfQ1RMLAo+ICsgICAgICAgICAgICAgICJkZXZpY2Utc3RhdGUtY3RsIikpIHsKPiArICAg
ICAgICBnb3RvIGVycm9yOwo+ICsgICAgfQo+ICsKPiArICAgIGlmICh2ZmlvX2NoZWNrX2RldnN0
YXRlX3ZlcnNpb24odmRldikpIHsKPiArICAgICAgICBnb3RvIGVycm9yOwo+ICsgICAgfQo+ICsK
PiArICAgIGlmICh2ZmlvX2dldF9kZXZpY2VfZGF0YV9jYXBzKHZkZXYpKSB7Cj4gKyAgICAgICAg
Z290byBlcnJvcjsKPiArICAgIH0KPiArCj4gKyAgICBpZiAodmZpb19kZXZpY2Vfc3RhdGVfcmVn
aW9uX3NldHVwKHZkZXYsCj4gKyAgICAgICAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9u
W1ZGSU9fREVWU1RBVEVfUkVHSU9OX0RBVEFfQ09ORklHXSwKPiArICAgICAgICAgICAgICBWRklP
X1JFR0lPTl9TVUJUWVBFX0RFVklDRV9TVEFURV9EQVRBX0NPTkZJRywKPiArICAgICAgICAgICAg
ICAiZGV2aWNlLXN0YXRlLWRhdGEtZGV2aWNlLWNvbmZpZyIpKSB7Cj4gKyAgICAgICAgZ290byBl
cnJvcjsKPiArICAgIH0KPiArCj4gKyAgICBpZiAodmZpb19kZXZpY2VfZGF0YV9jYXBfZGV2aWNl
X21lbW9yeSh2ZGV2KSkgewo+ICsgICAgICAgIGVycm9yX3JlcG9ydCgiTm8gc3VwcHBvcnQgb2Yg
ZGF0YSBjYXAgZGV2aWNlIG1lbW9yeSBZZXQiKTsKPiArICAgICAgICBnb3RvIGVycm9yOwo+ICsg
ICAgfQo+ICsKPiArICAgIGlmICh2ZmlvX2RldmljZV9kYXRhX2NhcF9zeXN0ZW1fbWVtb3J5KHZk
ZXYpICYmCj4gKyAgICAgICAgICAgIHZmaW9fZGV2aWNlX3N0YXRlX3JlZ2lvbl9zZXR1cCh2ZGV2
LAo+ICsgICAgICAgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRF
X1JFR0lPTl9EQVRBX0JJVE1BUF0sCj4gKyAgICAgICAgICAgICAgVkZJT19SRUdJT05fU1VCVFlQ
RV9ERVZJQ0VfU1RBVEVfREFUQV9ESVJUWUJJVE1BUCwKPiArICAgICAgICAgICAgICAiZGV2aWNl
LXN0YXRlLWRhdGEtZGlydHliaXRtYXAiKSkgewo+ICsgICAgICAgIGdvdG8gZXJyb3I7Cj4gKyAg
ICB9Cj4gKwo+ICsgICAgdmRldi0+bWlncmF0aW9uLT5kZXZpY2Vfc3RhdGUgPSBWRklPX0RFVklD
RV9TVEFURV9SVU5OSU5HOwo+ICsKPiArICAgIHJlZ2lzdGVyX3NhdmV2bV9saXZlKE5VTEwsIFRZ
UEVfVkZJT19QQ0ksIC0xLAo+ICsgICAgICAgICAgICBWRklPX0RFVklDRV9TVEFURV9JTlRFUkZB
Q0VfVkVSU0lPTiwKPiArICAgICAgICAgICAgJnNhdmV2bV92ZmlvX2hhbmRsZXJzLAo+ICsgICAg
ICAgICAgICB2ZGV2KTsKPiArCj4gKyAgICB2ZGV2LT5taWdyYXRpb24tPnZtX3N0YXRlID0KPiAr
ICAgICAgICBxZW11X2FkZF92bV9jaGFuZ2Vfc3RhdGVfaGFuZGxlcih2ZmlvX3ZtX2NoYW5nZV9z
dGF0ZV9oYW5kbGVyLCB2ZGV2KTsKPiArCj4gKyAgICByZXR1cm4gMDsKPiArZXJyb3I6Cj4gKyAg
ICBlcnJvcl9zZXRnKCZ2ZGV2LT5taWdyYXRpb25fYmxvY2tlciwKPiArICAgICAgICAgICAgIlZG
SU8gZGV2aWNlIGRvZXNuJ3Qgc3VwcG9ydCBtaWdyYXRpb24iKTsKPiArICAgIHJldCA9IG1pZ3Jh
dGVfYWRkX2Jsb2NrZXIodmRldi0+bWlncmF0aW9uX2Jsb2NrZXIsICZsb2NhbF9lcnIpOwo+ICsg
ICAgaWYgKGxvY2FsX2Vycikgewo+ICsgICAgICAgIGVycm9yX3Byb3BhZ2F0ZShlcnJwLCBsb2Nh
bF9lcnIpOwo+ICsgICAgICAgIGVycm9yX2ZyZWUodmRldi0+bWlncmF0aW9uX2Jsb2NrZXIpOwo+
ICsgICAgfQo+ICsKPiArICAgIGdfZnJlZSh2ZGV2LT5taWdyYXRpb24pOwo+ICsgICAgdmRldi0+
bWlncmF0aW9uID0gTlVMTDsKPiArCj4gKyAgICByZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICt2b2lk
IHZmaW9fbWlncmF0aW9uX2ZpbmFsaXplKFZGSU9QQ0lEZXZpY2UgKnZkZXYpCj4gK3sKPiArICAg
IGlmICh2ZGV2LT5taWdyYXRpb24pIHsKPiArICAgICAgICBpbnQgaTsKPiArICAgICAgICBxZW11
X2RlbF92bV9jaGFuZ2Vfc3RhdGVfaGFuZGxlcih2ZGV2LT5taWdyYXRpb24tPnZtX3N0YXRlKTsK
PiArICAgICAgICB1bnJlZ2lzdGVyX3NhdmV2bShOVUxMLCBUWVBFX1ZGSU9fUENJLCB2ZGV2KTsK
PiArICAgICAgICBmb3IgKGkgPSAwOyBpIDwgVkZJT19ERVZTVEFURV9SRUdJT05fTlVNOyBpKysp
IHsKPiArICAgICAgICAgICAgdmZpb19yZWdpb25fZmluYWxpemUoJnZkZXYtPm1pZ3JhdGlvbi0+
cmVnaW9uW2ldKTsKPiArICAgICAgICB9Cj4gKyAgICAgICAgZ19mcmVlKHZkZXYtPm1pZ3JhdGlv
bik7Cj4gKyAgICAgICAgdmRldi0+bWlncmF0aW9uID0gTlVMTDsKPiArICAgIH0gZWxzZSBpZiAo
dmRldi0+bWlncmF0aW9uX2Jsb2NrZXIpIHsKPiArICAgICAgICBtaWdyYXRlX2RlbF9ibG9ja2Vy
KHZkZXYtPm1pZ3JhdGlvbl9ibG9ja2VyKTsKPiArICAgICAgICBlcnJvcl9mcmVlKHZkZXYtPm1p
Z3JhdGlvbl9ibG9ja2VyKTsKPiArICAgIH0KPiArfQo+IGRpZmYgLS1naXQgYS9ody92ZmlvL3Bj
aS5jIGIvaHcvdmZpby9wY2kuYwo+IGluZGV4IGMwY2IxZWMuLmI4ZTAwNmIgMTAwNjQ0Cj4gLS0t
IGEvaHcvdmZpby9wY2kuYwo+ICsrKyBiL2h3L3ZmaW8vcGNpLmMKPiBAQCAtMzcsNyArMzcsNiBA
QAo+ICAKPiAgI2RlZmluZSBNU0lYX0NBUF9MRU5HVEggMTIKPiAgCj4gLSNkZWZpbmUgVFlQRV9W
RklPX1BDSSAidmZpby1wY2kiCj4gICNkZWZpbmUgUENJX1ZGSU8ob2JqKSAgICBPQkpFQ1RfQ0hF
Q0soVkZJT1BDSURldmljZSwgb2JqLCBUWVBFX1ZGSU9fUENJKQo+ICAKPiAgc3RhdGljIHZvaWQg
dmZpb19kaXNhYmxlX2ludGVycnVwdHMoVkZJT1BDSURldmljZSAqdmRldik7Cj4gZGlmZiAtLWdp
dCBhL2h3L3ZmaW8vcGNpLmggYi9ody92ZmlvL3BjaS5oCj4gaW5kZXggYjFhZTRjMC4uNGI3YjFi
YiAxMDA2NDQKPiAtLS0gYS9ody92ZmlvL3BjaS5oCj4gKysrIGIvaHcvdmZpby9wY2kuaAo+IEBA
IC0xOSw2ICsxOSw3IEBACj4gICNpbmNsdWRlICJxZW11L2V2ZW50X25vdGlmaWVyLmgiCj4gICNp
bmNsdWRlICJxZW11L3F1ZXVlLmgiCj4gICNpbmNsdWRlICJxZW11L3RpbWVyLmgiCj4gKyNpbmNs
dWRlICJzeXNlbXUvc3lzZW11LmgiCj4gIAo+ICAjZGVmaW5lIFBDSV9BTllfSUQgKH4wKQo+ICAK
PiBAQCAtNTYsNiArNTcsMjEgQEAgdHlwZWRlZiBzdHJ1Y3QgVkZJT0JBUiB7Cj4gICAgICBRTElT
VF9IRUFEKCwgVkZJT1F1aXJrKSBxdWlya3M7Cj4gIH0gVkZJT0JBUjsKPiAgCj4gK2VudW0gewo+
ICsgICAgVkZJT19ERVZTVEFURV9SRUdJT05fQ1RMID0gMCwKPiArICAgIFZGSU9fREVWU1RBVEVf
UkVHSU9OX0RBVEFfQ09ORklHLAo+ICsgICAgVkZJT19ERVZTVEFURV9SRUdJT05fREFUQV9ERVZJ
Q0VfTUVNT1JZLAo+ICsgICAgVkZJT19ERVZTVEFURV9SRUdJT05fREFUQV9CSVRNQVAsCj4gKyAg
ICBWRklPX0RFVlNUQVRFX1JFR0lPTl9OVU0sCj4gK307Cj4gK3R5cGVkZWYgc3RydWN0IFZGSU9N
aWdyYXRpb24gewo+ICsgICAgVkZJT1JlZ2lvbiByZWdpb25bVkZJT19ERVZTVEFURV9SRUdJT05f
TlVNXTsKPiArICAgIHVpbnQzMl90IGRhdGFfY2FwczsKPiArICAgIHVpbnQzMl90IGRldmljZV9z
dGF0ZTsKPiArICAgIHVpbnQ2NF90IGRldmNvbmZpZ19zaXplOwo+ICsgICAgVk1DaGFuZ2VTdGF0
ZUVudHJ5ICp2bV9zdGF0ZTsKPiArfSBWRklPTWlncmF0aW9uOwo+ICsKPiAgdHlwZWRlZiBzdHJ1
Y3QgVkZJT1ZHQVJlZ2lvbiB7Cj4gICAgICBNZW1vcnlSZWdpb24gbWVtOwo+ICAgICAgb2ZmX3Qg
b2Zmc2V0Owo+IEBAIC0xMzIsNiArMTQ4LDggQEAgdHlwZWRlZiBzdHJ1Y3QgVkZJT1BDSURldmlj
ZSB7Cj4gICAgICBWRklPQkFSIGJhcnNbUENJX05VTV9SRUdJT05TIC0gMV07IC8qIE5vIFJPTSAq
Lwo+ICAgICAgVkZJT1ZHQSAqdmdhOyAvKiAweGEwMDAwLCAweDNiMCwgMHgzYzAgKi8KPiAgICAg
IHZvaWQgKmlnZF9vcHJlZ2lvbjsKPiArICAgIFZGSU9NaWdyYXRpb24gKm1pZ3JhdGlvbjsKPiAr
ICAgIEVycm9yICptaWdyYXRpb25fYmxvY2tlcjsKPiAgICAgIFBDSUhvc3REZXZpY2VBZGRyZXNz
IGhvc3Q7Cj4gICAgICBFdmVudE5vdGlmaWVyIGVycl9ub3RpZmllcjsKPiAgICAgIEV2ZW50Tm90
aWZpZXIgcmVxX25vdGlmaWVyOwo+IEBAIC0xOTgsNSArMjE2LDEwIEBAIGludCB2ZmlvX3BjaV9p
Z2Rfb3ByZWdpb25faW5pdChWRklPUENJRGV2aWNlICp2ZGV2LAo+ICB2b2lkIHZmaW9fZGlzcGxh
eV9yZXNldChWRklPUENJRGV2aWNlICp2ZGV2KTsKPiAgaW50IHZmaW9fZGlzcGxheV9wcm9iZShW
RklPUENJRGV2aWNlICp2ZGV2LCBFcnJvciAqKmVycnApOwo+ICB2b2lkIHZmaW9fZGlzcGxheV9m
aW5hbGl6ZShWRklPUENJRGV2aWNlICp2ZGV2KTsKPiAtCj4gK2Jvb2wgdmZpb19kZXZpY2VfZGF0
YV9jYXBfc3lzdGVtX21lbW9yeShWRklPUENJRGV2aWNlICp2ZGV2KTsKPiArYm9vbCB2ZmlvX2Rl
dmljZV9kYXRhX2NhcF9kZXZpY2VfbWVtb3J5KFZGSU9QQ0lEZXZpY2UgKnZkZXYpOwo+ICtpbnQg
dmZpb19zZXRfZGlydHlfcGFnZV9iaXRtYXAoVkZJT1BDSURldmljZSAqdmRldiwKPiArICAgICAg
ICAgdWludDY0X3Qgc3RhcnRfYWRkciwgdWludDY0X3QgcGFnZV9ucik7Cj4gK2ludCB2ZmlvX21p
Z3JhdGlvbl9pbml0KFZGSU9QQ0lEZXZpY2UgKnZkZXYsIEVycm9yICoqZXJycCk7Cj4gK3ZvaWQg
dmZpb19taWdyYXRpb25fZmluYWxpemUoVkZJT1BDSURldmljZSAqdmRldik7Cj4gICNlbmRpZiAv
KiBIV19WRklPX1ZGSU9fUENJX0ggKi8KPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9ody92ZmlvL3Zm
aW8tY29tbW9uLmggYi9pbmNsdWRlL2h3L3ZmaW8vdmZpby1jb21tb24uaAo+IGluZGV4IDFiNDM0
ZDAuLmVkNDM2MTMgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9ody92ZmlvL3ZmaW8tY29tbW9uLmgK
PiArKysgYi9pbmNsdWRlL2h3L3ZmaW8vdmZpby1jb21tb24uaAo+IEBAIC0zMiw2ICszMiw3IEBA
Cj4gICNlbmRpZgo+ICAKPiAgI2RlZmluZSBWRklPX01TR19QUkVGSVggInZmaW8gJXM6ICIKPiAr
I2RlZmluZSBUWVBFX1ZGSU9fUENJICJ2ZmlvLXBjaSIKPiAgCj4gIGVudW0gewo+ICAgICAgVkZJ
T19ERVZJQ0VfVFlQRV9QQ0kgPSAwLAo+IC0tIAo+IDIuNy40Cj4gCi0tCkRyLiBEYXZpZCBBbGFu
IEdpbGJlcnQgLyBkZ2lsYmVydEByZWRoYXQuY29tIC8gTWFuY2hlc3RlciwgVUsKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KaW50ZWwtZ3Z0LWRldiBtYWls
aW5nIGxpc3QKaW50ZWwtZ3Z0LWRldkBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0
cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1ndnQtZGV2
