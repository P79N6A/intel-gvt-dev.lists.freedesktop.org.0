Delivered-To: linux.kernel.mailinglists@gmail.com
Received: by 2002:a81:3684:0:0:0:0:0 with SMTP id d126csp4061241ywa;
        Tue, 19 Feb 2019 21:17:54 -0800 (PST)
X-Google-Smtp-Source: AHgI3IYWZgvxRq+tq7brnhbhsJ7AZdCpNT/HkesBzTaXLk8+1QfDnNxxdcjlylu+Qf27ZQknEyUI
X-Received: by 2002:aa7:83c2:: with SMTP id j2mr32819262pfn.119.1550639874163;
        Tue, 19 Feb 2019 21:17:54 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1550639874; cv=none;
        d=google.com; s=arc-20160816;
        b=IpwACF05UPgZR7L9Hz/d3nodIgVvrkP/YxzqoIvju0/NCPlXw7xGTAV/pY3+o+gpwz
         eEgcMKmEUf1y8URE7mw3uokiG/h3N0KkGKaIVro7DVl0Ib3NBRd5aH98pqUMxWhWs/Yy
         ONohAwHhaJz+5LSioJzB917QF0wPVOLAWYtngZcE0t3E3eaxpxoSIPsJjMWoVvaP+wgW
         N/w+N3pptyOUHORrHxKYK7FLycYvujto5O2d59EFgYqZbOsZ6qAPX9jbFB1ydkLksv07
         4CCnikWo6pmDXDiKV+8NeCZgHfDa1BThJt2nAIGuv6FvvLPXU/Gp6rYc2G6cqLHtws0e
         DQtA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-archive:list-unsubscribe:list-id
         :precedence:user-agent:in-reply-to:content-disposition:mime-version
         :references:message-id:subject:to:from:date:delivered-to;
        bh=HtbnF7UV7mVMSlAnD3QE78Ywzd49tCFi6DNOp1lFERA=;
        b=IEV38hFnAl7vCviy4iCHkBuv1asL0nppItGKofjJsv/dToOQBpnieKlagtLKf60E0I
         AvbxyIPdCZBYvrpZ6rEeqdW/oV+clC4cAb0nPrindTv1MC3aaN5/ZgVIH/gBKMF7UqI0
         jEEXt/SXoaqQKCL8YIXXAhVNU4nkW/TgESUKEYr173zrYCAue3lmK3pWe++P2ffxd1Os
         gOHWK/beb5T7PQncCXyUFE1KMZ0NpcWyb+pRkAvA5E17BUdhwNjSQfedeuVjHmwfi4yY
         o20KXkcDLM0JZ+hj9ONNSF2a6EVDFVcqHbl0OjTRkY/tg63lmYUbv2/Vzf8DjjdQ6M6G
         6SAg==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 2610:10:20:722:a800:ff:fe36:1795 as permitted sender) smtp.mailfrom=intel-gvt-dev-bounces@lists.freedesktop.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=intel.com
Return-Path: <intel-gvt-dev-bounces@lists.freedesktop.org>
Received: from gabe.freedesktop.org (gabe.freedesktop.org. [2610:10:20:722:a800:ff:fe36:1795])
        by mx.google.com with ESMTPS id g10si10382538pgk.395.2019.02.19.21.17.53
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Tue, 19 Feb 2019 21:17:54 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 2610:10:20:722:a800:ff:fe36:1795 as permitted sender) client-ip=2610:10:20:722:a800:ff:fe36:1795;
Authentication-Results: mx.google.com;
       spf=pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 2610:10:20:722:a800:ff:fe36:1795 as permitted sender) smtp.mailfrom=intel-gvt-dev-bounces@lists.freedesktop.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=intel.com
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2327789165;
	Wed, 20 Feb 2019 05:17:53 +0000 (UTC)
X-Original-To: intel-gvt-dev@lists.freedesktop.org
Delivered-To: intel-gvt-dev@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CD6F189165
 for <intel-gvt-dev@lists.freedesktop.org>;
 Wed, 20 Feb 2019 05:17:51 +0000 (UTC)
X-Amp-Result: UNSCANNABLE
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 19 Feb 2019 21:17:51 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.58,388,1544515200"; d="scan'208";a="117560075"
Received: from joy-optiplex-7040.sh.intel.com (HELO joy-OptiPlex-7040)
 ([10.239.13.9])
 by orsmga006.jf.intel.com with ESMTP; 19 Feb 2019 21:17:46 -0800
Date: Wed, 20 Feb 2019 00:12:32 -0500
From: Zhao Yan <yan.y.zhao@intel.com>
To: "Dr. David Alan Gilbert" <dgilbert@redhat.com>
Subject: Re: [PATCH 2/5] vfio/migration: support device of device config
 capability
Message-ID: <20190220051232.GA16456@joy-OptiPlex-7040>
References: <1550566254-3545-1-git-send-email-yan.y.zhao@intel.com>
 <1550566347-3648-1-git-send-email-yan.y.zhao@intel.com>
 <20190219110144.GA2941@work-vm>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20190219110144.GA2941@work-vm>
User-Agent: Mutt/1.9.4 (2018-02-28)
X-BeenThere: intel-gvt-dev@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: "Intel GVT \(Graphics Virtualization\) development list"
 <intel-gvt-dev.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gvt-dev>
List-Post: <mailto:intel-gvt-dev@lists.freedesktop.org>
List-Help: <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=subscribe>
Cc: cjia@nvidia.com, kvm@vger.kernel.org, aik@ozlabs.ru,
 Zhengxiao.zx@alibaba-inc.com, shuangtai.tst@alibaba-inc.com,
 qemu-devel@nongnu.org, kwankhede@nvidia.com, eauger@redhat.com,
 yi.l.liu@intel.com, eskultet@redhat.com, ziye.yang@intel.com,
 mlevitsk@redhat.com, pasic@linux.ibm.com, arei.gonglei@huawei.com,
 felipe@nutanix.com, zhi.a.wang@intel.com, kevin.tian@intel.com,
 alex.williamson@redhat.com, intel-gvt-dev@lists.freedesktop.org,
 changpeng.liu@intel.com, cohuck@redhat.com, Ken.Xue@amd.com,
 jonathan.davies@nutanix.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gvt-dev-bounces@lists.freedesktop.org
Sender: "intel-gvt-dev" <intel-gvt-dev-bounces@lists.freedesktop.org>

T24gVHVlLCBGZWIgMTksIDIwMTkgYXQgMTE6MDE6NDVBTSArMDAwMCwgRHIuIERhdmlkIEFsYW4g
R2lsYmVydCB3cm90ZToKPiAqIFlhbiBaaGFvICh5YW4ueS56aGFvQGludGVsLmNvbSkgd3JvdGU6
Cj4gPiBEZXZpY2UgY29uZmlnIGlzIHRoZSBkZWZhdWx0IGRhdGEgdGhhdCBldmVyeSBkZXZpY2Ug
c2hvdWxkIGhhdmUuIHNvCj4gPiBkZXZpY2UgY29uZmlnIGNhcGFiaWxpdHkgaXMgYnkgZGVmYXVs
dCBvbiwgbm8gbmVlZCB0byBzZXQuCj4gPiAKPiA+IC0gQ3VycmVudGx5IHR3byB0eXBlIG9mIHJl
c291cmNlcyBhcmUgc2F2ZWQvbG9hZGVkIGZvciBkZXZpY2Ugb2YgZGV2aWNlCj4gPiAgIGNvbmZp
ZyBjYXBhYmlsaXR5Ogo+ID4gICBHZW5lcmFsIFBDSSBjb25maWcgZGF0YSwgYW5kIERldmljZSBj
b25maWcgZGF0YS4KPiA+ICAgVGhleSBhcmUgY29waWVzIGFzIGEgd2hvbGUgd2hlbiBwcmVjb3B5
IGlzIHN0b3BwZWQuCj4gPiAKPiA+IE1pZ3JhdGlvbiBzZXR1cCBmbG93Ogo+ID4gLSBTZXR1cCBk
ZXZpY2Ugc3RhdGUgcmVnaW9ucywgY2hlY2sgaXRzIGRldmljZSBzdGF0ZSB2ZXJzaW9uIGFuZCBj
YXBhYmlsaXRpZXMuCj4gPiAgIE1tYXAgRGV2aWNlIENvbmZpZyBSZWdpb24gYW5kIERpcnR5IEJp
dG1hcCBSZWdpb24sIGlmIGF2YWlsYWJsZS4KPiA+IC0gSWYgZGV2aWNlIHN0YXRlIHJlZ2lvbnMg
YXJlIGZhaWxlZCB0byBnZXQgc2V0dXAsIGEgbWlncmF0aW9uIGJsb2NrZXIgaXMKPiA+ICAgcmVn
aXN0ZXJlZCBpbnN0ZWFkLgo+ID4gLSBBZGRlZCBTYXZlVk1IYW5kbGVycyB0byByZWdpc3RlciBk
ZXZpY2Ugc3RhdGUgc2F2ZS9sb2FkIGhhbmRsZXJzLgo+ID4gLSBSZWdpc3RlciBWTSBzdGF0ZSBj
aGFuZ2UgaGFuZGxlciB0byBzZXQgZGV2aWNlJ3MgcnVubmluZy9zdG9wIHN0YXRlcy4KPiA+IC0g
T24gbWlncmF0aW9uIHN0YXJ0dXAgb24gc291cmNlIG1hY2hpbmUsIHNldCBkZXZpY2UncyBzdGF0
ZSB0bwo+ID4gICBWRklPX0RFVklDRV9TVEFURV9MT0dHSU5HCj4gPiAKPiA+IFNpZ25lZC1vZmYt
Ynk6IFlhbiBaaGFvIDx5YW4ueS56aGFvQGludGVsLmNvbT4KPiA+IFNpZ25lZC1vZmYtYnk6IFl1
bGVpIFpoYW5nIDx5dWxlaS56aGFuZ0BpbnRlbC5jb20+Cj4gPiAtLS0KPiA+ICBody92ZmlvL01h
a2VmaWxlLm9ianMgICAgICAgICB8ICAgMiArLQo+ID4gIGh3L3ZmaW8vbWlncmF0aW9uLmMgICAg
ICAgICAgIHwgNjMzICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwo+
ID4gIGh3L3ZmaW8vcGNpLmMgICAgICAgICAgICAgICAgIHwgICAxIC0KPiA+ICBody92ZmlvL3Bj
aS5oICAgICAgICAgICAgICAgICB8ICAyNSArLQo+ID4gIGluY2x1ZGUvaHcvdmZpby92ZmlvLWNv
bW1vbi5oIHwgICAxICsKPiA+ICA1IGZpbGVzIGNoYW5nZWQsIDY1OSBpbnNlcnRpb25zKCspLCAz
IGRlbGV0aW9ucygtKQo+ID4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBody92ZmlvL21pZ3JhdGlvbi5j
Cj4gPiAKPiA+IGRpZmYgLS1naXQgYS9ody92ZmlvL01ha2VmaWxlLm9ianMgYi9ody92ZmlvL01h
a2VmaWxlLm9ianMKPiA+IGluZGV4IDhiM2Y2NjQuLmYzMmZmMTkgMTAwNjQ0Cj4gPiAtLS0gYS9o
dy92ZmlvL01ha2VmaWxlLm9ianMKPiA+ICsrKyBiL2h3L3ZmaW8vTWFrZWZpbGUub2Jqcwo+ID4g
QEAgLTEsNiArMSw2IEBACj4gPiAgaWZlcSAoJChDT05GSUdfTElOVVgpLCB5KQo+ID4gIG9iai0k
KENPTkZJR19TT0ZUTU1VKSArPSBjb21tb24ubwo+ID4gLW9iai0kKENPTkZJR19QQ0kpICs9IHBj
aS5vIHBjaS1xdWlya3MubyBkaXNwbGF5Lm8KPiA+ICtvYmotJChDT05GSUdfUENJKSArPSBwY2ku
byBwY2ktcXVpcmtzLm8gZGlzcGxheS5vIG1pZ3JhdGlvbi5vCj4gPiAgb2JqLSQoQ09ORklHX1ZG
SU9fQ0NXKSArPSBjY3cubwo+ID4gIG9iai0kKENPTkZJR19TT0ZUTU1VKSArPSBwbGF0Zm9ybS5v
Cj4gPiAgb2JqLSQoQ09ORklHX1ZGSU9fWEdNQUMpICs9IGNhbHhlZGEteGdtYWMubwo+ID4gZGlm
ZiAtLWdpdCBhL2h3L3ZmaW8vbWlncmF0aW9uLmMgYi9ody92ZmlvL21pZ3JhdGlvbi5jCj4gPiBu
ZXcgZmlsZSBtb2RlIDEwMDY0NAo+ID4gaW5kZXggMDAwMDAwMC4uMTZkNjM5NQo+ID4gLS0tIC9k
ZXYvbnVsbAo+ID4gKysrIGIvaHcvdmZpby9taWdyYXRpb24uYwo+ID4gQEAgLTAsMCArMSw2MzMg
QEAKPiA+ICsjaW5jbHVkZSAicWVtdS9vc2RlcC5oIgo+ID4gKwo+ID4gKyNpbmNsdWRlICJody92
ZmlvL3ZmaW8tY29tbW9uLmgiCj4gPiArI2luY2x1ZGUgIm1pZ3JhdGlvbi9ibG9ja2VyLmgiCj4g
PiArI2luY2x1ZGUgIm1pZ3JhdGlvbi9yZWdpc3Rlci5oIgo+ID4gKyNpbmNsdWRlICJxYXBpL2Vy
cm9yLmgiCj4gPiArI2luY2x1ZGUgInBjaS5oIgo+ID4gKyNpbmNsdWRlICJzeXNlbXUva3ZtLmgi
Cj4gPiArI2luY2x1ZGUgImV4ZWMvcmFtX2FkZHIuaCIKPiA+ICsKPiA+ICsjZGVmaW5lIFZGSU9f
U0FWRV9GTEFHX1NFVFVQIDAKPiA+ICsjZGVmaW5lIFZGSU9fU0FWRV9GTEFHX1BDSSAxCj4gPiAr
I2RlZmluZSBWRklPX1NBVkVfRkxBR19ERVZDT05GSUcgMgo+ID4gKyNkZWZpbmUgVkZJT19TQVZF
X0ZMQUdfREVWTUVNT1JZIDQKPiA+ICsjZGVmaW5lIFZGSU9fU0FWRV9GTEFHX0NPTlRJTlVFIDgK
PiA+ICsKPiA+ICtzdGF0aWMgaW50IHZmaW9fZGV2aWNlX3N0YXRlX3JlZ2lvbl9zZXR1cChWRklP
UENJRGV2aWNlICp2ZGV2LAo+ID4gKyAgICAgICAgVkZJT1JlZ2lvbiAqcmVnaW9uLCB1aW50MzJf
dCBzdWJ0eXBlLCBjb25zdCBjaGFyICpuYW1lKQo+ID4gK3sKPiA+ICsgICAgVkZJT0RldmljZSAq
dmJhc2VkZXYgPSAmdmRldi0+dmJhc2VkZXY7Cj4gPiArICAgIHN0cnVjdCB2ZmlvX3JlZ2lvbl9p
bmZvICppbmZvOwo+ID4gKyAgICBpbnQgcmV0Owo+ID4gKwo+ID4gKyAgICByZXQgPSB2ZmlvX2dl
dF9kZXZfcmVnaW9uX2luZm8odmJhc2VkZXYsIFZGSU9fUkVHSU9OX1RZUEVfREVWSUNFX1NUQVRF
LAo+ID4gKyAgICAgICAgICAgIHN1YnR5cGUsICZpbmZvKTsKPiA+ICsgICAgaWYgKHJldCkgewo+
ID4gKyAgICAgICAgZXJyb3JfcmVwb3J0KCJGYWlsZWQgdG8gZ2V0IGluZm8gb2YgcmVnaW9uICVz
IiwgbmFtZSk7Cj4gPiArICAgICAgICByZXR1cm4gcmV0Owo+ID4gKyAgICB9Cj4gPiArCj4gPiAr
ICAgIGlmICh2ZmlvX3JlZ2lvbl9zZXR1cChPQkpFQ1QodmRldiksIHZiYXNlZGV2LAo+ID4gKyAg
ICAgICAgICAgIHJlZ2lvbiwgaW5mby0+aW5kZXgsIG5hbWUpKSB7Cj4gPiArICAgICAgICBlcnJv
cl9yZXBvcnQoIkZhaWxlZCB0byBzZXR1cCBtaWdydGlvbiByZWdpb24gJXMiLCBuYW1lKTsKPiA+
ICsgICAgICAgIHJldHVybiByZXQ7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgaWYgKHZmaW9f
cmVnaW9uX21tYXAocmVnaW9uKSkgewo+ID4gKyAgICAgICAgZXJyb3JfcmVwb3J0KCJGYWlsZWQg
dG8gbW1hcCBtaWdydGlvbiByZWdpb24gJXMiLCBuYW1lKTsKPiA+ICsgICAgfQo+ID4gKwo+ID4g
KyAgICByZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4gPiArYm9vbCB2ZmlvX2RldmljZV9kYXRhX2Nh
cF9zeXN0ZW1fbWVtb3J5KFZGSU9QQ0lEZXZpY2UgKnZkZXYpCj4gPiArewo+ID4gKyAgIHJldHVy
biAhISh2ZGV2LT5taWdyYXRpb24tPmRhdGFfY2FwcyAmIFZGSU9fREVWSUNFX0RBVEFfQ0FQX1NZ
U1RFTV9NRU1PUlkpOwo+ID4gK30KPiA+ICsKPiA+ICtib29sIHZmaW9fZGV2aWNlX2RhdGFfY2Fw
X2RldmljZV9tZW1vcnkoVkZJT1BDSURldmljZSAqdmRldikKPiA+ICt7Cj4gPiArICAgcmV0dXJu
ICEhKHZkZXYtPm1pZ3JhdGlvbi0+ZGF0YV9jYXBzICYgVkZJT19ERVZJQ0VfREFUQV9DQVBfREVW
SUNFX01FTU9SWSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBib29sIHZmaW9fZGV2aWNlX3N0
YXRlX3JlZ2lvbl9tbWFwZWQoVkZJT1JlZ2lvbiAqcmVnaW9uKQo+ID4gK3sKPiA+ICsgICAgYm9v
bCBtbWFwZWQgPSB0cnVlOwo+ID4gKyAgICBpZiAocmVnaW9uLT5ucl9tbWFwcyAhPSAxIHx8IHJl
Z2lvbi0+bW1hcHNbMF0ub2Zmc2V0IHx8Cj4gPiArICAgICAgICAgICAgKHJlZ2lvbi0+c2l6ZSAh
PSByZWdpb24tPm1tYXBzWzBdLnNpemUpIHx8Cj4gPiArICAgICAgICAgICAgKHJlZ2lvbi0+bW1h
cHNbMF0ubW1hcCA9PSBOVUxMKSkgewo+ID4gKyAgICAgICAgbW1hcGVkID0gZmFsc2U7Cj4gPiAr
ICAgIH0KPiA+ICsKPiA+ICsgICAgcmV0dXJuIG1tYXBlZDsKPiA+ICt9Cj4gPiArCj4gPiArc3Rh
dGljIGludCB2ZmlvX2dldF9kZXZpY2VfY29uZmlnX3NpemUoVkZJT1BDSURldmljZSAqdmRldikK
PiA+ICt7Cj4gPiArICAgIFZGSU9EZXZpY2UgKnZiYXNlZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+
ID4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fY3RsID0KPiA+ICsgICAgICAgICZ2ZGV2LT5taWdy
YXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9DVExdOwo+ID4gKyAgICBWRklPUmVn
aW9uICpyZWdpb25fY29uZmlnID0KPiA+ICsgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lv
bltWRklPX0RFVlNUQVRFX1JFR0lPTl9EQVRBX0NPTkZJR107Cj4gPiArICAgIHVpbnQ2NF90IGxl
bjsKPiA+ICsgICAgaW50IHN6Owo+ID4gKwo+ID4gKyAgICBzeiA9IHNpemVvZihsZW4pOwo+ID4g
KyAgICBpZiAocHJlYWQodmJhc2VkZXYtPmZkLCAmbGVuLCBzeiwKPiA+ICsgICAgICAgICAgICAg
ICAgcmVnaW9uX2N0bC0+ZmRfb2Zmc2V0ICsKPiA+ICsgICAgICAgICAgICAgICAgb2Zmc2V0b2Yo
c3RydWN0IHZmaW9fZGV2aWNlX3N0YXRlX2N0bCwgZGV2aWNlX2NvbmZpZy5zaXplKSkKPiA+ICsg
ICAgICAgICAgICAhPSBzeikgewo+ID4gKyAgICAgICAgZXJyb3JfcmVwb3J0KCJ2ZmlvOiBGYWls
ZWQgdG8gZ2V0IGxlbmd0aCBvZiBkZXZpY2UgY29uZmlnIik7Cj4gPiArICAgICAgICByZXR1cm4g
LTE7Cj4gPiArICAgIH0KPiA+ICsgICAgaWYgKGxlbiA+IHJlZ2lvbl9jb25maWctPnNpemUpIHsK
PiA+ICsgICAgICAgIGVycm9yX3JlcG9ydCgidmZpbzogRXJyb3IgZGV2aWNlIGNvbmZpZyBsZW5n
dGgiKTsKPiA+ICsgICAgICAgIHJldHVybiAtMTsKPiA+ICsgICAgfQo+ID4gKyAgICB2ZGV2LT5t
aWdyYXRpb24tPmRldmNvbmZpZ19zaXplID0gbGVuOwo+ID4gKwo+ID4gKyAgICByZXR1cm4gMDsK
PiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCB2ZmlvX3NldF9kZXZpY2VfY29uZmlnX3NpemUo
VkZJT1BDSURldmljZSAqdmRldiwgdWludDY0X3Qgc2l6ZSkKPiA+ICt7Cj4gPiArICAgIFZGSU9E
ZXZpY2UgKnZiYXNlZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+ID4gKyAgICBWRklPUmVnaW9uICpy
ZWdpb25fY3RsID0KPiA+ICsgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RF
VlNUQVRFX1JFR0lPTl9DVExdOwo+ID4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fY29uZmlnID0K
PiA+ICsgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lP
Tl9EQVRBX0NPTkZJR107Cj4gPiArICAgIGludCBzejsKPiA+ICsKPiA+ICsgICAgaWYgKHNpemUg
PiByZWdpb25fY29uZmlnLT5zaXplKSB7Cj4gPiArICAgICAgICByZXR1cm4gLTE7Cj4gPiArICAg
IH0KPiA+ICsKPiA+ICsgICAgc3ogPSBzaXplb2Yoc2l6ZSk7Cj4gPiArICAgIGlmIChwd3JpdGUo
dmJhc2VkZXYtPmZkLCAmc2l6ZSwgc3osCj4gPiArICAgICAgICAgICAgICAgIHJlZ2lvbl9jdGwt
PmZkX29mZnNldCArCj4gPiArICAgICAgICAgICAgICAgIG9mZnNldG9mKHN0cnVjdCB2ZmlvX2Rl
dmljZV9zdGF0ZV9jdGwsIGRldmljZV9jb25maWcuc2l6ZSkpCj4gPiArICAgICAgICAgICAgIT0g
c3opIHsKPiA+ICsgICAgICAgIGVycm9yX3JlcG9ydCgidmZpbzogRmFpbGVkIHRvIHNldCBsZW5n
dGggb2YgZGV2aWNlIGNvbmZpZyIpOwo+ID4gKyAgICAgICAgcmV0dXJuIC0xOwo+ID4gKyAgICB9
Cj4gPiArICAgIHZkZXYtPm1pZ3JhdGlvbi0+ZGV2Y29uZmlnX3NpemUgPSBzaXplOwo+ID4gKyAg
ICByZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCB2ZmlvX3NhdmVfZGF0YV9k
ZXZpY2VfY29uZmlnKFZGSU9QQ0lEZXZpY2UgKnZkZXYsIFFFTVVGaWxlICpmKQo+ID4gK3sKPiA+
ICsgICAgVkZJT0RldmljZSAqdmJhc2VkZXYgPSAmdmRldi0+dmJhc2VkZXY7Cj4gPiArICAgIFZG
SU9SZWdpb24gKnJlZ2lvbl9jdGwgPQo+ID4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVn
aW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9OX0NUTF07Cj4gPiArICAgIFZGSU9SZWdpb24gKnJlZ2lv
bl9jb25maWcgPQo+ID4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVW
U1RBVEVfUkVHSU9OX0RBVEFfQ09ORklHXTsKPiA+ICsgICAgdm9pZCAqZGVzdDsKPiA+ICsgICAg
dWludDMyX3Qgc3o7Cj4gPiArICAgIHVpbnQ4X3QgKmJ1ZiA9IE5VTEw7Cj4gPiArICAgIHVpbnQz
Ml90IGFjdGlvbiA9IFZGSU9fREVWSUNFX0RBVEFfQUNUSU9OX0dFVF9CVUZGRVI7Cj4gPiArICAg
IHVpbnQ2NF90IGxlbiA9IHZkZXYtPm1pZ3JhdGlvbi0+ZGV2Y29uZmlnX3NpemU7Cj4gPiArCj4g
PiArICAgIHFlbXVfcHV0X2JlNjQoZiwgbGVuKTsKPiA+ICsKPiA+ICsgICAgc3ogPSBzaXplb2Yo
YWN0aW9uKTsKPiA+ICsgICAgaWYgKHB3cml0ZSh2YmFzZWRldi0+ZmQsICZhY3Rpb24sIHN6LAo+
ID4gKyAgICAgICAgICAgICAgICByZWdpb25fY3RsLT5mZF9vZmZzZXQgKwo+ID4gKyAgICAgICAg
ICAgICAgICBvZmZzZXRvZihzdHJ1Y3QgdmZpb19kZXZpY2Vfc3RhdGVfY3RsLCBkZXZpY2VfY29u
ZmlnLmFjdGlvbikpCj4gPiArICAgICAgICAgICAgIT0gc3opIHsKPiA+ICsgICAgICAgIGVycm9y
X3JlcG9ydCgidmZpbzogYWN0aW9uIGZhaWx1cmUgZm9yIGRldmljZSBjb25maWcgZ2V0IGJ1ZmZl
ciIpOwo+ID4gKyAgICAgICAgcmV0dXJuIC0xOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIGlm
ICghdmZpb19kZXZpY2Vfc3RhdGVfcmVnaW9uX21tYXBlZChyZWdpb25fY29uZmlnKSkgewo+ID4g
KyAgICAgICAgYnVmID0gZ19tYWxsb2MobGVuKTsKPiA+ICsgICAgICAgIGlmIChidWYgPT0gTlVM
TCkgewo+ID4gKyAgICAgICAgICAgIGVycm9yX3JlcG9ydCgidmZpbzogRmFpbGVkIHRvIGFsbG9j
YXRlIG1lbW9yeSBmb3IgbWlncmF0ZSIpOwo+ID4gKyAgICAgICAgICAgIHJldHVybiAtMTsKPiA+
ICsgICAgICAgIH0KPiAKPiBnX21hbGxvYyBuZXZlciByZXR1cm5zIE5VTEw7IGl0IGFib3J0cyBv
biBmYWlsdXJlIHRvIGFsbG9jYXRlLgo+IFNvIHlvdSBjYW4gZWl0aGVyIGRyb3AgdGhlIGNoZWNr
LCBvciBteSBwcmVmZXJlbmNlIGlzIHRvIHVzZQo+IGdfdHJ5X21hbGxvYyBmb3IgbGFyZ2UvdW5r
bm93biBhcmVhcywgYW5kIGl0IGNhbiByZXR1cm4gTlVMTC4KPiAKb2suIGdvdCB0aGF0LiBJJ2xs
IHVzZSBnX3RyeV9tYWxsb2MgbmV4dCB0aW1lIDopCgo+ID4gKyAgICAgICAgaWYgKHByZWFkKHZi
YXNlZGV2LT5mZCwgYnVmLCBsZW4sIHJlZ2lvbl9jb25maWctPmZkX29mZnNldCkgIT0gbGVuKSB7
Cj4gPiArICAgICAgICAgICAgZXJyb3JfcmVwb3J0KCJ2ZmlvOiBGYWlsZWQgcmVhZCBkZXZpY2Ug
Y29uZmlnIGJ1ZmZlciIpOwo+ID4gKyAgICAgICAgICAgIHJldHVybiAtMTsKPiA+ICsgICAgICAg
IH0KPiA+ICsgICAgICAgIHFlbXVfcHV0X2J1ZmZlcihmLCBidWYsIGxlbik7Cj4gPiArICAgICAg
ICBnX2ZyZWUoYnVmKTsKPiA+ICsgICAgfSBlbHNlIHsKPiA+ICsgICAgICAgIGRlc3QgPSByZWdp
b25fY29uZmlnLT5tbWFwc1swXS5tbWFwOwo+ID4gKyAgICAgICAgcWVtdV9wdXRfYnVmZmVyKGYs
IGRlc3QsIGxlbik7Cj4gPiArICAgIH0KPiA+ICsgICAgcmV0dXJuIDA7Cj4gPiArfQo+ID4gKwo+
ID4gK3N0YXRpYyBpbnQgdmZpb19sb2FkX2RhdGFfZGV2aWNlX2NvbmZpZyhWRklPUENJRGV2aWNl
ICp2ZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBRRU1VRmlsZSAqZiwgdWlu
dDY0X3QgbGVuKQo+ID4gK3sKPiA+ICsgICAgVkZJT0RldmljZSAqdmJhc2VkZXYgPSAmdmRldi0+
dmJhc2VkZXY7Cj4gPiArICAgIFZGSU9SZWdpb24gKnJlZ2lvbl9jdGwgPQo+ID4gKyAgICAgICAg
JnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9OX0NUTF07Cj4gPiAr
ICAgIFZGSU9SZWdpb24gKnJlZ2lvbl9jb25maWcgPQo+ID4gKyAgICAgICAgJnZkZXYtPm1pZ3Jh
dGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9OX0RBVEFfQ09ORklHXTsKPiA+ICsgICAg
dm9pZCAqZGVzdDsKPiA+ICsgICAgdWludDMyX3Qgc3o7Cj4gPiArICAgIHVpbnQ4X3QgKmJ1ZiA9
IE5VTEw7Cj4gPiArICAgIHVpbnQzMl90IGFjdGlvbiA9IFZGSU9fREVWSUNFX0RBVEFfQUNUSU9O
X1NFVF9CVUZGRVI7Cj4gPiArCj4gPiArICAgIHZmaW9fc2V0X2RldmljZV9jb25maWdfc2l6ZSh2
ZGV2LCBsZW4pOwo+ID4gKwo+ID4gKyAgICBpZiAoIXZmaW9fZGV2aWNlX3N0YXRlX3JlZ2lvbl9t
bWFwZWQocmVnaW9uX2NvbmZpZykpIHsKPiA+ICsgICAgICAgIGJ1ZiA9IGdfbWFsbG9jKGxlbik7
Cj4gPiArICAgICAgICBpZiAoYnVmID09IE5VTEwpIHsKPiA+ICsgICAgICAgICAgICBlcnJvcl9y
ZXBvcnQoInZmaW86IEZhaWxlZCB0byBhbGxvY2F0ZSBtZW1vcnkgZm9yIG1pZ3JhdGUiKTsKPiA+
ICsgICAgICAgICAgICByZXR1cm4gLTE7Cj4gPiArICAgICAgICB9Cj4gPiArICAgICAgICBxZW11
X2dldF9idWZmZXIoZiwgYnVmLCBsZW4pOwo+ID4gKyAgICAgICAgaWYgKHB3cml0ZSh2YmFzZWRl
di0+ZmQsIGJ1ZiwgbGVuLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgcmVnaW9uX2NvbmZpZy0+
ZmRfb2Zmc2V0KSAhPSBsZW4pIHsKPiA+ICsgICAgICAgICAgICBlcnJvcl9yZXBvcnQoInZmaW86
IEZhaWxlZCB0byB3cml0ZSBkZXZpZSBjb25maWcgYnVmZmVyIik7Cj4gPiArICAgICAgICAgICAg
cmV0dXJuIC0xOwo+ID4gKyAgICAgICAgfQo+ID4gKyAgICAgICAgZ19mcmVlKGJ1Zik7Cj4gPiAr
ICAgIH0gZWxzZSB7Cj4gPiArICAgICAgICBkZXN0ID0gcmVnaW9uX2NvbmZpZy0+bW1hcHNbMF0u
bW1hcDsKPiA+ICsgICAgICAgIHFlbXVfZ2V0X2J1ZmZlcihmLCBkZXN0LCBsZW4pOwo+ID4gKyAg
ICB9Cj4gPiArCj4gPiArICAgIHN6ID0gc2l6ZW9mKGFjdGlvbik7Cj4gPiArICAgIGlmIChwd3Jp
dGUodmJhc2VkZXYtPmZkLCAmYWN0aW9uLCBzeiwKPiA+ICsgICAgICAgICAgICAgICAgcmVnaW9u
X2N0bC0+ZmRfb2Zmc2V0ICsKPiA+ICsgICAgICAgICAgICAgICAgb2Zmc2V0b2Yoc3RydWN0IHZm
aW9fZGV2aWNlX3N0YXRlX2N0bCwgZGV2aWNlX2NvbmZpZy5hY3Rpb24pKQo+ID4gKyAgICAgICAg
ICAgICE9IHN6KSB7Cj4gPiArICAgICAgICBlcnJvcl9yZXBvcnQoInZmaW86IGFjdGlvbiBmYWls
dXJlIGZvciBkZXZpY2UgY29uZmlnIHNldCBidWZmZXIiKTsKPiA+ICsgICAgICAgIHJldHVybiAt
MTsKPiA+ICsgICAgfQo+ID4gKwo+ID4gKyAgICByZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4gPiAr
c3RhdGljIGludCB2ZmlvX3NldF9kaXJ0eV9wYWdlX2JpdG1hcF9jaHVuayhWRklPUENJRGV2aWNl
ICp2ZGV2LAo+ID4gKyAgICAgICAgdWludDY0X3Qgc3RhcnRfYWRkciwgdWludDY0X3QgcGFnZV9u
cikKPiA+ICt7Cj4gPiArCj4gPiArICAgIFZGSU9EZXZpY2UgKnZiYXNlZGV2ID0gJnZkZXYtPnZi
YXNlZGV2Owo+ID4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fY3RsID0KPiA+ICsgICAgICAgICZ2
ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9DVExdOwo+ID4gKyAg
ICBWRklPUmVnaW9uICpyZWdpb25fYml0bWFwID0KPiA+ICsgICAgICAgICZ2ZGV2LT5taWdyYXRp
b24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9EQVRBX0JJVE1BUF07Cj4gPiArICAgIHVu
c2lnbmVkIGxvbmcgYml0bWFwX3NpemUgPQo+ID4gKyAgICAgICAgICAgICAgICAgICAgQklUU19U
T19MT05HUyhwYWdlX25yKSAqIHNpemVvZih1bnNpZ25lZCBsb25nKTsKPiA+ICsgICAgdWludDMy
X3Qgc3o7Cj4gPiArCj4gPiArICAgIHN0cnVjdCB7Cj4gPiArICAgICAgICBfX3U2NCBzdGFydF9h
ZGRyOwo+ID4gKyAgICAgICAgX191NjQgcGFnZV9ucjsKPiA+ICsgICAgfSBzeXN0ZW1fbWVtb3J5
Owo+ID4gKyAgICBzeXN0ZW1fbWVtb3J5LnN0YXJ0X2FkZHIgPSBzdGFydF9hZGRyOwo+ID4gKyAg
ICBzeXN0ZW1fbWVtb3J5LnBhZ2VfbnIgPSBwYWdlX25yOwo+ID4gKyAgICBzeiA9IHNpemVvZihz
eXN0ZW1fbWVtb3J5KTsKPiA+ICsgICAgaWYgKHB3cml0ZSh2YmFzZWRldi0+ZmQsICZzeXN0ZW1f
bWVtb3J5LCBzeiwKPiA+ICsgICAgICAgICAgICAgICAgcmVnaW9uX2N0bC0+ZmRfb2Zmc2V0ICsK
PiA+ICsgICAgICAgICAgICAgICAgb2Zmc2V0b2Yoc3RydWN0IHZmaW9fZGV2aWNlX3N0YXRlX2N0
bCwgc3lzdGVtX21lbW9yeSkpCj4gPiArICAgICAgICAgICAgIT0gc3opIHsKPiA+ICsgICAgICAg
IGVycm9yX3JlcG9ydCgidmZpbzogRmFpbGVkIHRvIHNldCBzeXN0ZW0gbWVtb3J5IHJhbmdlIGZv
ciBkaXJ0eSBwYWdlcyIpOwo+ID4gKyAgICAgICAgcmV0dXJuIC0xOwo+ID4gKyAgICB9Cj4gPiAr
Cj4gPiArICAgIGlmICghdmZpb19kZXZpY2Vfc3RhdGVfcmVnaW9uX21tYXBlZChyZWdpb25fYml0
bWFwKSkgewo+ID4gKyAgICAgICAgdm9pZCAqYml0bWFwID0gZ19tYWxsb2MwKGJpdG1hcF9zaXpl
KTsKPiA+ICsKPiA+ICsgICAgICAgIGlmIChwcmVhZCh2YmFzZWRldi0+ZmQsIGJpdG1hcCwgYml0
bWFwX3NpemUsCj4gPiArICAgICAgICAgICAgICAgICAgICByZWdpb25fYml0bWFwLT5mZF9vZmZz
ZXQpICE9IGJpdG1hcF9zaXplKSB7Cj4gPiArICAgICAgICAgICAgZXJyb3JfcmVwb3J0KCJ2Zmlv
OiBGYWlsZWQgdG8gcmVhZCBkaXJ0eSBiaXRtYXAgZGF0YSIpOwo+ID4gKyAgICAgICAgICAgIHJl
dHVybiAtMTsKPiA+ICsgICAgICAgIH0KPiA+ICsKPiA+ICsgICAgICAgIGNwdV9waHlzaWNhbF9t
ZW1vcnlfc2V0X2RpcnR5X2xlYml0bWFwKGJpdG1hcCwgc3RhcnRfYWRkciwgcGFnZV9ucik7Cj4g
PiArCj4gPiArICAgICAgICBnX2ZyZWUoYml0bWFwKTsKPiA+ICsgICAgfSBlbHNlIHsKPiA+ICsg
ICAgICAgIGNwdV9waHlzaWNhbF9tZW1vcnlfc2V0X2RpcnR5X2xlYml0bWFwKAo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgcmVnaW9uX2JpdG1hcC0+bW1hcHNbMF0ubW1hcCwKPiA+ICsgICAgICAg
ICAgICAgICAgICAgIHN0YXJ0X2FkZHIsIHBhZ2VfbnIpOwo+ID4gKyAgICB9Cj4gPiArICAgcmV0
dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4gK2ludCB2ZmlvX3NldF9kaXJ0eV9wYWdlX2JpdG1hcChW
RklPUENJRGV2aWNlICp2ZGV2LAo+ID4gKyAgICAgICAgdWludDY0X3Qgc3RhcnRfYWRkciwgdWlu
dDY0X3QgcGFnZV9ucikKPiA+ICt7Cj4gPiArICAgIFZGSU9SZWdpb24gKnJlZ2lvbl9iaXRtYXAg
PQo+ID4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVH
SU9OX0RBVEFfQklUTUFQXTsKPiA+ICsgICAgdW5zaWduZWQgbG9uZyBjaHVua19zaXplID0gcmVn
aW9uX2JpdG1hcC0+c2l6ZTsKPiA+ICsgICAgdWludDY0X3QgY2h1bmtfcGdfbnIgPSAoY2h1bmtf
c2l6ZSAvIHNpemVvZih1bnNpZ25lZCBsb25nKSkgKgo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgQklUU19QRVJfTE9ORzsKPiA+ICsKPiA+ICsgICAgdWludDY0X3QgY250X2xl
ZnQ7Cj4gPiArICAgIGludCByYyA9IDA7Cj4gPiArCj4gPiArICAgIGNudF9sZWZ0ID0gcGFnZV9u
cjsKPiA+ICsKPiA+ICsgICAgd2hpbGUgKGNudF9sZWZ0ID49IGNodW5rX3BnX25yKSB7Cj4gPiAr
ICAgICAgICByYyA9IHZmaW9fc2V0X2RpcnR5X3BhZ2VfYml0bWFwX2NodW5rKHZkZXYsIHN0YXJ0
X2FkZHIsIGNodW5rX3BnX25yKTsKPiA+ICsgICAgICAgIGlmIChyYykgewo+ID4gKyAgICAgICAg
ICAgIGdvdG8gZXhpdDsKPiA+ICsgICAgICAgIH0KPiA+ICsgICAgICAgIGNudF9sZWZ0IC09IGNo
dW5rX3BnX25yOwo+ID4gKyAgICAgICAgc3RhcnRfYWRkciArPSBzdGFydF9hZGRyOwo+ID4gKyAg
IH0KPiA+ICsgICByYyA9IHZmaW9fc2V0X2RpcnR5X3BhZ2VfYml0bWFwX2NodW5rKHZkZXYsIHN0
YXJ0X2FkZHIsIGNudF9sZWZ0KTsKPiA+ICsKPiA+ICtleGl0Ogo+ID4gKyAgIHJldHVybiByYzsK
PiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCB2ZmlvX3NldF9kZXZpY2Vfc3RhdGUoVkZJT1BD
SURldmljZSAqdmRldiwKPiA+ICsgICAgICAgIHVpbnQzMl90IGRldl9zdGF0ZSkKPiA+ICt7Cj4g
PiArICAgIFZGSU9EZXZpY2UgKnZiYXNlZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+ID4gKyAgICBW
RklPUmVnaW9uICpyZWdpb24gPQo+ID4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9u
W1ZGSU9fREVWU1RBVEVfUkVHSU9OX0NUTF07Cj4gPiArICAgIHVpbnQzMl90IHN6ID0gc2l6ZW9m
KGRldl9zdGF0ZSk7Cj4gPiArCj4gPiArICAgIGlmICghdmRldi0+bWlncmF0aW9uKSB7Cj4gPiAr
ICAgICAgICByZXR1cm4gLTE7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgaWYgKHB3cml0ZSh2
YmFzZWRldi0+ZmQsICZkZXZfc3RhdGUsIHN6LAo+ID4gKyAgICAgICAgICAgICAgcmVnaW9uLT5m
ZF9vZmZzZXQgKwo+ID4gKyAgICAgICAgICAgICAgb2Zmc2V0b2Yoc3RydWN0IHZmaW9fZGV2aWNl
X3N0YXRlX2N0bCwgZGV2aWNlX3N0YXRlKSkKPiA+ICsgICAgICAgICAgICAhPSBzeikgewo+ID4g
KyAgICAgICAgZXJyb3JfcmVwb3J0KCJ2ZmlvOiBGYWlsZWQgdG8gc2V0IGRldmljZSBzdGF0ZSAl
ZCIsIGRldl9zdGF0ZSk7Cj4gPiArICAgICAgICByZXR1cm4gLTE7Cj4gPiArICAgIH0KPiA+ICsg
ICAgdmRldi0+bWlncmF0aW9uLT5kZXZpY2Vfc3RhdGUgPSBkZXZfc3RhdGU7Cj4gPiArICAgIHJl
dHVybiAwOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IHZmaW9fZ2V0X2RldmljZV9kYXRh
X2NhcHMoVkZJT1BDSURldmljZSAqdmRldikKPiA+ICt7Cj4gPiArICAgIFZGSU9EZXZpY2UgKnZi
YXNlZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+ID4gKyAgICBWRklPUmVnaW9uICpyZWdpb24gPQo+
ID4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9O
X0NUTF07Cj4gPiArCj4gPiArICAgIHVpbnQzMl90IGNhcHM7Cj4gPiArICAgIHVpbnQzMl90IHNp
emUgPSBzaXplb2YoY2Fwcyk7Cj4gPiArCj4gPiArICAgIGlmIChwcmVhZCh2YmFzZWRldi0+ZmQs
ICZjYXBzLCBzaXplLAo+ID4gKyAgICAgICAgICAgICAgICByZWdpb24tPmZkX29mZnNldCArCj4g
PiArICAgICAgICAgICAgICAgIG9mZnNldG9mKHN0cnVjdCB2ZmlvX2RldmljZV9zdGF0ZV9jdGws
IGNhcHMpKQo+ID4gKyAgICAgICAgICAgICE9IHNpemUpIHsKPiA+ICsgICAgICAgIGVycm9yX3Jl
cG9ydCgiJXMgRmFpbGVkIHRvIHJlYWQgZGF0YSBjYXBzIG9mIGRldmljZSBzdGF0ZXMiLAo+ID4g
KyAgICAgICAgICAgICAgICB2YmFzZWRldi0+bmFtZSk7Cj4gPiArICAgICAgICByZXR1cm4gLTE7
Cj4gPiArICAgIH0KPiA+ICsgICAgdmRldi0+bWlncmF0aW9uLT5kYXRhX2NhcHMgPSBjYXBzOwo+
ID4gKyAgICByZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4gPiArCj4gPiArc3RhdGljIGludCB2Zmlv
X2NoZWNrX2RldnN0YXRlX3ZlcnNpb24oVkZJT1BDSURldmljZSAqdmRldikKPiA+ICt7Cj4gPiAr
ICAgIFZGSU9EZXZpY2UgKnZiYXNlZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+ID4gKyAgICBWRklP
UmVnaW9uICpyZWdpb24gPQo+ID4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZG
SU9fREVWU1RBVEVfUkVHSU9OX0NUTF07Cj4gPiArCj4gPiArICAgIHVpbnQzMl90IHZlcnNpb247
Cj4gPiArICAgIHVpbnQzMl90IHNpemUgPSBzaXplb2YodmVyc2lvbik7Cj4gPiArCj4gPiArICAg
IGlmIChwcmVhZCh2YmFzZWRldi0+ZmQsICZ2ZXJzaW9uLCBzaXplLAo+ID4gKyAgICAgICAgICAg
ICAgICByZWdpb24tPmZkX29mZnNldCArCj4gPiArICAgICAgICAgICAgICAgIG9mZnNldG9mKHN0
cnVjdCB2ZmlvX2RldmljZV9zdGF0ZV9jdGwsIHZlcnNpb24pKQo+ID4gKyAgICAgICAgICAgICE9
IHNpemUpIHsKPiA+ICsgICAgICAgIGVycm9yX3JlcG9ydCgiJXMgRmFpbGVkIHRvIHJlYWQgdmVy
c2lvbiBvZiBkZXZpY2Ugc3RhdGUgaW50ZXJmYWNlcyIsCj4gPiArICAgICAgICAgICAgICAgIHZi
YXNlZGV2LT5uYW1lKTsKPiA+ICsgICAgICAgIHJldHVybiAtMTsKPiA+ICsgICAgfQo+ID4gKwo+
ID4gKyAgICBpZiAodmVyc2lvbiAhPSBWRklPX0RFVklDRV9TVEFURV9JTlRFUkZBQ0VfVkVSU0lP
Tikgewo+ID4gKyAgICAgICAgZXJyb3JfcmVwb3J0KCIlcyBtaWdyYXRpb24gdmVyc2lvbiBtaXNt
YXRjaCwgcmlnaHQgdmVyc2lvbiBpcyAlZCIsCj4gPiArICAgICAgICAgICAgICAgIHZiYXNlZGV2
LT5uYW1lLCBWRklPX0RFVklDRV9TVEFURV9JTlRFUkZBQ0VfVkVSU0lPTik7Cj4gPiArICAgICAg
ICByZXR1cm4gLTE7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgcmV0dXJuIDA7Cj4gPiArfQo+
ID4gKwo+ID4gK3N0YXRpYyB2b2lkIHZmaW9fdm1fY2hhbmdlX3N0YXRlX2hhbmRsZXIodm9pZCAq
cHYsIGludCBydW5uaW5nLCBSdW5TdGF0ZSBzdGF0ZSkKPiA+ICt7Cj4gPiArICAgIFZGSU9QQ0lE
ZXZpY2UgKnZkZXYgPSBwdjsKPiA+ICsgICAgdWludDMyX3QgZGV2X3N0YXRlID0gdmRldi0+bWln
cmF0aW9uLT5kZXZpY2Vfc3RhdGU7Cj4gPiArCj4gPiArICAgIGlmICghcnVubmluZykgewo+ID4g
KyAgICAgICAgZGV2X3N0YXRlIHw9IFZGSU9fREVWSUNFX1NUQVRFX1NUT1A7Cj4gPiArICAgIH0g
ZWxzZSB7Cj4gPiArICAgICAgICBkZXZfc3RhdGUgJj0gflZGSU9fREVWSUNFX1NUQVRFX1NUT1A7
Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgdmZpb19zZXRfZGV2aWNlX3N0YXRlKHZkZXYsIGRl
dl9zdGF0ZSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIHZmaW9fc2F2ZV9saXZlX3Bl
bmRpbmcoUUVNVUZpbGUgKmYsIHZvaWQgKm9wYXF1ZSwKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVpbnQ2NF90IG1heF9zaXplLAo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDY0X3QgKnJlc19wcmVjb3B5X29ubHksCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCAqcmVzX2NvbXBhdGlibGUsCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCAqcmVzX3Bvc3Rf
Y29weV9vbmx5KQo+ID4gK3sKPiA+ICsgICAgVkZJT1BDSURldmljZSAqdmRldiA9IG9wYXF1ZTsK
PiA+ICsKPiA+ICsgICAgaWYgKCF2ZmlvX2RldmljZV9kYXRhX2NhcF9kZXZpY2VfbWVtb3J5KHZk
ZXYpKSB7Cj4gPiArICAgICAgICByZXR1cm47Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgcmV0
dXJuOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IHZmaW9fc2F2ZV9pdGVyYXRlKFFFTVVG
aWxlICpmLCB2b2lkICpvcGFxdWUpCj4gPiArewo+ID4gKyAgICBWRklPUENJRGV2aWNlICp2ZGV2
ID0gb3BhcXVlOwo+ID4gKwo+ID4gKyAgICBpZiAoIXZmaW9fZGV2aWNlX2RhdGFfY2FwX2Rldmlj
ZV9tZW1vcnkodmRldikpIHsKPiA+ICsgICAgICAgIHJldHVybiAwOwo+ID4gKyAgICB9Cj4gPiAr
Cj4gPiArICAgIHJldHVybiAwOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCB2ZmlvX3Bj
aV9sb2FkX2NvbmZpZyhWRklPUENJRGV2aWNlICp2ZGV2LCBRRU1VRmlsZSAqZikKPiA+ICt7Cj4g
PiArICAgIFBDSURldmljZSAqcGRldiA9ICZ2ZGV2LT5wZGV2Owo+ID4gKyAgICB1aW50MzJfdCBj
dGwsIG1zaV9sbywgbXNpX2hpLCBtc2lfZGF0YSwgYmFyX2NmZywgaTsKPiA+ICsgICAgYm9vbCBt
c2lfNjRiaXQ7Cj4gPiArCj4gPiArICAgIC8qIHJldG9yZSBwY2kgYmFyIGNvbmZpZ3VyYXRpb24g
Ki8KPiA+ICsgICAgY3RsID0gcGNpX2RlZmF1bHRfcmVhZF9jb25maWcocGRldiwgUENJX0NPTU1B
TkQsIDIpOwo+ID4gKyAgICB2ZmlvX3BjaV93cml0ZV9jb25maWcocGRldiwgUENJX0NPTU1BTkQs
Cj4gPiArICAgICAgICAgICAgY3RsICYgKCEoUENJX0NPTU1BTkRfSU8gfCBQQ0lfQ09NTUFORF9N
RU1PUlkpKSwgMik7Cj4gPiArICAgIGZvciAoaSA9IDA7IGkgPCBQQ0lfUk9NX1NMT1Q7IGkrKykg
ewo+ID4gKyAgICAgICAgYmFyX2NmZyA9IHFlbXVfZ2V0X2JlMzIoZik7Cj4gPiArICAgICAgICB2
ZmlvX3BjaV93cml0ZV9jb25maWcocGRldiwgUENJX0JBU0VfQUREUkVTU18wICsgaSAqIDQsIGJh
cl9jZmcsIDQpOwo+ID4gKyAgICB9Cj4gPiArICAgIHZmaW9fcGNpX3dyaXRlX2NvbmZpZyhwZGV2
LCBQQ0lfQ09NTUFORCwKPiA+ICsgICAgICAgICAgICBjdGwgfCBQQ0lfQ09NTUFORF9JTyB8IFBD
SV9DT01NQU5EX01FTU9SWSwgMik7Cj4gPiArCj4gPiArICAgIC8qIHJlc3RvcmUgbXNpIGNvbmZp
Z3VyYXRpb24gKi8KPiA+ICsgICAgY3RsID0gcGNpX2RlZmF1bHRfcmVhZF9jb25maWcocGRldiwg
cGRldi0+bXNpX2NhcCArIFBDSV9NU0lfRkxBR1MsIDIpOwo+ID4gKyAgICBtc2lfNjRiaXQgPSAh
IShjdGwgJiBQQ0lfTVNJX0ZMQUdTXzY0QklUKTsKPiA+ICsKPiA+ICsgICAgdmZpb19wY2lfd3Jp
dGVfY29uZmlnKCZ2ZGV2LT5wZGV2LAo+ID4gKyAgICAgICAgICAgIHBkZXYtPm1zaV9jYXAgKyBQ
Q0lfTVNJX0ZMQUdTLAo+ID4gKyAgICAgICAgICAgIGN0bCAmICghUENJX01TSV9GTEFHU19FTkFC
TEUpLCAyKTsKPiA+ICsKPiA+ICsgICAgbXNpX2xvID0gcWVtdV9nZXRfYmUzMihmKTsKPiA+ICsg
ICAgdmZpb19wY2lfd3JpdGVfY29uZmlnKHBkZXYsIHBkZXYtPm1zaV9jYXAgKyBQQ0lfTVNJX0FE
RFJFU1NfTE8sIG1zaV9sbywgNCk7Cj4gPiArCj4gPiArICAgIGlmIChtc2lfNjRiaXQpIHsKPiA+
ICsgICAgICAgIG1zaV9oaSA9IHFlbXVfZ2V0X2JlMzIoZik7Cj4gPiArICAgICAgICB2ZmlvX3Bj
aV93cml0ZV9jb25maWcocGRldiwgcGRldi0+bXNpX2NhcCArIFBDSV9NU0lfQUREUkVTU19ISSwK
PiA+ICsgICAgICAgICAgICAgICAgbXNpX2hpLCA0KTsKPiA+ICsgICAgfQo+ID4gKyAgICBtc2lf
ZGF0YSA9IHFlbXVfZ2V0X2JlMzIoZik7Cj4gPiArICAgIHZmaW9fcGNpX3dyaXRlX2NvbmZpZyhw
ZGV2LAo+ID4gKyAgICAgICAgICAgIHBkZXYtPm1zaV9jYXAgKyAobXNpXzY0Yml0ID8gUENJX01T
SV9EQVRBXzY0IDogUENJX01TSV9EQVRBXzMyKSwKPiA+ICsgICAgICAgICAgICBtc2lfZGF0YSwg
Mik7Cj4gPiArCj4gPiArICAgIHZmaW9fcGNpX3dyaXRlX2NvbmZpZygmdmRldi0+cGRldiwgcGRl
di0+bXNpX2NhcCArIFBDSV9NU0lfRkxBR1MsCj4gPiArICAgICAgICAgICAgY3RsIHwgUENJX01T
SV9GTEFHU19FTkFCTEUsIDIpOwo+IAo+IEl0IHdvdWxkIHByb2JhYmx5IGJlIGJlc3QgdG8gdXNl
IGEgVk1TdGF0ZURlc2NyaXB0aW9uIGFuZCB0aGUgbWFjcm9zCj4gZm9yIHRoaXMgaWYgcG9zc2li
bGU7IEkgYmV0IHlvdSdsbCB3YW50IHRvIGFkZCBtb3JlIGZpZWxkcyBpbiB0aGUgZnV0dXJlCj4g
Zm9yIGV4YW1wbGUuCnllcywgaXQgaXMgYWxzbyBhIGdvb2QgaWRlYSB0byB1c2UgVk1TdGF0ZURl
c2NyaXB0aW9uIGZvciBwY2kgZ2VuZXJhbApjb25maWcgZGF0YSwgd2hpY2ggYXJlIHNhdmVkIG9u
ZSB0aW1lIGluIHN0b3AtYW5kLWNvcHkgcGhhc2UuCkJ1dCBpdCdzIGEgbGl0dGxlIGhhcmQgdG8g
bWFpbnRhaW4gdHdvIHR5cGUgb2YgaW50ZXJmYWNlcy4KTWF5YmUgdXNlIHRoZSB3YXkgYXMgd2hh
dCBWTVN0YXRlRGVzY3JpcHRpb24gZGlkLCBpLmUuIHVzaW5nIGZpZWxkIGxpc3QgYW5kCm1hY3Jv
cz8KCj4gQWxzbyB3aGF0IGhhcHBlbnMgaWYgdGhlIGRhdGEgcmVhZCBmcm9tIHRoZSBtaWdyYXRp
b24gc3RyZWFtIGlzIGJhZCBvcgo+IGRvZXNuJ3QgYWdyZWUgd2l0aCB0aGlzIGRldmljZXMgaGFy
ZHdhcmU/IEhvdyBkb2VzIHRoaXMgZmFpbD8KPgpyaWdodCwgZXJyb3JzIGluIG1pZ3JhdGlvbiBz
dHJlYW0gbmVlZHMgdG8gYmUgY2hlY2tlZC4gSSdsbCBhZGQgdGhlIGVycm9yCmNoZWNrLgpGb3Ig
dGhlIGhhcmR3YXJlIGluY29tcGF0aWFibGUgaXNzdWUsIHNlZW1zIHZmaW9fcGNpX3dyaXRlX2Nv
bmZpZyBkb2VzIG5vdApyZXR1cm4gZXJyb3IgaWYgZGV2aWNlIGRyaXZlciByZXR1cm5zIGVycm9y
IGZvciB0aGlzIHdyaXRlLgpTZWVtcyBpdCBuZWVkcyB0byBiZSBhZGRyZXNzZWQgaW4gc29tZXdo
ZXJlIGVsc2UgbGlrZSBjaGVja2luZwpjb21waXRpYmlsaXR5IGJlZm9yZSBsYXVjaGluZyBtaWdy
YXRpb24uCj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgdmZpb19sb2FkX3N0YXRlKFFFTVVG
aWxlICpmLCB2b2lkICpvcGFxdWUsIGludCB2ZXJzaW9uX2lkKQo+ID4gK3sKPiA+ICsgICAgVkZJ
T1BDSURldmljZSAqdmRldiA9IG9wYXF1ZTsKPiA+ICsgICAgaW50IGZsYWc7Cj4gPiArICAgIHVp
bnQ2NF90IGxlbjsKPiA+ICsgICAgaW50IHJldCA9IDA7Cj4gPiArCj4gPiArICAgIGlmICh2ZXJz
aW9uX2lkICE9IFZGSU9fREVWSUNFX1NUQVRFX0lOVEVSRkFDRV9WRVJTSU9OKSB7Cj4gPiArICAg
ICAgICByZXR1cm4gLUVJTlZBTDsKPiA+ICsgICAgfQo+ID4gKwo+ID4gKyAgICBkbyB7Cj4gPiAr
ICAgICAgICBmbGFnID0gcWVtdV9nZXRfYnl0ZShmKTsKPiA+ICsKPiA+ICsgICAgICAgIHN3aXRj
aCAoZmxhZyAmIH5WRklPX1NBVkVfRkxBR19DT05USU5VRSkgewo+ID4gKyAgICAgICAgY2FzZSBW
RklPX1NBVkVfRkxBR19TRVRVUDoKPiA+ICsgICAgICAgICAgICBicmVhazsKPiA+ICsgICAgICAg
IGNhc2UgVkZJT19TQVZFX0ZMQUdfUENJOgo+ID4gKyAgICAgICAgICAgIHZmaW9fcGNpX2xvYWRf
Y29uZmlnKHZkZXYsIGYpOwo+ID4gKyAgICAgICAgICAgIGJyZWFrOwo+ID4gKyAgICAgICAgY2Fz
ZSBWRklPX1NBVkVfRkxBR19ERVZDT05GSUc6Cj4gPiArICAgICAgICAgICAgbGVuID0gcWVtdV9n
ZXRfYmU2NChmKTsKPiA+ICsgICAgICAgICAgICB2ZmlvX2xvYWRfZGF0YV9kZXZpY2VfY29uZmln
KHZkZXYsIGYsIGxlbik7Cj4gPiArICAgICAgICAgICAgYnJlYWs7Cj4gPiArICAgICAgICBkZWZh
dWx0Ogo+ID4gKyAgICAgICAgICAgIHJldCA9IC1FSU5WQUw7Cj4gPiArICAgICAgICB9Cj4gPiAr
ICAgIH0gd2hpbGUgKGZsYWcgJiBWRklPX1NBVkVfRkxBR19DT05USU5VRSk7Cj4gPiArCj4gPiAr
ICAgIHJldHVybiByZXQ7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIHZmaW9fcGNpX3Nh
dmVfY29uZmlnKFZGSU9QQ0lEZXZpY2UgKnZkZXYsIFFFTVVGaWxlICpmKQo+ID4gK3sKPiA+ICsg
ICAgUENJRGV2aWNlICpwZGV2ID0gJnZkZXYtPnBkZXY7Cj4gPiArICAgIHVpbnQzMl90IG1zaV9j
ZmcsIG1zaV9sbywgbXNpX2hpLCBtc2lfZGF0YSwgYmFyX2NmZywgaTsKPiA+ICsgICAgYm9vbCBt
c2lfNjRiaXQ7Cj4gPiArCj4gPiArICAgIGZvciAoaSA9IDA7IGkgPCBQQ0lfUk9NX1NMT1Q7IGkr
Kykgewo+ID4gKyAgICAgICAgYmFyX2NmZyA9IHBjaV9kZWZhdWx0X3JlYWRfY29uZmlnKHBkZXYs
IFBDSV9CQVNFX0FERFJFU1NfMCArIGkgKiA0LCA0KTsKPiA+ICsgICAgICAgIHFlbXVfcHV0X2Jl
MzIoZiwgYmFyX2NmZyk7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgbXNpX2NmZyA9IHBjaV9k
ZWZhdWx0X3JlYWRfY29uZmlnKHBkZXYsIHBkZXYtPm1zaV9jYXAgKyBQQ0lfTVNJX0ZMQUdTLCAy
KTsKPiA+ICsgICAgbXNpXzY0Yml0ID0gISEobXNpX2NmZyAmIFBDSV9NU0lfRkxBR1NfNjRCSVQp
Owo+ID4gKwo+ID4gKyAgICBtc2lfbG8gPSBwY2lfZGVmYXVsdF9yZWFkX2NvbmZpZyhwZGV2LAo+
ID4gKyAgICAgICAgICAgIHBkZXYtPm1zaV9jYXAgKyBQQ0lfTVNJX0FERFJFU1NfTE8sIDQpOwo+
ID4gKyAgICBxZW11X3B1dF9iZTMyKGYsIG1zaV9sbyk7Cj4gPiArCj4gPiArICAgIGlmIChtc2lf
NjRiaXQpIHsKPiA+ICsgICAgICAgIG1zaV9oaSA9IHBjaV9kZWZhdWx0X3JlYWRfY29uZmlnKHBk
ZXYsCj4gPiArICAgICAgICAgICAgICAgIHBkZXYtPm1zaV9jYXAgKyBQQ0lfTVNJX0FERFJFU1Nf
SEksCj4gPiArICAgICAgICAgICAgICAgIDQpOwo+ID4gKyAgICAgICAgcWVtdV9wdXRfYmUzMihm
LCBtc2lfaGkpOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIG1zaV9kYXRhID0gcGNpX2RlZmF1
bHRfcmVhZF9jb25maWcocGRldiwKPiA+ICsgICAgICAgICAgICBwZGV2LT5tc2lfY2FwICsgKG1z
aV82NGJpdCA/IFBDSV9NU0lfREFUQV82NCA6IFBDSV9NU0lfREFUQV8zMiksCj4gPiArICAgICAg
ICAgICAgMik7Cj4gPiArICAgIHFlbXVfcHV0X2JlMzIoZiwgbXNpX2RhdGEpOwo+ID4gKwo+ID4g
K30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IHZmaW9fc2F2ZV9jb21wbGV0ZV9wcmVjb3B5KFFFTVVG
aWxlICpmLCB2b2lkICpvcGFxdWUpCj4gPiArewo+ID4gKyAgICBWRklPUENJRGV2aWNlICp2ZGV2
ID0gb3BhcXVlOwo+ID4gKyAgICBpbnQgcmMgPSAwOwo+ID4gKwo+ID4gKyAgICBxZW11X3B1dF9i
eXRlKGYsIFZGSU9fU0FWRV9GTEFHX1BDSSB8IFZGSU9fU0FWRV9GTEFHX0NPTlRJTlVFKTsKPiA+
ICsgICAgdmZpb19wY2lfc2F2ZV9jb25maWcodmRldiwgZik7Cj4gPiArCj4gPiArICAgIHFlbXVf
cHV0X2J5dGUoZiwgVkZJT19TQVZFX0ZMQUdfREVWQ09ORklHKTsKPiA+ICsgICAgcmMgKz0gdmZp
b19nZXRfZGV2aWNlX2NvbmZpZ19zaXplKHZkZXYpOwo+ID4gKyAgICByYyArPSB2ZmlvX3NhdmVf
ZGF0YV9kZXZpY2VfY29uZmlnKHZkZXYsIGYpOwo+ID4gKwo+ID4gKyAgICByZXR1cm4gcmM7Cj4g
PiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgdmZpb19zYXZlX3NldHVwKFFFTVVGaWxlICpmLCB2
b2lkICpvcGFxdWUpCj4gPiArewo+ID4gKyAgICBWRklPUENJRGV2aWNlICp2ZGV2ID0gb3BhcXVl
Owo+ID4gKyAgICBxZW11X3B1dF9ieXRlKGYsIFZGSU9fU0FWRV9GTEFHX1NFVFVQKTsKPiA+ICsK
PiA+ICsgICAgdmZpb19zZXRfZGV2aWNlX3N0YXRlKHZkZXYsIFZGSU9fREVWSUNFX1NUQVRFX1JV
Tk5JTkcgfAo+ID4gKyAgICAgICAgICAgIFZGSU9fREVWSUNFX1NUQVRFX0xPR0dJTkcpOwo+ID4g
KyAgICByZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCB2ZmlvX2xvYWRfc2V0
dXAoUUVNVUZpbGUgKmYsIHZvaWQgKm9wYXF1ZSkKPiA+ICt7Cj4gPiArICAgIHJldHVybiAwOwo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCB2ZmlvX3NhdmVfY2xlYW51cCh2b2lkICpvcGFx
dWUpCj4gPiArewo+ID4gKyAgICBWRklPUENJRGV2aWNlICp2ZGV2ID0gb3BhcXVlOwo+ID4gKyAg
ICB1aW50MzJfdCBkZXZfc3RhdGUgPSB2ZGV2LT5taWdyYXRpb24tPmRldmljZV9zdGF0ZTsKPiA+
ICsKPiA+ICsgICAgZGV2X3N0YXRlICY9IH5WRklPX0RFVklDRV9TVEFURV9MT0dHSU5HOwo+ID4g
Kwo+ID4gKyAgICB2ZmlvX3NldF9kZXZpY2Vfc3RhdGUodmRldiwgZGV2X3N0YXRlKTsKPiA+ICt9
Cj4gPiArCj4gPiArc3RhdGljIFNhdmVWTUhhbmRsZXJzIHNhdmV2bV92ZmlvX2hhbmRsZXJzID0g
ewo+ID4gKyAgICAuc2F2ZV9zZXR1cCA9IHZmaW9fc2F2ZV9zZXR1cCwKPiA+ICsgICAgLnNhdmVf
bGl2ZV9wZW5kaW5nID0gdmZpb19zYXZlX2xpdmVfcGVuZGluZywKPiA+ICsgICAgLnNhdmVfbGl2
ZV9pdGVyYXRlID0gdmZpb19zYXZlX2l0ZXJhdGUsCj4gPiArICAgIC5zYXZlX2xpdmVfY29tcGxl
dGVfcHJlY29weSA9IHZmaW9fc2F2ZV9jb21wbGV0ZV9wcmVjb3B5LAo+ID4gKyAgICAuc2F2ZV9j
bGVhbnVwID0gdmZpb19zYXZlX2NsZWFudXAsCj4gPiArICAgIC5sb2FkX3NldHVwID0gdmZpb19s
b2FkX3NldHVwLAo+ID4gKyAgICAubG9hZF9zdGF0ZSA9IHZmaW9fbG9hZF9zdGF0ZSwKPiA+ICt9
Owo+ID4gKwo+ID4gK2ludCB2ZmlvX21pZ3JhdGlvbl9pbml0KFZGSU9QQ0lEZXZpY2UgKnZkZXYs
IEVycm9yICoqZXJycCkKPiA+ICt7Cj4gPiArICAgIGludCByZXQ7Cj4gPiArICAgIEVycm9yICps
b2NhbF9lcnIgPSBOVUxMOwo+ID4gKyAgICB2ZGV2LT5taWdyYXRpb24gPSBnX25ldzAoVkZJT01p
Z3JhdGlvbiwgMSk7Cj4gPiArCj4gPiArICAgIGlmICh2ZmlvX2RldmljZV9zdGF0ZV9yZWdpb25f
c2V0dXAodmRldiwKPiA+ICsgICAgICAgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltW
RklPX0RFVlNUQVRFX1JFR0lPTl9DVExdLAo+ID4gKyAgICAgICAgICAgICAgVkZJT19SRUdJT05f
U1VCVFlQRV9ERVZJQ0VfU1RBVEVfQ1RMLAo+ID4gKyAgICAgICAgICAgICAgImRldmljZS1zdGF0
ZS1jdGwiKSkgewo+ID4gKyAgICAgICAgZ290byBlcnJvcjsKPiA+ICsgICAgfQo+ID4gKwo+ID4g
KyAgICBpZiAodmZpb19jaGVja19kZXZzdGF0ZV92ZXJzaW9uKHZkZXYpKSB7Cj4gPiArICAgICAg
ICBnb3RvIGVycm9yOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIGlmICh2ZmlvX2dldF9kZXZp
Y2VfZGF0YV9jYXBzKHZkZXYpKSB7Cj4gPiArICAgICAgICBnb3RvIGVycm9yOwo+ID4gKyAgICB9
Cj4gPiArCj4gPiArICAgIGlmICh2ZmlvX2RldmljZV9zdGF0ZV9yZWdpb25fc2V0dXAodmRldiwK
PiA+ICsgICAgICAgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRF
X1JFR0lPTl9EQVRBX0NPTkZJR10sCj4gPiArICAgICAgICAgICAgICBWRklPX1JFR0lPTl9TVUJU
WVBFX0RFVklDRV9TVEFURV9EQVRBX0NPTkZJRywKPiA+ICsgICAgICAgICAgICAgICJkZXZpY2Ut
c3RhdGUtZGF0YS1kZXZpY2UtY29uZmlnIikpIHsKPiA+ICsgICAgICAgIGdvdG8gZXJyb3I7Cj4g
PiArICAgIH0KPiA+ICsKPiA+ICsgICAgaWYgKHZmaW9fZGV2aWNlX2RhdGFfY2FwX2RldmljZV9t
ZW1vcnkodmRldikpIHsKPiA+ICsgICAgICAgIGVycm9yX3JlcG9ydCgiTm8gc3VwcHBvcnQgb2Yg
ZGF0YSBjYXAgZGV2aWNlIG1lbW9yeSBZZXQiKTsKPiA+ICsgICAgICAgIGdvdG8gZXJyb3I7Cj4g
PiArICAgIH0KPiA+ICsKPiA+ICsgICAgaWYgKHZmaW9fZGV2aWNlX2RhdGFfY2FwX3N5c3RlbV9t
ZW1vcnkodmRldikgJiYKPiA+ICsgICAgICAgICAgICB2ZmlvX2RldmljZV9zdGF0ZV9yZWdpb25f
c2V0dXAodmRldiwKPiA+ICsgICAgICAgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltW
RklPX0RFVlNUQVRFX1JFR0lPTl9EQVRBX0JJVE1BUF0sCj4gPiArICAgICAgICAgICAgICBWRklP
X1JFR0lPTl9TVUJUWVBFX0RFVklDRV9TVEFURV9EQVRBX0RJUlRZQklUTUFQLAo+ID4gKyAgICAg
ICAgICAgICAgImRldmljZS1zdGF0ZS1kYXRhLWRpcnR5Yml0bWFwIikpIHsKPiA+ICsgICAgICAg
IGdvdG8gZXJyb3I7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgdmRldi0+bWlncmF0aW9uLT5k
ZXZpY2Vfc3RhdGUgPSBWRklPX0RFVklDRV9TVEFURV9SVU5OSU5HOwo+ID4gKwo+ID4gKyAgICBy
ZWdpc3Rlcl9zYXZldm1fbGl2ZShOVUxMLCBUWVBFX1ZGSU9fUENJLCAtMSwKPiA+ICsgICAgICAg
ICAgICBWRklPX0RFVklDRV9TVEFURV9JTlRFUkZBQ0VfVkVSU0lPTiwKPiA+ICsgICAgICAgICAg
ICAmc2F2ZXZtX3ZmaW9faGFuZGxlcnMsCj4gPiArICAgICAgICAgICAgdmRldik7Cj4gPiArCj4g
PiArICAgIHZkZXYtPm1pZ3JhdGlvbi0+dm1fc3RhdGUgPQo+ID4gKyAgICAgICAgcWVtdV9hZGRf
dm1fY2hhbmdlX3N0YXRlX2hhbmRsZXIodmZpb192bV9jaGFuZ2Vfc3RhdGVfaGFuZGxlciwgdmRl
dik7Cj4gPiArCj4gPiArICAgIHJldHVybiAwOwo+ID4gK2Vycm9yOgo+ID4gKyAgICBlcnJvcl9z
ZXRnKCZ2ZGV2LT5taWdyYXRpb25fYmxvY2tlciwKPiA+ICsgICAgICAgICAgICAiVkZJTyBkZXZp
Y2UgZG9lc24ndCBzdXBwb3J0IG1pZ3JhdGlvbiIpOwo+ID4gKyAgICByZXQgPSBtaWdyYXRlX2Fk
ZF9ibG9ja2VyKHZkZXYtPm1pZ3JhdGlvbl9ibG9ja2VyLCAmbG9jYWxfZXJyKTsKPiA+ICsgICAg
aWYgKGxvY2FsX2Vycikgewo+ID4gKyAgICAgICAgZXJyb3JfcHJvcGFnYXRlKGVycnAsIGxvY2Fs
X2Vycik7Cj4gPiArICAgICAgICBlcnJvcl9mcmVlKHZkZXYtPm1pZ3JhdGlvbl9ibG9ja2VyKTsK
PiA+ICsgICAgfQo+ID4gKwo+ID4gKyAgICBnX2ZyZWUodmRldi0+bWlncmF0aW9uKTsKPiA+ICsg
ICAgdmRldi0+bWlncmF0aW9uID0gTlVMTDsKPiA+ICsKPiA+ICsgICAgcmV0dXJuIHJldDsKPiA+
ICt9Cj4gPiArCj4gPiArdm9pZCB2ZmlvX21pZ3JhdGlvbl9maW5hbGl6ZShWRklPUENJRGV2aWNl
ICp2ZGV2KQo+ID4gK3sKPiA+ICsgICAgaWYgKHZkZXYtPm1pZ3JhdGlvbikgewo+ID4gKyAgICAg
ICAgaW50IGk7Cj4gPiArICAgICAgICBxZW11X2RlbF92bV9jaGFuZ2Vfc3RhdGVfaGFuZGxlcih2
ZGV2LT5taWdyYXRpb24tPnZtX3N0YXRlKTsKPiA+ICsgICAgICAgIHVucmVnaXN0ZXJfc2F2ZXZt
KE5VTEwsIFRZUEVfVkZJT19QQ0ksIHZkZXYpOwo+ID4gKyAgICAgICAgZm9yIChpID0gMDsgaSA8
IFZGSU9fREVWU1RBVEVfUkVHSU9OX05VTTsgaSsrKSB7Cj4gPiArICAgICAgICAgICAgdmZpb19y
ZWdpb25fZmluYWxpemUoJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW2ldKTsKPiA+ICsgICAgICAg
IH0KPiA+ICsgICAgICAgIGdfZnJlZSh2ZGV2LT5taWdyYXRpb24pOwo+ID4gKyAgICAgICAgdmRl
di0+bWlncmF0aW9uID0gTlVMTDsKPiA+ICsgICAgfSBlbHNlIGlmICh2ZGV2LT5taWdyYXRpb25f
YmxvY2tlcikgewo+ID4gKyAgICAgICAgbWlncmF0ZV9kZWxfYmxvY2tlcih2ZGV2LT5taWdyYXRp
b25fYmxvY2tlcik7Cj4gPiArICAgICAgICBlcnJvcl9mcmVlKHZkZXYtPm1pZ3JhdGlvbl9ibG9j
a2VyKTsKPiA+ICsgICAgfQo+ID4gK30KPiA+IGRpZmYgLS1naXQgYS9ody92ZmlvL3BjaS5jIGIv
aHcvdmZpby9wY2kuYwo+ID4gaW5kZXggYzBjYjFlYy4uYjhlMDA2YiAxMDA2NDQKPiA+IC0tLSBh
L2h3L3ZmaW8vcGNpLmMKPiA+ICsrKyBiL2h3L3ZmaW8vcGNpLmMKPiA+IEBAIC0zNyw3ICszNyw2
IEBACj4gPiAgCj4gPiAgI2RlZmluZSBNU0lYX0NBUF9MRU5HVEggMTIKPiA+ICAKPiA+IC0jZGVm
aW5lIFRZUEVfVkZJT19QQ0kgInZmaW8tcGNpIgo+ID4gICNkZWZpbmUgUENJX1ZGSU8ob2JqKSAg
ICBPQkpFQ1RfQ0hFQ0soVkZJT1BDSURldmljZSwgb2JqLCBUWVBFX1ZGSU9fUENJKQo+ID4gIAo+
ID4gIHN0YXRpYyB2b2lkIHZmaW9fZGlzYWJsZV9pbnRlcnJ1cHRzKFZGSU9QQ0lEZXZpY2UgKnZk
ZXYpOwo+ID4gZGlmZiAtLWdpdCBhL2h3L3ZmaW8vcGNpLmggYi9ody92ZmlvL3BjaS5oCj4gPiBp
bmRleCBiMWFlNGMwLi40YjdiMWJiIDEwMDY0NAo+ID4gLS0tIGEvaHcvdmZpby9wY2kuaAo+ID4g
KysrIGIvaHcvdmZpby9wY2kuaAo+ID4gQEAgLTE5LDYgKzE5LDcgQEAKPiA+ICAjaW5jbHVkZSAi
cWVtdS9ldmVudF9ub3RpZmllci5oIgo+ID4gICNpbmNsdWRlICJxZW11L3F1ZXVlLmgiCj4gPiAg
I2luY2x1ZGUgInFlbXUvdGltZXIuaCIKPiA+ICsjaW5jbHVkZSAic3lzZW11L3N5c2VtdS5oIgo+
ID4gIAo+ID4gICNkZWZpbmUgUENJX0FOWV9JRCAofjApCj4gPiAgCj4gPiBAQCAtNTYsNiArNTcs
MjEgQEAgdHlwZWRlZiBzdHJ1Y3QgVkZJT0JBUiB7Cj4gPiAgICAgIFFMSVNUX0hFQUQoLCBWRklP
UXVpcmspIHF1aXJrczsKPiA+ICB9IFZGSU9CQVI7Cj4gPiAgCj4gPiArZW51bSB7Cj4gPiArICAg
IFZGSU9fREVWU1RBVEVfUkVHSU9OX0NUTCA9IDAsCj4gPiArICAgIFZGSU9fREVWU1RBVEVfUkVH
SU9OX0RBVEFfQ09ORklHLAo+ID4gKyAgICBWRklPX0RFVlNUQVRFX1JFR0lPTl9EQVRBX0RFVklD
RV9NRU1PUlksCj4gPiArICAgIFZGSU9fREVWU1RBVEVfUkVHSU9OX0RBVEFfQklUTUFQLAo+ID4g
KyAgICBWRklPX0RFVlNUQVRFX1JFR0lPTl9OVU0sCj4gPiArfTsKPiA+ICt0eXBlZGVmIHN0cnVj
dCBWRklPTWlncmF0aW9uIHsKPiA+ICsgICAgVkZJT1JlZ2lvbiByZWdpb25bVkZJT19ERVZTVEFU
RV9SRUdJT05fTlVNXTsKPiA+ICsgICAgdWludDMyX3QgZGF0YV9jYXBzOwo+ID4gKyAgICB1aW50
MzJfdCBkZXZpY2Vfc3RhdGU7Cj4gPiArICAgIHVpbnQ2NF90IGRldmNvbmZpZ19zaXplOwo+ID4g
KyAgICBWTUNoYW5nZVN0YXRlRW50cnkgKnZtX3N0YXRlOwo+ID4gK30gVkZJT01pZ3JhdGlvbjsK
PiA+ICsKPiA+ICB0eXBlZGVmIHN0cnVjdCBWRklPVkdBUmVnaW9uIHsKPiA+ICAgICAgTWVtb3J5
UmVnaW9uIG1lbTsKPiA+ICAgICAgb2ZmX3Qgb2Zmc2V0Owo+ID4gQEAgLTEzMiw2ICsxNDgsOCBA
QCB0eXBlZGVmIHN0cnVjdCBWRklPUENJRGV2aWNlIHsKPiA+ICAgICAgVkZJT0JBUiBiYXJzW1BD
SV9OVU1fUkVHSU9OUyAtIDFdOyAvKiBObyBST00gKi8KPiA+ICAgICAgVkZJT1ZHQSAqdmdhOyAv
KiAweGEwMDAwLCAweDNiMCwgMHgzYzAgKi8KPiA+ICAgICAgdm9pZCAqaWdkX29wcmVnaW9uOwo+
ID4gKyAgICBWRklPTWlncmF0aW9uICptaWdyYXRpb247Cj4gPiArICAgIEVycm9yICptaWdyYXRp
b25fYmxvY2tlcjsKPiA+ICAgICAgUENJSG9zdERldmljZUFkZHJlc3MgaG9zdDsKPiA+ICAgICAg
RXZlbnROb3RpZmllciBlcnJfbm90aWZpZXI7Cj4gPiAgICAgIEV2ZW50Tm90aWZpZXIgcmVxX25v
dGlmaWVyOwo+ID4gQEAgLTE5OCw1ICsyMTYsMTAgQEAgaW50IHZmaW9fcGNpX2lnZF9vcHJlZ2lv
bl9pbml0KFZGSU9QQ0lEZXZpY2UgKnZkZXYsCj4gPiAgdm9pZCB2ZmlvX2Rpc3BsYXlfcmVzZXQo
VkZJT1BDSURldmljZSAqdmRldik7Cj4gPiAgaW50IHZmaW9fZGlzcGxheV9wcm9iZShWRklPUENJ
RGV2aWNlICp2ZGV2LCBFcnJvciAqKmVycnApOwo+ID4gIHZvaWQgdmZpb19kaXNwbGF5X2ZpbmFs
aXplKFZGSU9QQ0lEZXZpY2UgKnZkZXYpOwo+ID4gLQo+ID4gK2Jvb2wgdmZpb19kZXZpY2VfZGF0
YV9jYXBfc3lzdGVtX21lbW9yeShWRklPUENJRGV2aWNlICp2ZGV2KTsKPiA+ICtib29sIHZmaW9f
ZGV2aWNlX2RhdGFfY2FwX2RldmljZV9tZW1vcnkoVkZJT1BDSURldmljZSAqdmRldik7Cj4gPiAr
aW50IHZmaW9fc2V0X2RpcnR5X3BhZ2VfYml0bWFwKFZGSU9QQ0lEZXZpY2UgKnZkZXYsCj4gPiAr
ICAgICAgICAgdWludDY0X3Qgc3RhcnRfYWRkciwgdWludDY0X3QgcGFnZV9ucik7Cj4gPiAraW50
IHZmaW9fbWlncmF0aW9uX2luaXQoVkZJT1BDSURldmljZSAqdmRldiwgRXJyb3IgKiplcnJwKTsK
PiA+ICt2b2lkIHZmaW9fbWlncmF0aW9uX2ZpbmFsaXplKFZGSU9QQ0lEZXZpY2UgKnZkZXYpOwo+
ID4gICNlbmRpZiAvKiBIV19WRklPX1ZGSU9fUENJX0ggKi8KPiA+IGRpZmYgLS1naXQgYS9pbmNs
dWRlL2h3L3ZmaW8vdmZpby1jb21tb24uaCBiL2luY2x1ZGUvaHcvdmZpby92ZmlvLWNvbW1vbi5o
Cj4gPiBpbmRleCAxYjQzNGQwLi5lZDQzNjEzIDEwMDY0NAo+ID4gLS0tIGEvaW5jbHVkZS9ody92
ZmlvL3ZmaW8tY29tbW9uLmgKPiA+ICsrKyBiL2luY2x1ZGUvaHcvdmZpby92ZmlvLWNvbW1vbi5o
Cj4gPiBAQCAtMzIsNiArMzIsNyBAQAo+ID4gICNlbmRpZgo+ID4gIAo+ID4gICNkZWZpbmUgVkZJ
T19NU0dfUFJFRklYICJ2ZmlvICVzOiAiCj4gPiArI2RlZmluZSBUWVBFX1ZGSU9fUENJICJ2Zmlv
LXBjaSIKPiA+ICAKPiA+ICBlbnVtIHsKPiA+ICAgICAgVkZJT19ERVZJQ0VfVFlQRV9QQ0kgPSAw
LAo+ID4gLS0gCj4gPiAyLjcuNAo+ID4gCj4gLS0KPiBEci4gRGF2aWQgQWxhbiBHaWxiZXJ0IC8g
ZGdpbGJlcnRAcmVkaGF0LmNvbSAvIE1hbmNoZXN0ZXIsIFVLCj4gX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KPiBpbnRlbC1ndnQtZGV2IG1haWxpbmcgbGlz
dAo+IGludGVsLWd2dC1kZXZAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4gaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1ndnQtZGV2Cl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmludGVsLWd2dC1kZXYgbWFpbGlu
ZyBsaXN0CmludGVsLWd2dC1kZXZAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ3Z0LWRldg==
