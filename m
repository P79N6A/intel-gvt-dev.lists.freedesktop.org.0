Delivered-To: linux.kernel.mailinglists@gmail.com
Received: by 2002:a81:3684:0:0:0:0:0 with SMTP id d126csp3366911ywa;
        Tue, 19 Feb 2019 06:37:42 -0800 (PST)
X-Google-Smtp-Source: AHgI3IbtvpykcBzBUC7bame0mJghgf1mVoK3rCTL+Abu6CO5iQnQB9z/X0lKDJnz+99929716DnA
X-Received: by 2002:a62:e50b:: with SMTP id n11mr29541514pff.212.1550587062810;
        Tue, 19 Feb 2019 06:37:42 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1550587062; cv=none;
        d=google.com; s=arc-20160816;
        b=BAwKFF/p3djgO1v4jERAb8MmWRHB8qO3upBOFZM7gxjiHm4JvsbGWMEEmK6FuOo9S+
         OIWrk/WiUOAZ2V41vgBXnaKfgtxVAus2L3FGzHBgCOzXMcx+Nz4TkXP0qznKFFKRL9ut
         unOyMcuYM3gkmnLG/6x41PIS/KujTlRoAvIWY3TqClzwPbi+ij5P8sTv0rlgijRgloM5
         SwovGyatY08YYi4WeELB9MGbxjRsfm/Sio7tDcjaq53GAumJj2NUwoGak1UKbUHga0Gm
         rGzGHW/sG2yGEnEuSO4aTnvQOvDcVHPj6ZZVC3lf1guZMLyztPLOWetwE+HO919RDLhp
         zCqw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-archive:list-unsubscribe:list-id
         :precedence:mime-version:organization:references:in-reply-to
         :message-id:subject:to:from:date:delivered-to;
        bh=z2hfrhkJk+PQxStH9+M6xjN2sqk5YzfXlfjbVffn9D0=;
        b=X3zSHoYy11xhSzxuvAMABYjh269D2UoKHTXUzvQAqb56r7x3Q1MTFzqi105mUFILDa
         Xh3JqUoA9kyUD6bg/JjpIIAKQQ3Durr2iK1NXuvWt0BqZJGIoKKnmbPo4aS9oN6cCBP4
         ri8dRgpeUU9AbgI1ed4lmQLY2X+N1iycv5MpYpFlC/9mkMTAZDIFq7LE/AQv2LqC7kwn
         RtnfbAvVMP3YPgzVQWSwG+3VLgxnv6cL7U72l+8SUl/HaVa0cqk6jT03rraqhZJfr5ci
         zzKqr7E3xnn5PLATWwua1Mtwvyd0VXYYp6GG/0QK08mhnOHNOtGmfkLLXQbTvxouV0/z
         fWYw==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 131.252.210.177 as permitted sender) smtp.mailfrom=intel-gvt-dev-bounces@lists.freedesktop.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=redhat.com
Return-Path: <intel-gvt-dev-bounces@lists.freedesktop.org>
Received: from gabe.freedesktop.org (gabe.freedesktop.org. [131.252.210.177])
        by mx.google.com with ESMTPS id d34si17525829pla.80.2019.02.19.06.37.42
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Tue, 19 Feb 2019 06:37:42 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 131.252.210.177 as permitted sender) client-ip=131.252.210.177;
Authentication-Results: mx.google.com;
       spf=pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 131.252.210.177 as permitted sender) smtp.mailfrom=intel-gvt-dev-bounces@lists.freedesktop.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=redhat.com
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 021C789235;
	Tue, 19 Feb 2019 14:37:42 +0000 (UTC)
X-Original-To: intel-gvt-dev@lists.freedesktop.org
Delivered-To: intel-gvt-dev@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 27B0B89235
 for <intel-gvt-dev@lists.freedesktop.org>;
 Tue, 19 Feb 2019 14:37:40 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id AC010C01D33A;
 Tue, 19 Feb 2019 14:37:37 +0000 (UTC)
Received: from gondolin (dhcp-192-187.str.redhat.com [10.33.192.187])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 7D8045D6AA;
 Tue, 19 Feb 2019 14:37:27 +0000 (UTC)
Date: Tue, 19 Feb 2019 15:37:24 +0100
From: Cornelia Huck <cohuck@redhat.com>
To: Yan Zhao <yan.y.zhao@intel.com>
Subject: Re: [PATCH 2/5] vfio/migration: support device of device config
 capability
Message-ID: <20190219153724.12460160.cohuck@redhat.com>
In-Reply-To: <1550566347-3648-1-git-send-email-yan.y.zhao@intel.com>
References: <1550566254-3545-1-git-send-email-yan.y.zhao@intel.com>
 <1550566347-3648-1-git-send-email-yan.y.zhao@intel.com>
Organization: Red Hat GmbH
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.31]); Tue, 19 Feb 2019 14:37:39 +0000 (UTC)
X-BeenThere: intel-gvt-dev@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: "Intel GVT \(Graphics Virtualization\) development list"
 <intel-gvt-dev.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gvt-dev>
List-Post: <mailto:intel-gvt-dev@lists.freedesktop.org>
List-Help: <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=subscribe>
Cc: cjia@nvidia.com, kvm@vger.kernel.org, aik@ozlabs.ru,
 Zhengxiao.zx@Alibaba-inc.com, shuangtai.tst@alibaba-inc.com,
 qemu-devel@nongnu.org, kwankhede@nvidia.com, eauger@redhat.com,
 yi.l.liu@intel.com, eskultet@redhat.com, ziye.yang@intel.com,
 mlevitsk@redhat.com, pasic@linux.ibm.com, arei.gonglei@huawei.com,
 felipe@nutanix.com, Ken.Xue@amd.com, kevin.tian@intel.com, dgilbert@redhat.com,
 alex.williamson@redhat.com, intel-gvt-dev@lists.freedesktop.org,
 changpeng.liu@intel.com, zhi.a.wang@intel.com, jonathan.davies@nutanix.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gvt-dev-bounces@lists.freedesktop.org
Sender: "intel-gvt-dev" <intel-gvt-dev-bounces@lists.freedesktop.org>

T24gVHVlLCAxOSBGZWIgMjAxOSAxNjo1MjoyNyArMDgwMApZYW4gWmhhbyA8eWFuLnkuemhhb0Bp
bnRlbC5jb20+IHdyb3RlOgoKPiBEZXZpY2UgY29uZmlnIGlzIHRoZSBkZWZhdWx0IGRhdGEgdGhh
dCBldmVyeSBkZXZpY2Ugc2hvdWxkIGhhdmUuIHNvCj4gZGV2aWNlIGNvbmZpZyBjYXBhYmlsaXR5
IGlzIGJ5IGRlZmF1bHQgb24sIG5vIG5lZWQgdG8gc2V0Lgo+IAo+IC0gQ3VycmVudGx5IHR3byB0
eXBlIG9mIHJlc291cmNlcyBhcmUgc2F2ZWQvbG9hZGVkIGZvciBkZXZpY2Ugb2YgZGV2aWNlCj4g
ICBjb25maWcgY2FwYWJpbGl0eToKPiAgIEdlbmVyYWwgUENJIGNvbmZpZyBkYXRhLCBhbmQgRGV2
aWNlIGNvbmZpZyBkYXRhLgo+ICAgVGhleSBhcmUgY29waWVzIGFzIGEgd2hvbGUgd2hlbiBwcmVj
b3B5IGlzIHN0b3BwZWQuCj4gCj4gTWlncmF0aW9uIHNldHVwIGZsb3c6Cj4gLSBTZXR1cCBkZXZp
Y2Ugc3RhdGUgcmVnaW9ucywgY2hlY2sgaXRzIGRldmljZSBzdGF0ZSB2ZXJzaW9uIGFuZCBjYXBh
YmlsaXRpZXMuCj4gICBNbWFwIERldmljZSBDb25maWcgUmVnaW9uIGFuZCBEaXJ0eSBCaXRtYXAg
UmVnaW9uLCBpZiBhdmFpbGFibGUuCj4gLSBJZiBkZXZpY2Ugc3RhdGUgcmVnaW9ucyBhcmUgZmFp
bGVkIHRvIGdldCBzZXR1cCwgYSBtaWdyYXRpb24gYmxvY2tlciBpcwo+ICAgcmVnaXN0ZXJlZCBp
bnN0ZWFkLgo+IC0gQWRkZWQgU2F2ZVZNSGFuZGxlcnMgdG8gcmVnaXN0ZXIgZGV2aWNlIHN0YXRl
IHNhdmUvbG9hZCBoYW5kbGVycy4KPiAtIFJlZ2lzdGVyIFZNIHN0YXRlIGNoYW5nZSBoYW5kbGVy
IHRvIHNldCBkZXZpY2UncyBydW5uaW5nL3N0b3Agc3RhdGVzLgo+IC0gT24gbWlncmF0aW9uIHN0
YXJ0dXAgb24gc291cmNlIG1hY2hpbmUsIHNldCBkZXZpY2UncyBzdGF0ZSB0bwo+ICAgVkZJT19E
RVZJQ0VfU1RBVEVfTE9HR0lORwo+IAo+IFNpZ25lZC1vZmYtYnk6IFlhbiBaaGFvIDx5YW4ueS56
aGFvQGludGVsLmNvbT4KPiBTaWduZWQtb2ZmLWJ5OiBZdWxlaSBaaGFuZyA8eXVsZWkuemhhbmdA
aW50ZWwuY29tPgo+IC0tLQo+ICBody92ZmlvL01ha2VmaWxlLm9ianMgICAgICAgICB8ICAgMiAr
LQo+ICBody92ZmlvL21pZ3JhdGlvbi5jICAgICAgICAgICB8IDYzMyArKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysKPiAgaHcvdmZpby9wY2kuYyAgICAgICAgICAgICAg
ICAgfCAgIDEgLQo+ICBody92ZmlvL3BjaS5oICAgICAgICAgICAgICAgICB8ICAyNSArLQo+ICBp
bmNsdWRlL2h3L3ZmaW8vdmZpby1jb21tb24uaCB8ICAgMSArCj4gIDUgZmlsZXMgY2hhbmdlZCwg
NjU5IGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBo
dy92ZmlvL21pZ3JhdGlvbi5jCj4gCj4gZGlmZiAtLWdpdCBhL2h3L3ZmaW8vTWFrZWZpbGUub2Jq
cyBiL2h3L3ZmaW8vTWFrZWZpbGUub2Jqcwo+IGluZGV4IDhiM2Y2NjQuLmYzMmZmMTkgMTAwNjQ0
Cj4gLS0tIGEvaHcvdmZpby9NYWtlZmlsZS5vYmpzCj4gKysrIGIvaHcvdmZpby9NYWtlZmlsZS5v
YmpzCj4gQEAgLTEsNiArMSw2IEBACj4gIGlmZXEgKCQoQ09ORklHX0xJTlVYKSwgeSkKPiAgb2Jq
LSQoQ09ORklHX1NPRlRNTVUpICs9IGNvbW1vbi5vCj4gLW9iai0kKENPTkZJR19QQ0kpICs9IHBj
aS5vIHBjaS1xdWlya3MubyBkaXNwbGF5Lm8KPiArb2JqLSQoQ09ORklHX1BDSSkgKz0gcGNpLm8g
cGNpLXF1aXJrcy5vIGRpc3BsYXkubyBtaWdyYXRpb24ubwoKSSB0aGluayB5b3Ugd2FudCB0byBz
cGxpdCB0aGUgbWlncmF0aW9uIGNvZGU6IFRoZSB0eXBlLWluZGVwZW5kZW50CmNvZGUsIGFuZCB0
aGUgcGNpLXNwZWNpZmljIGNvZGUuCgo+ICBvYmotJChDT05GSUdfVkZJT19DQ1cpICs9IGNjdy5v
Cj4gIG9iai0kKENPTkZJR19TT0ZUTU1VKSArPSBwbGF0Zm9ybS5vCj4gIG9iai0kKENPTkZJR19W
RklPX1hHTUFDKSArPSBjYWx4ZWRhLXhnbWFjLm8KPiBkaWZmIC0tZ2l0IGEvaHcvdmZpby9taWdy
YXRpb24uYyBiL2h3L3ZmaW8vbWlncmF0aW9uLmMKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGlu
ZGV4IDAwMDAwMDAuLjE2ZDYzOTUKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIvaHcvdmZpby9taWdy
YXRpb24uYwo+IEBAIC0wLDAgKzEsNjMzIEBACj4gKyNpbmNsdWRlICJxZW11L29zZGVwLmgiCj4g
Kwo+ICsjaW5jbHVkZSAiaHcvdmZpby92ZmlvLWNvbW1vbi5oIgo+ICsjaW5jbHVkZSAibWlncmF0
aW9uL2Jsb2NrZXIuaCIKPiArI2luY2x1ZGUgIm1pZ3JhdGlvbi9yZWdpc3Rlci5oIgo+ICsjaW5j
bHVkZSAicWFwaS9lcnJvci5oIgo+ICsjaW5jbHVkZSAicGNpLmgiCj4gKyNpbmNsdWRlICJzeXNl
bXUva3ZtLmgiCj4gKyNpbmNsdWRlICJleGVjL3JhbV9hZGRyLmgiCj4gKwo+ICsjZGVmaW5lIFZG
SU9fU0FWRV9GTEFHX1NFVFVQIDAKPiArI2RlZmluZSBWRklPX1NBVkVfRkxBR19QQ0kgMQo+ICsj
ZGVmaW5lIFZGSU9fU0FWRV9GTEFHX0RFVkNPTkZJRyAyCj4gKyNkZWZpbmUgVkZJT19TQVZFX0ZM
QUdfREVWTUVNT1JZIDQKPiArI2RlZmluZSBWRklPX1NBVkVfRkxBR19DT05USU5VRSA4Cj4gKwo+
ICtzdGF0aWMgaW50IHZmaW9fZGV2aWNlX3N0YXRlX3JlZ2lvbl9zZXR1cChWRklPUENJRGV2aWNl
ICp2ZGV2LAo+ICsgICAgICAgIFZGSU9SZWdpb24gKnJlZ2lvbiwgdWludDMyX3Qgc3VidHlwZSwg
Y29uc3QgY2hhciAqbmFtZSkKClRoaXMgZnVuY3Rpb24gbG9va3MgbGlrZSBpdCBzaG91bGQgYmUg
bW9yZSBnZW5lcmljIGFuZCBlLmcuIHRha2UgYQpWRklPRGV2aWNlIGluc3RlYWQgb2YgYSBWRklP
UENJRGV2aWNlIGFzIGFyZ3VtZW50LgoKPiArewo+ICsgICAgVkZJT0RldmljZSAqdmJhc2VkZXYg
PSAmdmRldi0+dmJhc2VkZXY7Cj4gKyAgICBzdHJ1Y3QgdmZpb19yZWdpb25faW5mbyAqaW5mbzsK
PiArICAgIGludCByZXQ7Cj4gKwo+ICsgICAgcmV0ID0gdmZpb19nZXRfZGV2X3JlZ2lvbl9pbmZv
KHZiYXNlZGV2LCBWRklPX1JFR0lPTl9UWVBFX0RFVklDRV9TVEFURSwKPiArICAgICAgICAgICAg
c3VidHlwZSwgJmluZm8pOwo+ICsgICAgaWYgKHJldCkgewo+ICsgICAgICAgIGVycm9yX3JlcG9y
dCgiRmFpbGVkIHRvIGdldCBpbmZvIG9mIHJlZ2lvbiAlcyIsIG5hbWUpOwo+ICsgICAgICAgIHJl
dHVybiByZXQ7Cj4gKyAgICB9Cj4gKwo+ICsgICAgaWYgKHZmaW9fcmVnaW9uX3NldHVwKE9CSkVD
VCh2ZGV2KSwgdmJhc2VkZXYsCj4gKyAgICAgICAgICAgIHJlZ2lvbiwgaW5mby0+aW5kZXgsIG5h
bWUpKSB7Cj4gKyAgICAgICAgZXJyb3JfcmVwb3J0KCJGYWlsZWQgdG8gc2V0dXAgbWlncnRpb24g
cmVnaW9uICVzIiwgbmFtZSk7Cj4gKyAgICAgICAgcmV0dXJuIHJldDsKPiArICAgIH0KPiArCj4g
KyAgICBpZiAodmZpb19yZWdpb25fbW1hcChyZWdpb24pKSB7Cj4gKyAgICAgICAgZXJyb3JfcmVw
b3J0KCJGYWlsZWQgdG8gbW1hcCBtaWdydGlvbiByZWdpb24gJXMiLCBuYW1lKTsKPiArICAgIH0K
PiArCj4gKyAgICByZXR1cm4gMDsKPiArfQo+ICsKPiArYm9vbCB2ZmlvX2RldmljZV9kYXRhX2Nh
cF9zeXN0ZW1fbWVtb3J5KFZGSU9QQ0lEZXZpY2UgKnZkZXYpCj4gK3sKPiArICAgcmV0dXJuICEh
KHZkZXYtPm1pZ3JhdGlvbi0+ZGF0YV9jYXBzICYgVkZJT19ERVZJQ0VfREFUQV9DQVBfU1lTVEVN
X01FTU9SWSk7Cj4gK30KPiArCj4gK2Jvb2wgdmZpb19kZXZpY2VfZGF0YV9jYXBfZGV2aWNlX21l
bW9yeShWRklPUENJRGV2aWNlICp2ZGV2KQo+ICt7Cj4gKyAgIHJldHVybiAhISh2ZGV2LT5taWdy
YXRpb24tPmRhdGFfY2FwcyAmIFZGSU9fREVWSUNFX0RBVEFfQ0FQX0RFVklDRV9NRU1PUlkpOwo+
ICt9CgpUaGVzZSB0d28gYXMgd2VsbC4gVGhlIG1pZ3JhdGlvbiBzdHJ1Y3R1cmUgc2hvdWxkIHBy
b2JhYmx5IGhhbmcgb2ZmIHRoZQpWRklPRGV2aWNlIGluc3RlYWQuCgo+ICsKPiArc3RhdGljIGJv
b2wgdmZpb19kZXZpY2Vfc3RhdGVfcmVnaW9uX21tYXBlZChWRklPUmVnaW9uICpyZWdpb24pCj4g
K3sKPiArICAgIGJvb2wgbW1hcGVkID0gdHJ1ZTsKPiArICAgIGlmIChyZWdpb24tPm5yX21tYXBz
ICE9IDEgfHwgcmVnaW9uLT5tbWFwc1swXS5vZmZzZXQgfHwKPiArICAgICAgICAgICAgKHJlZ2lv
bi0+c2l6ZSAhPSByZWdpb24tPm1tYXBzWzBdLnNpemUpIHx8Cj4gKyAgICAgICAgICAgIChyZWdp
b24tPm1tYXBzWzBdLm1tYXAgPT0gTlVMTCkpIHsKPiArICAgICAgICBtbWFwZWQgPSBmYWxzZTsK
PiArICAgIH0KPiArCj4gKyAgICByZXR1cm4gbW1hcGVkOwo+ICt9CgpzL21tYXBlZC9tbWFwcGVk
LyA/Cgo+ICsKPiArc3RhdGljIGludCB2ZmlvX2dldF9kZXZpY2VfY29uZmlnX3NpemUoVkZJT1BD
SURldmljZSAqdmRldikKPiArewo+ICsgICAgVkZJT0RldmljZSAqdmJhc2VkZXYgPSAmdmRldi0+
dmJhc2VkZXY7Cj4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fY3RsID0KPiArICAgICAgICAmdmRl
di0+bWlncmF0aW9uLT5yZWdpb25bVkZJT19ERVZTVEFURV9SRUdJT05fQ1RMXTsKPiArICAgIFZG
SU9SZWdpb24gKnJlZ2lvbl9jb25maWcgPQo+ICsgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJl
Z2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9EQVRBX0NPTkZJR107CgpUaGlzIGxvb2tzIGxpa2Ug
aXQgc2hvdWxkIG5vdCBkZXBlbmQgb24gcGNpLCBlaXRoZXIuCgo+ICsgICAgdWludDY0X3QgbGVu
Owo+ICsgICAgaW50IHN6Owo+ICsKPiArICAgIHN6ID0gc2l6ZW9mKGxlbik7Cj4gKyAgICBpZiAo
cHJlYWQodmJhc2VkZXYtPmZkLCAmbGVuLCBzeiwKPiArICAgICAgICAgICAgICAgIHJlZ2lvbl9j
dGwtPmZkX29mZnNldCArCj4gKyAgICAgICAgICAgICAgICBvZmZzZXRvZihzdHJ1Y3QgdmZpb19k
ZXZpY2Vfc3RhdGVfY3RsLCBkZXZpY2VfY29uZmlnLnNpemUpKQo+ICsgICAgICAgICAgICAhPSBz
eikgewo+ICsgICAgICAgIGVycm9yX3JlcG9ydCgidmZpbzogRmFpbGVkIHRvIGdldCBsZW5ndGgg
b2YgZGV2aWNlIGNvbmZpZyIpOwo+ICsgICAgICAgIHJldHVybiAtMTsKPiArICAgIH0KPiArICAg
IGlmIChsZW4gPiByZWdpb25fY29uZmlnLT5zaXplKSB7Cj4gKyAgICAgICAgZXJyb3JfcmVwb3J0
KCJ2ZmlvOiBFcnJvciBkZXZpY2UgY29uZmlnIGxlbmd0aCIpOwo+ICsgICAgICAgIHJldHVybiAt
MTsKPiArICAgIH0KPiArICAgIHZkZXYtPm1pZ3JhdGlvbi0+ZGV2Y29uZmlnX3NpemUgPSBsZW47
Cj4gKwo+ICsgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmZpb19zZXRfZGV2
aWNlX2NvbmZpZ19zaXplKFZGSU9QQ0lEZXZpY2UgKnZkZXYsIHVpbnQ2NF90IHNpemUpCj4gK3sK
PiArICAgIFZGSU9EZXZpY2UgKnZiYXNlZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+ICsgICAgVkZJ
T1JlZ2lvbiAqcmVnaW9uX2N0bCA9Cj4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9u
W1ZGSU9fREVWU1RBVEVfUkVHSU9OX0NUTF07Cj4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fY29u
ZmlnID0KPiArICAgICAgICAmdmRldi0+bWlncmF0aW9uLT5yZWdpb25bVkZJT19ERVZTVEFURV9S
RUdJT05fREFUQV9DT05GSUddOwoKRGl0dG8uIEFsc28gZm9yIHRoZSBmdW5jdGlvbnMgYmVsb3cu
Cgo+ICsgICAgaW50IHN6Owo+ICsKPiArICAgIGlmIChzaXplID4gcmVnaW9uX2NvbmZpZy0+c2l6
ZSkgewo+ICsgICAgICAgIHJldHVybiAtMTsKPiArICAgIH0KPiArCj4gKyAgICBzeiA9IHNpemVv
ZihzaXplKTsKPiArICAgIGlmIChwd3JpdGUodmJhc2VkZXYtPmZkLCAmc2l6ZSwgc3osCj4gKyAg
ICAgICAgICAgICAgICByZWdpb25fY3RsLT5mZF9vZmZzZXQgKwo+ICsgICAgICAgICAgICAgICAg
b2Zmc2V0b2Yoc3RydWN0IHZmaW9fZGV2aWNlX3N0YXRlX2N0bCwgZGV2aWNlX2NvbmZpZy5zaXpl
KSkKPiArICAgICAgICAgICAgIT0gc3opIHsKPiArICAgICAgICBlcnJvcl9yZXBvcnQoInZmaW86
IEZhaWxlZCB0byBzZXQgbGVuZ3RoIG9mIGRldmljZSBjb25maWciKTsKPiArICAgICAgICByZXR1
cm4gLTE7Cj4gKyAgICB9Cj4gKyAgICB2ZGV2LT5taWdyYXRpb24tPmRldmNvbmZpZ19zaXplID0g
c2l6ZTsKPiArICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZmaW9fc2F2ZV9k
YXRhX2RldmljZV9jb25maWcoVkZJT1BDSURldmljZSAqdmRldiwgUUVNVUZpbGUgKmYpCj4gK3sK
PiArICAgIFZGSU9EZXZpY2UgKnZiYXNlZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+ICsgICAgVkZJ
T1JlZ2lvbiAqcmVnaW9uX2N0bCA9Cj4gKyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9u
W1ZGSU9fREVWU1RBVEVfUkVHSU9OX0NUTF07Cj4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fY29u
ZmlnID0KPiArICAgICAgICAmdmRldi0+bWlncmF0aW9uLT5yZWdpb25bVkZJT19ERVZTVEFURV9S
RUdJT05fREFUQV9DT05GSUddOwo+ICsgICAgdm9pZCAqZGVzdDsKPiArICAgIHVpbnQzMl90IHN6
Owo+ICsgICAgdWludDhfdCAqYnVmID0gTlVMTDsKPiArICAgIHVpbnQzMl90IGFjdGlvbiA9IFZG
SU9fREVWSUNFX0RBVEFfQUNUSU9OX0dFVF9CVUZGRVI7Cj4gKyAgICB1aW50NjRfdCBsZW4gPSB2
ZGV2LT5taWdyYXRpb24tPmRldmNvbmZpZ19zaXplOwo+ICsKPiArICAgIHFlbXVfcHV0X2JlNjQo
ZiwgbGVuKTsKCldoeSBiaWcgZW5kaWFuPyAoR2VuZXJhbGx5LCBkbyB3ZSBuZWVkIGFueSBlbmRp
YW5uZXNzIGNvbnNpZGVyYXRpb25zPykKCj4gKwo+ICsgICAgc3ogPSBzaXplb2YoYWN0aW9uKTsK
PiArICAgIGlmIChwd3JpdGUodmJhc2VkZXYtPmZkLCAmYWN0aW9uLCBzeiwKPiArICAgICAgICAg
ICAgICAgIHJlZ2lvbl9jdGwtPmZkX29mZnNldCArCj4gKyAgICAgICAgICAgICAgICBvZmZzZXRv
ZihzdHJ1Y3QgdmZpb19kZXZpY2Vfc3RhdGVfY3RsLCBkZXZpY2VfY29uZmlnLmFjdGlvbikpCj4g
KyAgICAgICAgICAgICE9IHN6KSB7Cj4gKyAgICAgICAgZXJyb3JfcmVwb3J0KCJ2ZmlvOiBhY3Rp
b24gZmFpbHVyZSBmb3IgZGV2aWNlIGNvbmZpZyBnZXQgYnVmZmVyIik7Cj4gKyAgICAgICAgcmV0
dXJuIC0xOwo+ICsgICAgfQoKTWlnaHQgbWFrZSBzZW5zZSB0byB3cmFwIHRoaXMgaW50byBhIHNl
dF9hY3Rpb24oKSBoZWxwZXIgdGhhdCB0YWtlcyBhClNFVF9CVUZGRVIvR0VUX0JVRkZFUiBhcmd1
bWVudC4KCj4gKwo+ICsgICAgaWYgKCF2ZmlvX2RldmljZV9zdGF0ZV9yZWdpb25fbW1hcGVkKHJl
Z2lvbl9jb25maWcpKSB7Cj4gKyAgICAgICAgYnVmID0gZ19tYWxsb2MobGVuKTsKPiArICAgICAg
ICBpZiAoYnVmID09IE5VTEwpIHsKPiArICAgICAgICAgICAgZXJyb3JfcmVwb3J0KCJ2ZmlvOiBG
YWlsZWQgdG8gYWxsb2NhdGUgbWVtb3J5IGZvciBtaWdyYXRlIik7Cj4gKyAgICAgICAgICAgIHJl
dHVybiAtMTsKPiArICAgICAgICB9Cj4gKyAgICAgICAgaWYgKHByZWFkKHZiYXNlZGV2LT5mZCwg
YnVmLCBsZW4sIHJlZ2lvbl9jb25maWctPmZkX29mZnNldCkgIT0gbGVuKSB7Cj4gKyAgICAgICAg
ICAgIGVycm9yX3JlcG9ydCgidmZpbzogRmFpbGVkIHJlYWQgZGV2aWNlIGNvbmZpZyBidWZmZXIi
KTsKPiArICAgICAgICAgICAgcmV0dXJuIC0xOwo+ICsgICAgICAgIH0KPiArICAgICAgICBxZW11
X3B1dF9idWZmZXIoZiwgYnVmLCBsZW4pOwo+ICsgICAgICAgIGdfZnJlZShidWYpOwo+ICsgICAg
fSBlbHNlIHsKPiArICAgICAgICBkZXN0ID0gcmVnaW9uX2NvbmZpZy0+bW1hcHNbMF0ubW1hcDsK
PiArICAgICAgICBxZW11X3B1dF9idWZmZXIoZiwgZGVzdCwgbGVuKTsKPiArICAgIH0KPiArICAg
IHJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZmaW9fbG9hZF9kYXRhX2RldmljZV9j
b25maWcoVkZJT1BDSURldmljZSAqdmRldiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFFFTVVGaWxlICpmLCB1aW50NjRfdCBsZW4pCj4gK3sKPiArICAgIFZGSU9EZXZpY2UgKnZiYXNl
ZGV2ID0gJnZkZXYtPnZiYXNlZGV2Owo+ICsgICAgVkZJT1JlZ2lvbiAqcmVnaW9uX2N0bCA9Cj4g
KyAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9OX0NU
TF07Cj4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fY29uZmlnID0KPiArICAgICAgICAmdmRldi0+
bWlncmF0aW9uLT5yZWdpb25bVkZJT19ERVZTVEFURV9SRUdJT05fREFUQV9DT05GSUddOwo+ICsg
ICAgdm9pZCAqZGVzdDsKPiArICAgIHVpbnQzMl90IHN6Owo+ICsgICAgdWludDhfdCAqYnVmID0g
TlVMTDsKPiArICAgIHVpbnQzMl90IGFjdGlvbiA9IFZGSU9fREVWSUNFX0RBVEFfQUNUSU9OX1NF
VF9CVUZGRVI7Cj4gKwo+ICsgICAgdmZpb19zZXRfZGV2aWNlX2NvbmZpZ19zaXplKHZkZXYsIGxl
bik7Cj4gKwo+ICsgICAgaWYgKCF2ZmlvX2RldmljZV9zdGF0ZV9yZWdpb25fbW1hcGVkKHJlZ2lv
bl9jb25maWcpKSB7Cj4gKyAgICAgICAgYnVmID0gZ19tYWxsb2MobGVuKTsKPiArICAgICAgICBp
ZiAoYnVmID09IE5VTEwpIHsKPiArICAgICAgICAgICAgZXJyb3JfcmVwb3J0KCJ2ZmlvOiBGYWls
ZWQgdG8gYWxsb2NhdGUgbWVtb3J5IGZvciBtaWdyYXRlIik7Cj4gKyAgICAgICAgICAgIHJldHVy
biAtMTsKPiArICAgICAgICB9Cj4gKyAgICAgICAgcWVtdV9nZXRfYnVmZmVyKGYsIGJ1ZiwgbGVu
KTsKPiArICAgICAgICBpZiAocHdyaXRlKHZiYXNlZGV2LT5mZCwgYnVmLCBsZW4sCj4gKyAgICAg
ICAgICAgICAgICAgICAgcmVnaW9uX2NvbmZpZy0+ZmRfb2Zmc2V0KSAhPSBsZW4pIHsKPiArICAg
ICAgICAgICAgZXJyb3JfcmVwb3J0KCJ2ZmlvOiBGYWlsZWQgdG8gd3JpdGUgZGV2aWUgY29uZmln
IGJ1ZmZlciIpOwo+ICsgICAgICAgICAgICByZXR1cm4gLTE7Cj4gKyAgICAgICAgfQo+ICsgICAg
ICAgIGdfZnJlZShidWYpOwo+ICsgICAgfSBlbHNlIHsKPiArICAgICAgICBkZXN0ID0gcmVnaW9u
X2NvbmZpZy0+bW1hcHNbMF0ubW1hcDsKPiArICAgICAgICBxZW11X2dldF9idWZmZXIoZiwgZGVz
dCwgbGVuKTsKPiArICAgIH0KPiArCj4gKyAgICBzeiA9IHNpemVvZihhY3Rpb24pOwo+ICsgICAg
aWYgKHB3cml0ZSh2YmFzZWRldi0+ZmQsICZhY3Rpb24sIHN6LAo+ICsgICAgICAgICAgICAgICAg
cmVnaW9uX2N0bC0+ZmRfb2Zmc2V0ICsKPiArICAgICAgICAgICAgICAgIG9mZnNldG9mKHN0cnVj
dCB2ZmlvX2RldmljZV9zdGF0ZV9jdGwsIGRldmljZV9jb25maWcuYWN0aW9uKSkKPiArICAgICAg
ICAgICAgIT0gc3opIHsKPiArICAgICAgICBlcnJvcl9yZXBvcnQoInZmaW86IGFjdGlvbiBmYWls
dXJlIGZvciBkZXZpY2UgY29uZmlnIHNldCBidWZmZXIiKTsKPiArICAgICAgICByZXR1cm4gLTE7
Cj4gKyAgICB9Cj4gKwo+ICsgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmZp
b19zZXRfZGlydHlfcGFnZV9iaXRtYXBfY2h1bmsoVkZJT1BDSURldmljZSAqdmRldiwKPiArICAg
ICAgICB1aW50NjRfdCBzdGFydF9hZGRyLCB1aW50NjRfdCBwYWdlX25yKQo+ICt7Cj4gKwo+ICsg
ICAgVkZJT0RldmljZSAqdmJhc2VkZXYgPSAmdmRldi0+dmJhc2VkZXY7Cj4gKyAgICBWRklPUmVn
aW9uICpyZWdpb25fY3RsID0KPiArICAgICAgICAmdmRldi0+bWlncmF0aW9uLT5yZWdpb25bVkZJ
T19ERVZTVEFURV9SRUdJT05fQ1RMXTsKPiArICAgIFZGSU9SZWdpb24gKnJlZ2lvbl9iaXRtYXAg
PQo+ICsgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lP
Tl9EQVRBX0JJVE1BUF07Cj4gKyAgICB1bnNpZ25lZCBsb25nIGJpdG1hcF9zaXplID0KPiArICAg
ICAgICAgICAgICAgICAgICBCSVRTX1RPX0xPTkdTKHBhZ2VfbnIpICogc2l6ZW9mKHVuc2lnbmVk
IGxvbmcpOwo+ICsgICAgdWludDMyX3Qgc3o7Cj4gKwo+ICsgICAgc3RydWN0IHsKPiArICAgICAg
ICBfX3U2NCBzdGFydF9hZGRyOwo+ICsgICAgICAgIF9fdTY0IHBhZ2VfbnI7Cj4gKyAgICB9IHN5
c3RlbV9tZW1vcnk7Cj4gKyAgICBzeXN0ZW1fbWVtb3J5LnN0YXJ0X2FkZHIgPSBzdGFydF9hZGRy
Owo+ICsgICAgc3lzdGVtX21lbW9yeS5wYWdlX25yID0gcGFnZV9ucjsKPiArICAgIHN6ID0gc2l6
ZW9mKHN5c3RlbV9tZW1vcnkpOwo+ICsgICAgaWYgKHB3cml0ZSh2YmFzZWRldi0+ZmQsICZzeXN0
ZW1fbWVtb3J5LCBzeiwKPiArICAgICAgICAgICAgICAgIHJlZ2lvbl9jdGwtPmZkX29mZnNldCAr
Cj4gKyAgICAgICAgICAgICAgICBvZmZzZXRvZihzdHJ1Y3QgdmZpb19kZXZpY2Vfc3RhdGVfY3Rs
LCBzeXN0ZW1fbWVtb3J5KSkKPiArICAgICAgICAgICAgIT0gc3opIHsKPiArICAgICAgICBlcnJv
cl9yZXBvcnQoInZmaW86IEZhaWxlZCB0byBzZXQgc3lzdGVtIG1lbW9yeSByYW5nZSBmb3IgZGly
dHkgcGFnZXMiKTsKPiArICAgICAgICByZXR1cm4gLTE7Cj4gKyAgICB9Cj4gKwo+ICsgICAgaWYg
KCF2ZmlvX2RldmljZV9zdGF0ZV9yZWdpb25fbW1hcGVkKHJlZ2lvbl9iaXRtYXApKSB7Cj4gKyAg
ICAgICAgdm9pZCAqYml0bWFwID0gZ19tYWxsb2MwKGJpdG1hcF9zaXplKTsKPiArCj4gKyAgICAg
ICAgaWYgKHByZWFkKHZiYXNlZGV2LT5mZCwgYml0bWFwLCBiaXRtYXBfc2l6ZSwKPiArICAgICAg
ICAgICAgICAgICAgICByZWdpb25fYml0bWFwLT5mZF9vZmZzZXQpICE9IGJpdG1hcF9zaXplKSB7
Cj4gKyAgICAgICAgICAgIGVycm9yX3JlcG9ydCgidmZpbzogRmFpbGVkIHRvIHJlYWQgZGlydHkg
Yml0bWFwIGRhdGEiKTsKPiArICAgICAgICAgICAgcmV0dXJuIC0xOwo+ICsgICAgICAgIH0KPiAr
Cj4gKyAgICAgICAgY3B1X3BoeXNpY2FsX21lbW9yeV9zZXRfZGlydHlfbGViaXRtYXAoYml0bWFw
LCBzdGFydF9hZGRyLCBwYWdlX25yKTsKPiArCj4gKyAgICAgICAgZ19mcmVlKGJpdG1hcCk7Cj4g
KyAgICB9IGVsc2Ugewo+ICsgICAgICAgIGNwdV9waHlzaWNhbF9tZW1vcnlfc2V0X2RpcnR5X2xl
Yml0bWFwKAo+ICsgICAgICAgICAgICAgICAgICAgIHJlZ2lvbl9iaXRtYXAtPm1tYXBzWzBdLm1t
YXAsCj4gKyAgICAgICAgICAgICAgICAgICAgc3RhcnRfYWRkciwgcGFnZV9ucik7Cj4gKyAgICB9
Cj4gKyAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtpbnQgdmZpb19zZXRfZGlydHlfcGFnZV9iaXRt
YXAoVkZJT1BDSURldmljZSAqdmRldiwKPiArICAgICAgICB1aW50NjRfdCBzdGFydF9hZGRyLCB1
aW50NjRfdCBwYWdlX25yKQo+ICt7Cj4gKyAgICBWRklPUmVnaW9uICpyZWdpb25fYml0bWFwID0K
PiArICAgICAgICAmdmRldi0+bWlncmF0aW9uLT5yZWdpb25bVkZJT19ERVZTVEFURV9SRUdJT05f
REFUQV9CSVRNQVBdOwo+ICsgICAgdW5zaWduZWQgbG9uZyBjaHVua19zaXplID0gcmVnaW9uX2Jp
dG1hcC0+c2l6ZTsKPiArICAgIHVpbnQ2NF90IGNodW5rX3BnX25yID0gKGNodW5rX3NpemUgLyBz
aXplb2YodW5zaWduZWQgbG9uZykpICoKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBCSVRTX1BFUl9MT05HOwo+ICsKPiArICAgIHVpbnQ2NF90IGNudF9sZWZ0Owo+ICsgICAgaW50
IHJjID0gMDsKPiArCj4gKyAgICBjbnRfbGVmdCA9IHBhZ2VfbnI7Cj4gKwo+ICsgICAgd2hpbGUg
KGNudF9sZWZ0ID49IGNodW5rX3BnX25yKSB7Cj4gKyAgICAgICAgcmMgPSB2ZmlvX3NldF9kaXJ0
eV9wYWdlX2JpdG1hcF9jaHVuayh2ZGV2LCBzdGFydF9hZGRyLCBjaHVua19wZ19ucik7Cj4gKyAg
ICAgICAgaWYgKHJjKSB7Cj4gKyAgICAgICAgICAgIGdvdG8gZXhpdDsKPiArICAgICAgICB9Cj4g
KyAgICAgICAgY250X2xlZnQgLT0gY2h1bmtfcGdfbnI7Cj4gKyAgICAgICAgc3RhcnRfYWRkciAr
PSBzdGFydF9hZGRyOwo+ICsgICB9Cj4gKyAgIHJjID0gdmZpb19zZXRfZGlydHlfcGFnZV9iaXRt
YXBfY2h1bmsodmRldiwgc3RhcnRfYWRkciwgY250X2xlZnQpOwo+ICsKPiArZXhpdDoKPiArICAg
cmV0dXJuIHJjOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZmaW9fc2V0X2RldmljZV9zdGF0ZShW
RklPUENJRGV2aWNlICp2ZGV2LAo+ICsgICAgICAgIHVpbnQzMl90IGRldl9zdGF0ZSkKPiArewo+
ICsgICAgVkZJT0RldmljZSAqdmJhc2VkZXYgPSAmdmRldi0+dmJhc2VkZXY7Cj4gKyAgICBWRklP
UmVnaW9uICpyZWdpb24gPQo+ICsgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJlZ2lvbltWRklP
X0RFVlNUQVRFX1JFR0lPTl9DVExdOwo+ICsgICAgdWludDMyX3Qgc3ogPSBzaXplb2YoZGV2X3N0
YXRlKTsKPiArCj4gKyAgICBpZiAoIXZkZXYtPm1pZ3JhdGlvbikgewo+ICsgICAgICAgIHJldHVy
biAtMTsKPiArICAgIH0KPiArCj4gKyAgICBpZiAocHdyaXRlKHZiYXNlZGV2LT5mZCwgJmRldl9z
dGF0ZSwgc3osCj4gKyAgICAgICAgICAgICAgcmVnaW9uLT5mZF9vZmZzZXQgKwo+ICsgICAgICAg
ICAgICAgIG9mZnNldG9mKHN0cnVjdCB2ZmlvX2RldmljZV9zdGF0ZV9jdGwsIGRldmljZV9zdGF0
ZSkpCj4gKyAgICAgICAgICAgICE9IHN6KSB7Cj4gKyAgICAgICAgZXJyb3JfcmVwb3J0KCJ2Zmlv
OiBGYWlsZWQgdG8gc2V0IGRldmljZSBzdGF0ZSAlZCIsIGRldl9zdGF0ZSk7CgpDYW4gdGhlIGtl
cm5lbCByZWplY3QgdGhpcyBpZiBhIHN0YXRlIHRyYW5zaXRpb24gaXMgbm90IGFsbG93ZWQgKG9y
IGFyZQphbGwgdHJhbnNpdGlvbnMgYWxsb3dlZD8pCgo+ICsgICAgICAgIHJldHVybiAtMTsKPiAr
ICAgIH0KPiArICAgIHZkZXYtPm1pZ3JhdGlvbi0+ZGV2aWNlX3N0YXRlID0gZGV2X3N0YXRlOwo+
ICsgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmZpb19nZXRfZGV2aWNlX2Rh
dGFfY2FwcyhWRklPUENJRGV2aWNlICp2ZGV2KQo+ICt7Cj4gKyAgICBWRklPRGV2aWNlICp2YmFz
ZWRldiA9ICZ2ZGV2LT52YmFzZWRldjsKPiArICAgIFZGSU9SZWdpb24gKnJlZ2lvbiA9Cj4gKyAg
ICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9OX0NUTF07
Cj4gKwo+ICsgICAgdWludDMyX3QgY2FwczsKPiArICAgIHVpbnQzMl90IHNpemUgPSBzaXplb2Yo
Y2Fwcyk7Cj4gKwo+ICsgICAgaWYgKHByZWFkKHZiYXNlZGV2LT5mZCwgJmNhcHMsIHNpemUsCj4g
KyAgICAgICAgICAgICAgICByZWdpb24tPmZkX29mZnNldCArCj4gKyAgICAgICAgICAgICAgICBv
ZmZzZXRvZihzdHJ1Y3QgdmZpb19kZXZpY2Vfc3RhdGVfY3RsLCBjYXBzKSkKPiArICAgICAgICAg
ICAgIT0gc2l6ZSkgewo+ICsgICAgICAgIGVycm9yX3JlcG9ydCgiJXMgRmFpbGVkIHRvIHJlYWQg
ZGF0YSBjYXBzIG9mIGRldmljZSBzdGF0ZXMiLAo+ICsgICAgICAgICAgICAgICAgdmJhc2VkZXYt
Pm5hbWUpOwo+ICsgICAgICAgIHJldHVybiAtMTsKPiArICAgIH0KPiArICAgIHZkZXYtPm1pZ3Jh
dGlvbi0+ZGF0YV9jYXBzID0gY2FwczsKPiArICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICsKPiAr
c3RhdGljIGludCB2ZmlvX2NoZWNrX2RldnN0YXRlX3ZlcnNpb24oVkZJT1BDSURldmljZSAqdmRl
dikKPiArewo+ICsgICAgVkZJT0RldmljZSAqdmJhc2VkZXYgPSAmdmRldi0+dmJhc2VkZXY7Cj4g
KyAgICBWRklPUmVnaW9uICpyZWdpb24gPQo+ICsgICAgICAgICZ2ZGV2LT5taWdyYXRpb24tPnJl
Z2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9DVExdOwo+ICsKPiArICAgIHVpbnQzMl90IHZlcnNp
b247Cj4gKyAgICB1aW50MzJfdCBzaXplID0gc2l6ZW9mKHZlcnNpb24pOwo+ICsKPiArICAgIGlm
IChwcmVhZCh2YmFzZWRldi0+ZmQsICZ2ZXJzaW9uLCBzaXplLAo+ICsgICAgICAgICAgICAgICAg
cmVnaW9uLT5mZF9vZmZzZXQgKwo+ICsgICAgICAgICAgICAgICAgb2Zmc2V0b2Yoc3RydWN0IHZm
aW9fZGV2aWNlX3N0YXRlX2N0bCwgdmVyc2lvbikpCj4gKyAgICAgICAgICAgICE9IHNpemUpIHsK
PiArICAgICAgICBlcnJvcl9yZXBvcnQoIiVzIEZhaWxlZCB0byByZWFkIHZlcnNpb24gb2YgZGV2
aWNlIHN0YXRlIGludGVyZmFjZXMiLAo+ICsgICAgICAgICAgICAgICAgdmJhc2VkZXYtPm5hbWUp
Owo+ICsgICAgICAgIHJldHVybiAtMTsKPiArICAgIH0KPiArCj4gKyAgICBpZiAodmVyc2lvbiAh
PSBWRklPX0RFVklDRV9TVEFURV9JTlRFUkZBQ0VfVkVSU0lPTikgewo+ICsgICAgICAgIGVycm9y
X3JlcG9ydCgiJXMgbWlncmF0aW9uIHZlcnNpb24gbWlzbWF0Y2gsIHJpZ2h0IHZlcnNpb24gaXMg
JWQiLAo+ICsgICAgICAgICAgICAgICAgdmJhc2VkZXYtPm5hbWUsIFZGSU9fREVWSUNFX1NUQVRF
X0lOVEVSRkFDRV9WRVJTSU9OKTsKClNvLCB3ZSByZXF1aXJlIGFuIGV4YWN0IG1hdGNoLi4uIG9y
IHNob3VsZCB3ZSBhbGxvdyB0byBleHRlbmQgdGhlCmludGVyZmFjZSBpbiBhbiBiYWNrd2FyZHMt
Y29tcGF0aWJsZSB3YXksIGluIHdoaWNoIGNhc2Ugd2UnZCByZXF1aXJlCihRRU1VIGludGVyZmFj
ZSB2ZXJzaW9uKSA8PSAoa2VybmVsIGludGVyZmFjZSB2ZXJzaW9uKT8KCj4gKyAgICAgICAgcmV0
dXJuIC0xOwo+ICsgICAgfQo+ICsKPiArICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
dm9pZCB2ZmlvX3ZtX2NoYW5nZV9zdGF0ZV9oYW5kbGVyKHZvaWQgKnB2LCBpbnQgcnVubmluZywg
UnVuU3RhdGUgc3RhdGUpCj4gK3sKPiArICAgIFZGSU9QQ0lEZXZpY2UgKnZkZXYgPSBwdjsKPiAr
ICAgIHVpbnQzMl90IGRldl9zdGF0ZSA9IHZkZXYtPm1pZ3JhdGlvbi0+ZGV2aWNlX3N0YXRlOwo+
ICsKPiArICAgIGlmICghcnVubmluZykgewo+ICsgICAgICAgIGRldl9zdGF0ZSB8PSBWRklPX0RF
VklDRV9TVEFURV9TVE9QOwo+ICsgICAgfSBlbHNlIHsKPiArICAgICAgICBkZXZfc3RhdGUgJj0g
flZGSU9fREVWSUNFX1NUQVRFX1NUT1A7Cj4gKyAgICB9Cj4gKwo+ICsgICAgdmZpb19zZXRfZGV2
aWNlX3N0YXRlKHZkZXYsIGRldl9zdGF0ZSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZmaW9f
c2F2ZV9saXZlX3BlbmRpbmcoUUVNVUZpbGUgKmYsIHZvaWQgKm9wYXF1ZSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCBtYXhfc2l6ZSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCAqcmVzX3ByZWNvcHlfb25seSwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCAqcmVzX2NvbXBhdGli
bGUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDY0X3QgKnJlc19w
b3N0X2NvcHlfb25seSkKPiArewo+ICsgICAgVkZJT1BDSURldmljZSAqdmRldiA9IG9wYXF1ZTsK
PiArCj4gKyAgICBpZiAoIXZmaW9fZGV2aWNlX2RhdGFfY2FwX2RldmljZV9tZW1vcnkodmRldikp
IHsKPiArICAgICAgICByZXR1cm47Cj4gKyAgICB9Cj4gKwo+ICsgICAgcmV0dXJuOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgaW50IHZmaW9fc2F2ZV9pdGVyYXRlKFFFTVVGaWxlICpmLCB2b2lkICpvcGFx
dWUpCj4gK3sKPiArICAgIFZGSU9QQ0lEZXZpY2UgKnZkZXYgPSBvcGFxdWU7Cj4gKwo+ICsgICAg
aWYgKCF2ZmlvX2RldmljZV9kYXRhX2NhcF9kZXZpY2VfbWVtb3J5KHZkZXYpKSB7Cj4gKyAgICAg
ICAgcmV0dXJuIDA7Cj4gKyAgICB9Cj4gKwo+ICsgICAgcmV0dXJuIDA7Cj4gK30KClRoZXNlIGxv
b2sgYSBiaXQgd2VpcmQuLi4KCj4gKwo+ICtzdGF0aWMgdm9pZCB2ZmlvX3BjaV9sb2FkX2NvbmZp
ZyhWRklPUENJRGV2aWNlICp2ZGV2LCBRRU1VRmlsZSAqZikKPiArewo+ICsgICAgUENJRGV2aWNl
ICpwZGV2ID0gJnZkZXYtPnBkZXY7Cj4gKyAgICB1aW50MzJfdCBjdGwsIG1zaV9sbywgbXNpX2hp
LCBtc2lfZGF0YSwgYmFyX2NmZywgaTsKPiArICAgIGJvb2wgbXNpXzY0Yml0Owo+ICsKPiArICAg
IC8qIHJldG9yZSBwY2kgYmFyIGNvbmZpZ3VyYXRpb24gKi8KPiArICAgIGN0bCA9IHBjaV9kZWZh
dWx0X3JlYWRfY29uZmlnKHBkZXYsIFBDSV9DT01NQU5ELCAyKTsKPiArICAgIHZmaW9fcGNpX3dy
aXRlX2NvbmZpZyhwZGV2LCBQQ0lfQ09NTUFORCwKPiArICAgICAgICAgICAgY3RsICYgKCEoUENJ
X0NPTU1BTkRfSU8gfCBQQ0lfQ09NTUFORF9NRU1PUlkpKSwgMik7Cj4gKyAgICBmb3IgKGkgPSAw
OyBpIDwgUENJX1JPTV9TTE9UOyBpKyspIHsKPiArICAgICAgICBiYXJfY2ZnID0gcWVtdV9nZXRf
YmUzMihmKTsKPiArICAgICAgICB2ZmlvX3BjaV93cml0ZV9jb25maWcocGRldiwgUENJX0JBU0Vf
QUREUkVTU18wICsgaSAqIDQsIGJhcl9jZmcsIDQpOwo+ICsgICAgfQo+ICsgICAgdmZpb19wY2lf
d3JpdGVfY29uZmlnKHBkZXYsIFBDSV9DT01NQU5ELAo+ICsgICAgICAgICAgICBjdGwgfCBQQ0lf
Q09NTUFORF9JTyB8IFBDSV9DT01NQU5EX01FTU9SWSwgMik7Cj4gKwo+ICsgICAgLyogcmVzdG9y
ZSBtc2kgY29uZmlndXJhdGlvbiAqLwo+ICsgICAgY3RsID0gcGNpX2RlZmF1bHRfcmVhZF9jb25m
aWcocGRldiwgcGRldi0+bXNpX2NhcCArIFBDSV9NU0lfRkxBR1MsIDIpOwo+ICsgICAgbXNpXzY0
Yml0ID0gISEoY3RsICYgUENJX01TSV9GTEFHU182NEJJVCk7Cj4gKwo+ICsgICAgdmZpb19wY2lf
d3JpdGVfY29uZmlnKCZ2ZGV2LT5wZGV2LAo+ICsgICAgICAgICAgICBwZGV2LT5tc2lfY2FwICsg
UENJX01TSV9GTEFHUywKPiArICAgICAgICAgICAgY3RsICYgKCFQQ0lfTVNJX0ZMQUdTX0VOQUJM
RSksIDIpOwo+ICsKPiArICAgIG1zaV9sbyA9IHFlbXVfZ2V0X2JlMzIoZik7Cj4gKyAgICB2Zmlv
X3BjaV93cml0ZV9jb25maWcocGRldiwgcGRldi0+bXNpX2NhcCArIFBDSV9NU0lfQUREUkVTU19M
TywgbXNpX2xvLCA0KTsKPiArCj4gKyAgICBpZiAobXNpXzY0Yml0KSB7Cj4gKyAgICAgICAgbXNp
X2hpID0gcWVtdV9nZXRfYmUzMihmKTsKPiArICAgICAgICB2ZmlvX3BjaV93cml0ZV9jb25maWco
cGRldiwgcGRldi0+bXNpX2NhcCArIFBDSV9NU0lfQUREUkVTU19ISSwKPiArICAgICAgICAgICAg
ICAgIG1zaV9oaSwgNCk7Cj4gKyAgICB9Cj4gKyAgICBtc2lfZGF0YSA9IHFlbXVfZ2V0X2JlMzIo
Zik7Cj4gKyAgICB2ZmlvX3BjaV93cml0ZV9jb25maWcocGRldiwKPiArICAgICAgICAgICAgcGRl
di0+bXNpX2NhcCArIChtc2lfNjRiaXQgPyBQQ0lfTVNJX0RBVEFfNjQgOiBQQ0lfTVNJX0RBVEFf
MzIpLAo+ICsgICAgICAgICAgICBtc2lfZGF0YSwgMik7Cj4gKwo+ICsgICAgdmZpb19wY2lfd3Jp
dGVfY29uZmlnKCZ2ZGV2LT5wZGV2LCBwZGV2LT5tc2lfY2FwICsgUENJX01TSV9GTEFHUywKPiAr
ICAgICAgICAgICAgY3RsIHwgUENJX01TSV9GTEFHU19FTkFCTEUsIDIpOwo+ICsKCk9rLCB0aGlz
IGZ1bmN0aW9uIGlzIGluZGVlZCBwY2ktc3BlY2lmaWMgYW5kIHByb2JhYmx5IHNob3VsZCBiZSBt
b3ZlZAp0byB0aGUgdmZpby1wY2kgY29kZSAob3RoZXIgdHlwZXMgY291bGQgaG9vayB0aGVtc2Vs
dmVzIHVwIGluIHRoZSBzYW1lCnBsYWNlLCB0aGVuKS4KCj4gK30KPiArCj4gK3N0YXRpYyBpbnQg
dmZpb19sb2FkX3N0YXRlKFFFTVVGaWxlICpmLCB2b2lkICpvcGFxdWUsIGludCB2ZXJzaW9uX2lk
KQo+ICt7Cj4gKyAgICBWRklPUENJRGV2aWNlICp2ZGV2ID0gb3BhcXVlOwo+ICsgICAgaW50IGZs
YWc7Cj4gKyAgICB1aW50NjRfdCBsZW47Cj4gKyAgICBpbnQgcmV0ID0gMDsKPiArCj4gKyAgICBp
ZiAodmVyc2lvbl9pZCAhPSBWRklPX0RFVklDRV9TVEFURV9JTlRFUkZBQ0VfVkVSU0lPTikgewo+
ICsgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsgICAgfQo+ICsKPiArICAgIGRvIHsKPiArICAg
ICAgICBmbGFnID0gcWVtdV9nZXRfYnl0ZShmKTsKPiArCj4gKyAgICAgICAgc3dpdGNoIChmbGFn
ICYgflZGSU9fU0FWRV9GTEFHX0NPTlRJTlVFKSB7Cj4gKyAgICAgICAgY2FzZSBWRklPX1NBVkVf
RkxBR19TRVRVUDoKPiArICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICAgY2FzZSBWRklPX1NB
VkVfRkxBR19QQ0k6Cj4gKyAgICAgICAgICAgIHZmaW9fcGNpX2xvYWRfY29uZmlnKHZkZXYsIGYp
Owo+ICsgICAgICAgICAgICBicmVhazsKPiArICAgICAgICBjYXNlIFZGSU9fU0FWRV9GTEFHX0RF
VkNPTkZJRzoKPiArICAgICAgICAgICAgbGVuID0gcWVtdV9nZXRfYmU2NChmKTsKPiArICAgICAg
ICAgICAgdmZpb19sb2FkX2RhdGFfZGV2aWNlX2NvbmZpZyh2ZGV2LCBmLCBsZW4pOwo+ICsgICAg
ICAgICAgICBicmVhazsKPiArICAgICAgICBkZWZhdWx0Ogo+ICsgICAgICAgICAgICByZXQgPSAt
RUlOVkFMOwo+ICsgICAgICAgIH0KPiArICAgIH0gd2hpbGUgKGZsYWcgJiBWRklPX1NBVkVfRkxB
R19DT05USU5VRSk7Cj4gKwo+ICsgICAgcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIHZv
aWQgdmZpb19wY2lfc2F2ZV9jb25maWcoVkZJT1BDSURldmljZSAqdmRldiwgUUVNVUZpbGUgKmYp
Cj4gK3sKPiArICAgIFBDSURldmljZSAqcGRldiA9ICZ2ZGV2LT5wZGV2Owo+ICsgICAgdWludDMy
X3QgbXNpX2NmZywgbXNpX2xvLCBtc2lfaGksIG1zaV9kYXRhLCBiYXJfY2ZnLCBpOwo+ICsgICAg
Ym9vbCBtc2lfNjRiaXQ7Cj4gKwo+ICsgICAgZm9yIChpID0gMDsgaSA8IFBDSV9ST01fU0xPVDsg
aSsrKSB7Cj4gKyAgICAgICAgYmFyX2NmZyA9IHBjaV9kZWZhdWx0X3JlYWRfY29uZmlnKHBkZXYs
IFBDSV9CQVNFX0FERFJFU1NfMCArIGkgKiA0LCA0KTsKPiArICAgICAgICBxZW11X3B1dF9iZTMy
KGYsIGJhcl9jZmcpOwo+ICsgICAgfQo+ICsKPiArICAgIG1zaV9jZmcgPSBwY2lfZGVmYXVsdF9y
ZWFkX2NvbmZpZyhwZGV2LCBwZGV2LT5tc2lfY2FwICsgUENJX01TSV9GTEFHUywgMik7Cj4gKyAg
ICBtc2lfNjRiaXQgPSAhIShtc2lfY2ZnICYgUENJX01TSV9GTEFHU182NEJJVCk7Cj4gKwo+ICsg
ICAgbXNpX2xvID0gcGNpX2RlZmF1bHRfcmVhZF9jb25maWcocGRldiwKPiArICAgICAgICAgICAg
cGRldi0+bXNpX2NhcCArIFBDSV9NU0lfQUREUkVTU19MTywgNCk7Cj4gKyAgICBxZW11X3B1dF9i
ZTMyKGYsIG1zaV9sbyk7Cj4gKwo+ICsgICAgaWYgKG1zaV82NGJpdCkgewo+ICsgICAgICAgIG1z
aV9oaSA9IHBjaV9kZWZhdWx0X3JlYWRfY29uZmlnKHBkZXYsCj4gKyAgICAgICAgICAgICAgICBw
ZGV2LT5tc2lfY2FwICsgUENJX01TSV9BRERSRVNTX0hJLAo+ICsgICAgICAgICAgICAgICAgNCk7
Cj4gKyAgICAgICAgcWVtdV9wdXRfYmUzMihmLCBtc2lfaGkpOwo+ICsgICAgfQo+ICsKPiArICAg
IG1zaV9kYXRhID0gcGNpX2RlZmF1bHRfcmVhZF9jb25maWcocGRldiwKPiArICAgICAgICAgICAg
cGRldi0+bXNpX2NhcCArIChtc2lfNjRiaXQgPyBQQ0lfTVNJX0RBVEFfNjQgOiBQQ0lfTVNJX0RB
VEFfMzIpLAo+ICsgICAgICAgICAgICAyKTsKPiArICAgIHFlbXVfcHV0X2JlMzIoZiwgbXNpX2Rh
dGEpOwo+ICsKPiArfQo+ICsKPiArc3RhdGljIGludCB2ZmlvX3NhdmVfY29tcGxldGVfcHJlY29w
eShRRU1VRmlsZSAqZiwgdm9pZCAqb3BhcXVlKQo+ICt7Cj4gKyAgICBWRklPUENJRGV2aWNlICp2
ZGV2ID0gb3BhcXVlOwo+ICsgICAgaW50IHJjID0gMDsKPiArCj4gKyAgICBxZW11X3B1dF9ieXRl
KGYsIFZGSU9fU0FWRV9GTEFHX1BDSSB8IFZGSU9fU0FWRV9GTEFHX0NPTlRJTlVFKTsKPiArICAg
IHZmaW9fcGNpX3NhdmVfY29uZmlnKHZkZXYsIGYpOwo+ICsKPiArICAgIHFlbXVfcHV0X2J5dGUo
ZiwgVkZJT19TQVZFX0ZMQUdfREVWQ09ORklHKTsKPiArICAgIHJjICs9IHZmaW9fZ2V0X2Rldmlj
ZV9jb25maWdfc2l6ZSh2ZGV2KTsKPiArICAgIHJjICs9IHZmaW9fc2F2ZV9kYXRhX2RldmljZV9j
b25maWcodmRldiwgZik7Cj4gKwo+ICsgICAgcmV0dXJuIHJjOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
aW50IHZmaW9fc2F2ZV9zZXR1cChRRU1VRmlsZSAqZiwgdm9pZCAqb3BhcXVlKQo+ICt7Cj4gKyAg
ICBWRklPUENJRGV2aWNlICp2ZGV2ID0gb3BhcXVlOwo+ICsgICAgcWVtdV9wdXRfYnl0ZShmLCBW
RklPX1NBVkVfRkxBR19TRVRVUCk7Cj4gKwo+ICsgICAgdmZpb19zZXRfZGV2aWNlX3N0YXRlKHZk
ZXYsIFZGSU9fREVWSUNFX1NUQVRFX1JVTk5JTkcgfAo+ICsgICAgICAgICAgICBWRklPX0RFVklD
RV9TVEFURV9MT0dHSU5HKTsKPiArICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50
IHZmaW9fbG9hZF9zZXR1cChRRU1VRmlsZSAqZiwgdm9pZCAqb3BhcXVlKQo+ICt7Cj4gKyAgICBy
ZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmZpb19zYXZlX2NsZWFudXAodm9pZCAq
b3BhcXVlKQo+ICt7Cj4gKyAgICBWRklPUENJRGV2aWNlICp2ZGV2ID0gb3BhcXVlOwo+ICsgICAg
dWludDMyX3QgZGV2X3N0YXRlID0gdmRldi0+bWlncmF0aW9uLT5kZXZpY2Vfc3RhdGU7Cj4gKwo+
ICsgICAgZGV2X3N0YXRlICY9IH5WRklPX0RFVklDRV9TVEFURV9MT0dHSU5HOwo+ICsKPiArICAg
IHZmaW9fc2V0X2RldmljZV9zdGF0ZSh2ZGV2LCBkZXZfc3RhdGUpOwo+ICt9CgpUaGVzZSBsb29r
IGxpa2UgdGhleSBzaG91bGQgYmUgdHlwZS1pbmRlcGVuZGVudCwgYWdhaW4uCgo+ICsKPiArc3Rh
dGljIFNhdmVWTUhhbmRsZXJzIHNhdmV2bV92ZmlvX2hhbmRsZXJzID0gewo+ICsgICAgLnNhdmVf
c2V0dXAgPSB2ZmlvX3NhdmVfc2V0dXAsCj4gKyAgICAuc2F2ZV9saXZlX3BlbmRpbmcgPSB2Zmlv
X3NhdmVfbGl2ZV9wZW5kaW5nLAo+ICsgICAgLnNhdmVfbGl2ZV9pdGVyYXRlID0gdmZpb19zYXZl
X2l0ZXJhdGUsCj4gKyAgICAuc2F2ZV9saXZlX2NvbXBsZXRlX3ByZWNvcHkgPSB2ZmlvX3NhdmVf
Y29tcGxldGVfcHJlY29weSwKPiArICAgIC5zYXZlX2NsZWFudXAgPSB2ZmlvX3NhdmVfY2xlYW51
cCwKPiArICAgIC5sb2FkX3NldHVwID0gdmZpb19sb2FkX3NldHVwLAo+ICsgICAgLmxvYWRfc3Rh
dGUgPSB2ZmlvX2xvYWRfc3RhdGUsCj4gK307Cj4gKwo+ICtpbnQgdmZpb19taWdyYXRpb25faW5p
dChWRklPUENJRGV2aWNlICp2ZGV2LCBFcnJvciAqKmVycnApCj4gK3sKPiArICAgIGludCByZXQ7
Cj4gKyAgICBFcnJvciAqbG9jYWxfZXJyID0gTlVMTDsKPiArICAgIHZkZXYtPm1pZ3JhdGlvbiA9
IGdfbmV3MChWRklPTWlncmF0aW9uLCAxKTsKPiArCj4gKyAgICBpZiAodmZpb19kZXZpY2Vfc3Rh
dGVfcmVnaW9uX3NldHVwKHZkZXYsCj4gKyAgICAgICAgICAgICAgJnZkZXYtPm1pZ3JhdGlvbi0+
cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9OX0NUTF0sCj4gKyAgICAgICAgICAgICAgVkZJT19S
RUdJT05fU1VCVFlQRV9ERVZJQ0VfU1RBVEVfQ1RMLAo+ICsgICAgICAgICAgICAgICJkZXZpY2Ut
c3RhdGUtY3RsIikpIHsKPiArICAgICAgICBnb3RvIGVycm9yOwo+ICsgICAgfQo+ICsKPiArICAg
IGlmICh2ZmlvX2NoZWNrX2RldnN0YXRlX3ZlcnNpb24odmRldikpIHsKPiArICAgICAgICBnb3Rv
IGVycm9yOwo+ICsgICAgfQo+ICsKPiArICAgIGlmICh2ZmlvX2dldF9kZXZpY2VfZGF0YV9jYXBz
KHZkZXYpKSB7Cj4gKyAgICAgICAgZ290byBlcnJvcjsKPiArICAgIH0KPiArCj4gKyAgICBpZiAo
dmZpb19kZXZpY2Vfc3RhdGVfcmVnaW9uX3NldHVwKHZkZXYsCj4gKyAgICAgICAgICAgICAgJnZk
ZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9OX0RBVEFfQ09ORklHXSwK
PiArICAgICAgICAgICAgICBWRklPX1JFR0lPTl9TVUJUWVBFX0RFVklDRV9TVEFURV9EQVRBX0NP
TkZJRywKPiArICAgICAgICAgICAgICAiZGV2aWNlLXN0YXRlLWRhdGEtZGV2aWNlLWNvbmZpZyIp
KSB7Cj4gKyAgICAgICAgZ290byBlcnJvcjsKPiArICAgIH0KPiArCj4gKyAgICBpZiAodmZpb19k
ZXZpY2VfZGF0YV9jYXBfZGV2aWNlX21lbW9yeSh2ZGV2KSkgewo+ICsgICAgICAgIGVycm9yX3Jl
cG9ydCgiTm8gc3VwcHBvcnQgb2YgZGF0YSBjYXAgZGV2aWNlIG1lbW9yeSBZZXQiKTsKPiArICAg
ICAgICBnb3RvIGVycm9yOwo+ICsgICAgfQo+ICsKPiArICAgIGlmICh2ZmlvX2RldmljZV9kYXRh
X2NhcF9zeXN0ZW1fbWVtb3J5KHZkZXYpICYmCj4gKyAgICAgICAgICAgIHZmaW9fZGV2aWNlX3N0
YXRlX3JlZ2lvbl9zZXR1cCh2ZGV2LAo+ICsgICAgICAgICAgICAgICZ2ZGV2LT5taWdyYXRpb24t
PnJlZ2lvbltWRklPX0RFVlNUQVRFX1JFR0lPTl9EQVRBX0JJVE1BUF0sCj4gKyAgICAgICAgICAg
ICAgVkZJT19SRUdJT05fU1VCVFlQRV9ERVZJQ0VfU1RBVEVfREFUQV9ESVJUWUJJVE1BUCwKPiAr
ICAgICAgICAgICAgICAiZGV2aWNlLXN0YXRlLWRhdGEtZGlydHliaXRtYXAiKSkgewo+ICsgICAg
ICAgIGdvdG8gZXJyb3I7Cj4gKyAgICB9Cj4gKwo+ICsgICAgdmRldi0+bWlncmF0aW9uLT5kZXZp
Y2Vfc3RhdGUgPSBWRklPX0RFVklDRV9TVEFURV9SVU5OSU5HOwo+ICsKPiArICAgIHJlZ2lzdGVy
X3NhdmV2bV9saXZlKE5VTEwsIFRZUEVfVkZJT19QQ0ksIC0xLAo+ICsgICAgICAgICAgICBWRklP
X0RFVklDRV9TVEFURV9JTlRFUkZBQ0VfVkVSU0lPTiwKPiArICAgICAgICAgICAgJnNhdmV2bV92
ZmlvX2hhbmRsZXJzLAo+ICsgICAgICAgICAgICB2ZGV2KTsKPiArCj4gKyAgICB2ZGV2LT5taWdy
YXRpb24tPnZtX3N0YXRlID0KPiArICAgICAgICBxZW11X2FkZF92bV9jaGFuZ2Vfc3RhdGVfaGFu
ZGxlcih2ZmlvX3ZtX2NoYW5nZV9zdGF0ZV9oYW5kbGVyLCB2ZGV2KTsKPiArCj4gKyAgICByZXR1
cm4gMDsKPiArZXJyb3I6Cj4gKyAgICBlcnJvcl9zZXRnKCZ2ZGV2LT5taWdyYXRpb25fYmxvY2tl
ciwKPiArICAgICAgICAgICAgIlZGSU8gZGV2aWNlIGRvZXNuJ3Qgc3VwcG9ydCBtaWdyYXRpb24i
KTsKPiArICAgIHJldCA9IG1pZ3JhdGVfYWRkX2Jsb2NrZXIodmRldi0+bWlncmF0aW9uX2Jsb2Nr
ZXIsICZsb2NhbF9lcnIpOwo+ICsgICAgaWYgKGxvY2FsX2Vycikgewo+ICsgICAgICAgIGVycm9y
X3Byb3BhZ2F0ZShlcnJwLCBsb2NhbF9lcnIpOwo+ICsgICAgICAgIGVycm9yX2ZyZWUodmRldi0+
bWlncmF0aW9uX2Jsb2NrZXIpOwo+ICsgICAgfQo+ICsKPiArICAgIGdfZnJlZSh2ZGV2LT5taWdy
YXRpb24pOwo+ICsgICAgdmRldi0+bWlncmF0aW9uID0gTlVMTDsKPiArCj4gKyAgICByZXR1cm4g
cmV0Owo+ICt9Cj4gKwo+ICt2b2lkIHZmaW9fbWlncmF0aW9uX2ZpbmFsaXplKFZGSU9QQ0lEZXZp
Y2UgKnZkZXYpCj4gK3sKPiArICAgIGlmICh2ZGV2LT5taWdyYXRpb24pIHsKPiArICAgICAgICBp
bnQgaTsKPiArICAgICAgICBxZW11X2RlbF92bV9jaGFuZ2Vfc3RhdGVfaGFuZGxlcih2ZGV2LT5t
aWdyYXRpb24tPnZtX3N0YXRlKTsKPiArICAgICAgICB1bnJlZ2lzdGVyX3NhdmV2bShOVUxMLCBU
WVBFX1ZGSU9fUENJLCB2ZGV2KTsKPiArICAgICAgICBmb3IgKGkgPSAwOyBpIDwgVkZJT19ERVZT
VEFURV9SRUdJT05fTlVNOyBpKyspIHsKPiArICAgICAgICAgICAgdmZpb19yZWdpb25fZmluYWxp
emUoJnZkZXYtPm1pZ3JhdGlvbi0+cmVnaW9uW2ldKTsKPiArICAgICAgICB9Cj4gKyAgICAgICAg
Z19mcmVlKHZkZXYtPm1pZ3JhdGlvbik7Cj4gKyAgICAgICAgdmRldi0+bWlncmF0aW9uID0gTlVM
TDsKPiArICAgIH0gZWxzZSBpZiAodmRldi0+bWlncmF0aW9uX2Jsb2NrZXIpIHsKPiArICAgICAg
ICBtaWdyYXRlX2RlbF9ibG9ja2VyKHZkZXYtPm1pZ3JhdGlvbl9ibG9ja2VyKTsKPiArICAgICAg
ICBlcnJvcl9mcmVlKHZkZXYtPm1pZ3JhdGlvbl9ibG9ja2VyKTsKPiArICAgIH0KPiArfQo+IGRp
ZmYgLS1naXQgYS9ody92ZmlvL3BjaS5jIGIvaHcvdmZpby9wY2kuYwo+IGluZGV4IGMwY2IxZWMu
LmI4ZTAwNmIgMTAwNjQ0Cj4gLS0tIGEvaHcvdmZpby9wY2kuYwo+ICsrKyBiL2h3L3ZmaW8vcGNp
LmMKPiBAQCAtMzcsNyArMzcsNiBAQAo+ICAKPiAgI2RlZmluZSBNU0lYX0NBUF9MRU5HVEggMTIK
PiAgCj4gLSNkZWZpbmUgVFlQRV9WRklPX1BDSSAidmZpby1wY2kiCgpXaHkgZG8geW91IG5lZWQg
dG8gbW92ZSB0aGlzPyBUaGF0IGxvb2tzIGxpa2UgYSBzaWduIHRoYXQgdGhlIGxheWVyaW5nCm5l
ZWRzIHdvcmsuCgo+ICAjZGVmaW5lIFBDSV9WRklPKG9iaikgICAgT0JKRUNUX0NIRUNLKFZGSU9Q
Q0lEZXZpY2UsIG9iaiwgVFlQRV9WRklPX1BDSSkKPiAgCj4gIHN0YXRpYyB2b2lkIHZmaW9fZGlz
YWJsZV9pbnRlcnJ1cHRzKFZGSU9QQ0lEZXZpY2UgKnZkZXYpOwo+IGRpZmYgLS1naXQgYS9ody92
ZmlvL3BjaS5oIGIvaHcvdmZpby9wY2kuaAo+IGluZGV4IGIxYWU0YzAuLjRiN2IxYmIgMTAwNjQ0
Cj4gLS0tIGEvaHcvdmZpby9wY2kuaAo+ICsrKyBiL2h3L3ZmaW8vcGNpLmgKPiBAQCAtMTksNiAr
MTksNyBAQAo+ICAjaW5jbHVkZSAicWVtdS9ldmVudF9ub3RpZmllci5oIgo+ICAjaW5jbHVkZSAi
cWVtdS9xdWV1ZS5oIgo+ICAjaW5jbHVkZSAicWVtdS90aW1lci5oIgo+ICsjaW5jbHVkZSAic3lz
ZW11L3N5c2VtdS5oIgo+ICAKPiAgI2RlZmluZSBQQ0lfQU5ZX0lEICh+MCkKPiAgCj4gQEAgLTU2
LDYgKzU3LDIxIEBAIHR5cGVkZWYgc3RydWN0IFZGSU9CQVIgewo+ICAgICAgUUxJU1RfSEVBRCgs
IFZGSU9RdWlyaykgcXVpcmtzOwo+ICB9IFZGSU9CQVI7Cj4gIAo+ICtlbnVtIHsKPiArICAgIFZG
SU9fREVWU1RBVEVfUkVHSU9OX0NUTCA9IDAsCj4gKyAgICBWRklPX0RFVlNUQVRFX1JFR0lPTl9E
QVRBX0NPTkZJRywKPiArICAgIFZGSU9fREVWU1RBVEVfUkVHSU9OX0RBVEFfREVWSUNFX01FTU9S
WSwKPiArICAgIFZGSU9fREVWU1RBVEVfUkVHSU9OX0RBVEFfQklUTUFQLAo+ICsgICAgVkZJT19E
RVZTVEFURV9SRUdJT05fTlVNLAo+ICt9Owo+ICt0eXBlZGVmIHN0cnVjdCBWRklPTWlncmF0aW9u
IHsKPiArICAgIFZGSU9SZWdpb24gcmVnaW9uW1ZGSU9fREVWU1RBVEVfUkVHSU9OX05VTV07Cj4g
KyAgICB1aW50MzJfdCBkYXRhX2NhcHM7Cj4gKyAgICB1aW50MzJfdCBkZXZpY2Vfc3RhdGU7Cj4g
KyAgICB1aW50NjRfdCBkZXZjb25maWdfc2l6ZTsKPiArICAgIFZNQ2hhbmdlU3RhdGVFbnRyeSAq
dm1fc3RhdGU7Cj4gK30gVkZJT01pZ3JhdGlvbjsKPiArCj4gIHR5cGVkZWYgc3RydWN0IFZGSU9W
R0FSZWdpb24gewo+ICAgICAgTWVtb3J5UmVnaW9uIG1lbTsKPiAgICAgIG9mZl90IG9mZnNldDsK
PiBAQCAtMTMyLDYgKzE0OCw4IEBAIHR5cGVkZWYgc3RydWN0IFZGSU9QQ0lEZXZpY2Ugewo+ICAg
ICAgVkZJT0JBUiBiYXJzW1BDSV9OVU1fUkVHSU9OUyAtIDFdOyAvKiBObyBST00gKi8KPiAgICAg
IFZGSU9WR0EgKnZnYTsgLyogMHhhMDAwMCwgMHgzYjAsIDB4M2MwICovCj4gICAgICB2b2lkICpp
Z2Rfb3ByZWdpb247Cj4gKyAgICBWRklPTWlncmF0aW9uICptaWdyYXRpb247CgpBcyBzYWlkLCBp
dCB3b3VsZCBwcm9iYWJseSBiZSBiZXR0ZXIgdG8gaGFuZyB0aGlzIG9mZiBWRklPRGV2aWNlLgoK
PiArICAgIEVycm9yICptaWdyYXRpb25fYmxvY2tlcjsKPiAgICAgIFBDSUhvc3REZXZpY2VBZGRy
ZXNzIGhvc3Q7Cj4gICAgICBFdmVudE5vdGlmaWVyIGVycl9ub3RpZmllcjsKPiAgICAgIEV2ZW50
Tm90aWZpZXIgcmVxX25vdGlmaWVyOwo+IEBAIC0xOTgsNSArMjE2LDEwIEBAIGludCB2ZmlvX3Bj
aV9pZ2Rfb3ByZWdpb25faW5pdChWRklPUENJRGV2aWNlICp2ZGV2LAo+ICB2b2lkIHZmaW9fZGlz
cGxheV9yZXNldChWRklPUENJRGV2aWNlICp2ZGV2KTsKPiAgaW50IHZmaW9fZGlzcGxheV9wcm9i
ZShWRklPUENJRGV2aWNlICp2ZGV2LCBFcnJvciAqKmVycnApOwo+ICB2b2lkIHZmaW9fZGlzcGxh
eV9maW5hbGl6ZShWRklPUENJRGV2aWNlICp2ZGV2KTsKPiAtCj4gK2Jvb2wgdmZpb19kZXZpY2Vf
ZGF0YV9jYXBfc3lzdGVtX21lbW9yeShWRklPUENJRGV2aWNlICp2ZGV2KTsKPiArYm9vbCB2Zmlv
X2RldmljZV9kYXRhX2NhcF9kZXZpY2VfbWVtb3J5KFZGSU9QQ0lEZXZpY2UgKnZkZXYpOwo+ICtp
bnQgdmZpb19zZXRfZGlydHlfcGFnZV9iaXRtYXAoVkZJT1BDSURldmljZSAqdmRldiwKPiArICAg
ICAgICAgdWludDY0X3Qgc3RhcnRfYWRkciwgdWludDY0X3QgcGFnZV9ucik7Cj4gK2ludCB2Zmlv
X21pZ3JhdGlvbl9pbml0KFZGSU9QQ0lEZXZpY2UgKnZkZXYsIEVycm9yICoqZXJycCk7Cj4gK3Zv
aWQgdmZpb19taWdyYXRpb25fZmluYWxpemUoVkZJT1BDSURldmljZSAqdmRldik7CgpBbmQgdGhl
IGludGVyZmFjZXMgc2hvdWxkIGJlIGluIHZmaW8tY29tbW9uLgoKPiAgI2VuZGlmIC8qIEhXX1ZG
SU9fVkZJT19QQ0lfSCAqLwo+IGRpZmYgLS1naXQgYS9pbmNsdWRlL2h3L3ZmaW8vdmZpby1jb21t
b24uaCBiL2luY2x1ZGUvaHcvdmZpby92ZmlvLWNvbW1vbi5oCj4gaW5kZXggMWI0MzRkMC4uZWQ0
MzYxMyAxMDA2NDQKPiAtLS0gYS9pbmNsdWRlL2h3L3ZmaW8vdmZpby1jb21tb24uaAo+ICsrKyBi
L2luY2x1ZGUvaHcvdmZpby92ZmlvLWNvbW1vbi5oCj4gQEAgLTMyLDYgKzMyLDcgQEAKPiAgI2Vu
ZGlmCj4gIAo+ICAjZGVmaW5lIFZGSU9fTVNHX1BSRUZJWCAidmZpbyAlczogIgo+ICsjZGVmaW5l
IFRZUEVfVkZJT19QQ0kgInZmaW8tcGNpIgo+ICAKPiAgZW51bSB7Cj4gICAgICBWRklPX0RFVklD
RV9UWVBFX1BDSSA9IDAsCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwppbnRlbC1ndnQtZGV2IG1haWxpbmcgbGlzdAppbnRlbC1ndnQtZGV2QGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL2ludGVsLWd2dC1kZXY=
