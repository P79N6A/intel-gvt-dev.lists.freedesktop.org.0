Delivered-To: linux.kernel.mailinglists@gmail.com
Received: by 2002:a81:3684:0:0:0:0:0 with SMTP id d126csp3034022ywa;
        Mon, 18 Feb 2019 23:51:58 -0800 (PST)
X-Google-Smtp-Source: AHgI3Iaj3Fj3QHW2QIHnnfcDHyXcQSVLnc9eSxsFMRLO8KE7ozzvKN3Ir2i9XRGllImYgZ13TCRI
X-Received: by 2002:a62:2bc4:: with SMTP id r187mr28251154pfr.25.1550562718346;
        Mon, 18 Feb 2019 23:51:58 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1550562718; cv=none;
        d=google.com; s=arc-20160816;
        b=DIZ9re5q+Rgz7A57d7z77CBbrPlbV9yss+b9bfbkuFW3mAr2d4vk1JPxbienN20QOk
         4yr0nGckAH//YaVW5j5u5QQxJZi15UoAct84n6WQ0VwakVwlvg2rN4Q6OLRajEmjk6Ev
         uZNEp8vchhMXTsqfMUt/x/ppmi0onGFV26pN0aUZpZ89URhUuEoY2hSZiXOzjXbV6JQs
         XQSRNmrL27UUkKh3VjC1xkNt/D/LkkLQun12o9xNIBPcXVKiG1XXvBQKaYsh1HtQ4VjI
         CbWWJ3F0hgXHgwwzf4NCZ0uCFuVaeFLsQ6GPUcjY+jeWRnpwMSq4gPXOY3r8oehwPaTB
         9vIQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:mime-version:cc
         :list-subscribe:list-help:list-post:list-archive:list-unsubscribe
         :list-id:precedence:references:in-reply-to:message-id:date:subject
         :to:from:delivered-to;
        bh=Wy9/ITL9DNT0c+P9Pqqi8OE31tabzSIpbmcyZh6jJHg=;
        b=RXAkorYL1wuxQwikmZThpC4YKrKVwZxLBaUu4rVd//ouLUG74P4mc7gYBoEHv8J4gO
         qneUzxub3DqX8NsaSrJiQdYXn7SCx1XPqm9WffDadwG4SquOPR/b674v6c5aNzcp/s9r
         qNs2MbsIKbR1TGyiKhuWIOtIPhzDi+dqNjNfune+tlZ7kbldLU5q4gfz6SJgbWfP8oND
         FqPjZ4uAeysOYt7N89+z/Fx7Og6krcTfri2sJfN6mzCmIXfypsh5KmCj8PZvFnleN62h
         E6K6xvHcZUyjzHlnG1+QVfUP5NfWhNwx2XT5x6kOz5cyuq7heMcP9ySJt+hnDAvaM0MD
         VMFQ==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 2610:10:20:722:a800:ff:fe36:1795 as permitted sender) smtp.mailfrom=intel-gvt-dev-bounces@lists.freedesktop.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=intel.com
Return-Path: <intel-gvt-dev-bounces@lists.freedesktop.org>
Received: from gabe.freedesktop.org (gabe.freedesktop.org. [2610:10:20:722:a800:ff:fe36:1795])
        by mx.google.com with ESMTPS id b6si15345148pgg.2.2019.02.18.23.51.58
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Mon, 18 Feb 2019 23:51:58 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 2610:10:20:722:a800:ff:fe36:1795 as permitted sender) client-ip=2610:10:20:722:a800:ff:fe36:1795;
Authentication-Results: mx.google.com;
       spf=pass (google.com: best guess record for domain of intel-gvt-dev-bounces@lists.freedesktop.org designates 2610:10:20:722:a800:ff:fe36:1795 as permitted sender) smtp.mailfrom=intel-gvt-dev-bounces@lists.freedesktop.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=intel.com
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EE27E89259;
	Tue, 19 Feb 2019 07:51:57 +0000 (UTC)
X-Original-To: intel-gvt-dev@lists.freedesktop.org
Delivered-To: intel-gvt-dev@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7186F89259
 for <intel-gvt-dev@lists.freedesktop.org>;
 Tue, 19 Feb 2019 07:51:56 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 18 Feb 2019 23:51:56 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.58,387,1544515200"; d="scan'208";a="147958464"
Received: from joy-optiplex-7040.sh.intel.com ([10.239.13.9])
 by fmsmga001.fm.intel.com with ESMTP; 18 Feb 2019 23:51:54 -0800
From: Yan Zhao <yan.y.zhao@intel.com>
To: intel-gvt-dev@lists.freedesktop.org,
	alex.williamson@redhat.com
Subject: [PATCH 7/8] drm/i915/gvt: vGPU device config data save/restore
 interface
Date: Tue, 19 Feb 2019 02:46:32 -0500
Message-Id: <20190219074632.14350-1-yan.y.zhao@intel.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190219074242.14015-1-yan.y.zhao@intel.com>
References: <20190219074242.14015-1-yan.y.zhao@intel.com>
X-BeenThere: intel-gvt-dev@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: "Intel GVT \(Graphics Virtualization\) development list"
 <intel-gvt-dev.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gvt-dev>
List-Post: <mailto:intel-gvt-dev@lists.freedesktop.org>
List-Help: <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=subscribe>
Cc: Yan Zhao <yan.y.zhao@intel.com>, kvm@vger.kernel.org,
 linux-kernel@vger.kernel.org, Zhenyu Wang <zhenyuw@linux.intel.com>,
 Yulei Zhang <yulei.zhang@intel.com>, Xiao Zheng <xiao.zheng@intel.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gvt-dev-bounces@lists.freedesktop.org
Sender: "intel-gvt-dev" <intel-gvt-dev-bounces@lists.freedesktop.org>

VGhlIHBhdGNoIGltcGxtZW50cyB0aGUgZ3Z0IGludGVyZmFjZSBpbnRlbF9ndnRfc2F2ZV9yZXN0
b3JlIHRvCnNhdmUvcmVzdG9yZSB2R1BVJ3MgZGV2aWNlIGNvbmZpZyBkYXRhIGZvciBsaXZlIG1p
Z3JhdGlvbi4KCnZHUFUgZGV2aWNlIGNvbmZpZyBkYXRhIGluY2x1ZGVzIHZyZWcsIHZnZ3R0LCB2
Y2ZnIHNwYWNlLCB3b3JrbG9hZHMsIHBwZ3R0LApleGVjbGlzdC4KSXQgZG9lcyBub3QgaW5jbHVk
ZSBkaXJ0eSBwYWdlcyBpbiBzeXN0ZW0gbWVtb3J5IHByb2R1Y2VkIGJ5IHZHUFUuCgpTaWduZWQt
b2ZmLWJ5OiBZdWxlaSBaaGFuZyA8eXVsZWkuemhhbmdAaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5
OiBYaWFvIFpoZW5nIDx4aWFvLnpoZW5nQGludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogWmhlbnl1
IFdhbmcgPHpoZW55dXdAbGludXguaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBZYW4gWmhhbyA8
eWFuLnkuemhhb0BpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L01ha2Vm
aWxlICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9leGVjbGlzdC5jIHwgICAy
ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmMgICAgICB8ICAgMiArLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L2d0dC5oICAgICAgfCAgIDMgKwogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2d2dC5jICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5o
ICAgICAgfCAgIDkgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21pZ3JhdGUuYyAgfCA4NjMg
KysrKysrKysrKysrKysrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21p
Z3JhdGUuaCAgfCAgOTcgKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21taW8uYyAgICAg
fCAgMTMgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21taW8uaCAgICAgfCAgIDEgKwogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3ZncHUuYyAgICAgfCAgIDEgKwogMTEgZmlsZXMgY2hhbmdl
ZCwgOTkxIGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21pZ3JhdGUuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9taWdyYXRlLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndnQvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvTWFrZWZp
bGUKaW5kZXggYjAxNmRjNzUzZGI5Li5mODYzZmJlZDE3OTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQv
TWFrZWZpbGUKQEAgLTMsNyArMyw3IEBAIEdWVF9ESVIgOj0gZ3Z0CiBHVlRfU09VUkNFIDo9IGd2
dC5vIGFwZXJ0dXJlX2dtLm8gaGFuZGxlcnMubyB2Z3B1Lm8gdHJhY2VfcG9pbnRzLm8gZmlybXdh
cmUubyBcCiAJaW50ZXJydXB0Lm8gZ3R0Lm8gY2ZnX3NwYWNlLm8gb3ByZWdpb24ubyBtbWlvLm8g
ZGlzcGxheS5vIGVkaWQubyBcCiAJZXhlY2xpc3QubyBzY2hlZHVsZXIubyBzY2hlZF9wb2xpY3ku
byBtbWlvX2NvbnRleHQubyBjbWRfcGFyc2VyLm8gZGVidWdmcy5vIFwKLQlmYl9kZWNvZGVyLm8g
ZG1hYnVmLm8gcGFnZV90cmFjay5vCisJZmJfZGVjb2Rlci5vIGRtYWJ1Zi5vIHBhZ2VfdHJhY2su
byBtaWdyYXRlLm8KIAogY2NmbGFncy15CQkJCSs9IC1JJChzcmMpIC1JJChzcmMpLyQoR1ZUX0RJ
UikKIGk5MTUteQkJCQkJKz0gJChhZGRwcmVmaXggJChHVlRfRElSKS8sICQoR1ZUX1NPVVJDRSkp
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZXhlY2xpc3QuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9leGVjbGlzdC5jCmluZGV4IDcwNDk0ZTM5NGQyYy4uOTkyZTIy
NjBlZWM5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZXhlY2xpc3QuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZXhlY2xpc3QuYwpAQCAtNDM3LDcgKzQzNyw3
IEBAIHN0YXRpYyBpbnQgY29tcGxldGVfZXhlY2xpc3Rfd29ya2xvYWQoc3RydWN0IGludGVsX3Zn
cHVfd29ya2xvYWQgKndvcmtsb2FkKQogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgc3Vi
bWl0X2NvbnRleHQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGludCByaW5nX2lkLAoraW50IHN1
Ym1pdF9jb250ZXh0KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQgcmluZ19pZCwKIAkJc3Ry
dWN0IGV4ZWNsaXN0X2N0eF9kZXNjcmlwdG9yX2Zvcm1hdCAqZGVzYywKIAkJYm9vbCBlbXVsYXRl
X3NjaGVkdWxlX2luKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d0
dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d0dC5jCmluZGV4IDc1M2FkOTc1Yzk1OC4u
MThlM2YwOGIwNTUzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d0dC5jCkBAIC01ODksNyArNTg5LDcgQEAg
c3RhdGljIGlubGluZSB2b2lkIHBwZ3R0X3NldF9zaGFkb3dfcm9vdF9lbnRyeShzdHJ1Y3QgaW50
ZWxfdmdwdV9tbSAqbW0sCiAJX3BwZ3R0X3NldF9yb290X2VudHJ5KG1tLCBlbnRyeSwgaW5kZXgs
IGZhbHNlKTsKIH0KIAotc3RhdGljIHZvaWQgZ2d0dF9nZXRfZ3Vlc3RfZW50cnkoc3RydWN0IGlu
dGVsX3ZncHVfbW0gKm1tLAordm9pZCBnZ3R0X2dldF9ndWVzdF9lbnRyeShzdHJ1Y3QgaW50ZWxf
dmdwdV9tbSAqbW0sCiAJCXN0cnVjdCBpbnRlbF9ndnRfZ3R0X2VudHJ5ICplbnRyeSwgdW5zaWdu
ZWQgbG9uZyBpbmRleCkKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3Z0X2d0dF9wdGVfb3BzICpwdGVfb3Bz
ID0gbW0tPnZncHUtPmd2dC0+Z3R0LnB0ZV9vcHM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndnQvZ3R0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmgKaW5kZXgg
ZDhjYjA0Y2M5NDZkLi43MzcwOTc2OGI2NjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9ndHQuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmgKQEAgLTI3
MCw2ICsyNzAsOSBAQCBzdHJ1Y3QgaW50ZWxfdmdwdV9tbSAqaW50ZWxfdmdwdV9nZXRfcHBndHRf
bW0oc3RydWN0IGludGVsX3ZncHUgKnZncHUsCiAKIGludCBpbnRlbF92Z3B1X3B1dF9wcGd0dF9t
bShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdTY0IHBkcHNbXSk7CiAKK3ZvaWQgZ2d0dF9nZXRf
Z3Vlc3RfZW50cnkoc3RydWN0IGludGVsX3ZncHVfbW0gKm1tLAorCQlzdHJ1Y3QgaW50ZWxfZ3Z0
X2d0dF9lbnRyeSAqZW50cnksIHVuc2lnbmVkIGxvbmcgaW5kZXgpOworCiBpbnQgaW50ZWxfdmdw
dV9lbXVsYXRlX2dndHRfbW1pb19yZWFkKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAogCXVuc2ln
bmVkIGludCBvZmYsIHZvaWQgKnBfZGF0YSwgdW5zaWduZWQgaW50IGJ5dGVzKTsKIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2d2dC5jCmluZGV4IDczM2EyYTBkMGMzMC4uM2RkOWU0ZWJkMzliIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3Z0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2d2dC5jCkBAIC0xODUsNiArMTg1LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRl
bF9ndnRfb3BzIGludGVsX2d2dF9vcHMgPSB7CiAJLnZncHVfcXVlcnlfcGxhbmUgPSBpbnRlbF92
Z3B1X3F1ZXJ5X3BsYW5lLAogCS52Z3B1X2dldF9kbWFidWYgPSBpbnRlbF92Z3B1X2dldF9kbWFi
dWYsCiAJLndyaXRlX3Byb3RlY3RfaGFuZGxlciA9IGludGVsX3ZncHVfcGFnZV90cmFja19oYW5k
bGVyLAorCS52Z3B1X3NhdmVfcmVzdG9yZSA9IGludGVsX2d2dF9zYXZlX3Jlc3RvcmUsCiB9Owog
CiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaAppbmRleCAxZjVlZjU5YTM2YWMuLmNmZGU1MTBlOWQ3
NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5oCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaApAQCAtNDYsNiArNDYsNyBAQAogI2luY2x1ZGUgInNj
aGVkX3BvbGljeS5oIgogI2luY2x1ZGUgIm1taW9fY29udGV4dC5oIgogI2luY2x1ZGUgImNtZF9w
YXJzZXIuaCIKKyNpbmNsdWRlICJtaWdyYXRlLmgiCiAjaW5jbHVkZSAiZmJfZGVjb2Rlci5oIgog
I2luY2x1ZGUgImRtYWJ1Zi5oIgogI2luY2x1ZGUgInBhZ2VfdHJhY2suaCIKQEAgLTUxMCw2ICs1
MTEsOCBAQCB2b2lkIGludGVsX2d2dF9yZXNldF92Z3B1X2xvY2tlZChzdHJ1Y3QgaW50ZWxfdmdw
dSAqdmdwdSwgYm9vbCBkbWxyLAogdm9pZCBpbnRlbF9ndnRfcmVzZXRfdmdwdShzdHJ1Y3QgaW50
ZWxfdmdwdSAqdmdwdSk7CiB2b2lkIGludGVsX2d2dF9hY3RpdmF0ZV92Z3B1KHN0cnVjdCBpbnRl
bF92Z3B1ICp2Z3B1KTsKIHZvaWQgaW50ZWxfZ3Z0X2RlYWN0aXZhdGVfdmdwdShzdHJ1Y3QgaW50
ZWxfdmdwdSAqdmdwdSk7CitpbnQgaW50ZWxfZ3Z0X3NhdmVfcmVzdG9yZShzdHJ1Y3QgaW50ZWxf
dmdwdSAqdmdwdSwgY2hhciAqYnVmLAorCQlzaXplX3QgY291bnQsIHZvaWQgKmJhc2UsIHVpbnQ2
NF90IG9mZiwgYm9vbCByZXN0b3JlKTsKIAogLyogdmFsaWRhdGluZyBHTSBmdW5jdGlvbnMgKi8K
ICNkZWZpbmUgdmdwdV9nbWFkcl9pc19hcGVydHVyZSh2Z3B1LCBnbWFkcikgXApAQCAtNjA5LDYg
KzYxMiw5IEBAIHN0cnVjdCBpbnRlbF9ndnRfb3BzIHsKIAlpbnQgKCp2Z3B1X2dldF9kbWFidWYp
KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB1bnNpZ25lZCBpbnQpOwogCWludCAoKndyaXRlX3By
b3RlY3RfaGFuZGxlcikoc3RydWN0IGludGVsX3ZncHUgKiwgdTY0LCB2b2lkICosCiAJCQkJICAg
ICB1bnNpZ25lZCBpbnQpOworCWludCAoKnZncHVfc2F2ZV9yZXN0b3JlKShzdHJ1Y3QgaW50ZWxf
dmdwdSAqdmdwdSwgY2hhciAqYnVmLAorCQkJCQlzaXplX3QgY291bnQsIHZvaWQgKmJhc2UsCisJ
CQkJCXVpbnQ2NF90IG9mZiwgYm9vbCByZXN0b3JlKTsKIH07CiAKIApAQCAtNzIyLDYgKzcyOCw5
IEBAIGludCBpbnRlbF9ndnRfZGVidWdmc19hZGRfdmdwdShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdw
dSk7CiB2b2lkIGludGVsX2d2dF9kZWJ1Z2ZzX3JlbW92ZV92Z3B1KHN0cnVjdCBpbnRlbF92Z3B1
ICp2Z3B1KTsKIGludCBpbnRlbF9ndnRfZGVidWdmc19pbml0KHN0cnVjdCBpbnRlbF9ndnQgKmd2
dCk7CiB2b2lkIGludGVsX2d2dF9kZWJ1Z2ZzX2NsZWFuKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCk7
CitpbnQgc3VibWl0X2NvbnRleHQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGludCByaW5nX2lk
LAorCQlzdHJ1Y3QgZXhlY2xpc3RfY3R4X2Rlc2NyaXB0b3JfZm9ybWF0ICpkZXNjLAorCQlib29s
IGVtdWxhdGVfc2NoZWR1bGVfaW4pOwogCiAKICNpbmNsdWRlICJ0cmFjZS5oIgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21pZ3JhdGUuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9taWdyYXRlLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li5kY2E2ZWFlNmY1YzkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dnQvbWlncmF0ZS5jCkBAIC0wLDAgKzEsODYzIEBACisvKgorICogQ29weXJpZ2h0KGMpIDIwMTEt
MjAxNiBJbnRlbCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KKyAqCisgKiBQZXJt
aXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBv
YnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3Vt
ZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3
YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAq
IHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmli
dXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwg
YW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNo
ZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAq
IFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIChp
bmNsdWRpbmcgdGhlIG5leHQKKyAqIHBhcmFncmFwaCkgc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxs
IGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUKKyAqIFNvZnR3YXJlLgorICoK
KyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9G
IEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1J
VEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKKyAqIEZJVE5FU1MgRk9S
IEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBT
SEFMTAorICogVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBB
TlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKKyAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBB
Q1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sCisgKiBP
VVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9U
SEVSIERFQUxJTkdTIElOIFRIRQorICogU09GVFdBUkUuCisgKgorICogQXV0aG9yczoKKyAqICAg
IFl1bGVpIFpoYW5nIDx5dWxlaS56aGFuZ0BpbnRlbC5jb20+CisgKiAgICBYaWFvIFpoZW5nIDx4
aWFvLnpoZW5nQGludGVsLmNvbT4KKyAqLworCisjaW5jbHVkZSAiaTkxNV9kcnYuaCIKKyNpbmNs
dWRlICJndnQuaCIKKyNpbmNsdWRlICJpOTE1X3B2aW5mby5oIgorCisjZGVmaW5lIElOViAoLTEp
CisjZGVmaW5lIFJVTEVTX05VTSh4KSAoc2l6ZW9mKHgpL3NpemVvZihndnRfbWlncmF0aW9uX29i
al90KSkKKyNkZWZpbmUgRk9SX0VBQ0hfT0JKKG9iaiwgcnVsZXMpIFwKKwlmb3IgKG9iaiA9IHJ1
bGVzOyBvYmotPnJlZ2lvbi50eXBlICE9IEdWVF9NSUdSQVRJT05fTk9ORTsgb2JqKyspCisjZGVm
aW5lIE1JR19WUkVHX1JFU1RPUkUodmdwdSwgb2ZmKQkJCQkJXAorCXsJCQkJCQkJCVwKKwkJdTMy
IGRhdGEgPSB2Z3B1X3ZyZWcodmdwdSwgKG9mZikpOwkJCVwKKwkJdTY0IHBhID0gaW50ZWxfdmdw
dV9tbWlvX29mZnNldF90b19ncGEodmdwdSwgb2ZmKTsJXAorCQlpbnRlbF92Z3B1X2VtdWxhdGVf
bW1pb193cml0ZSh2Z3B1LCBwYSwgJmRhdGEsIDQpOwlcCisJfQorCisvKiBzIC0gc3RydWN0Cisg
KiB0IC0gdHlwZSBvZiBvYmoKKyAqIG0gLSBzaXplIG9mIG9iagorICogb3BzIC0gb3BlcmF0aW9u
IG92ZXJyaWRlIGNhbGxiYWNrIGZ1bmMKKyAqLworI2RlZmluZSBNSUdSQVRJT05fVU5JVChfcywg
X3QsIF9tLCBfb3BzKSB7CQlcCisuaW1nCQk9IE5VTEwsCQkJCQlcCisucmVnaW9uLnR5cGUJPSBf
dCwJCQkJCVwKKy5yZWdpb24uc2l6ZQk9IF9tLAkJCQlcCisub3BzCQk9ICYoX29wcyksCQkJCVwK
Ky5uYW1lCQk9ICJbIiNfcyI6IiNfdCJdXDAiCQkJXAorfQorCisjZGVmaW5lIE1JR1JBVElPTl9F
TkQgewkJXAorCU5VTEwsIE5VTEwsIDAsCQlcCisJe0dWVF9NSUdSQVRJT05fTk9ORSwgMH0sXAor
CU5VTEwsCVwKKwlOVUxMCVwKK30KKworc3RhdGljIERFRklORV9NVVRFWChndnRfbWlncmF0aW9u
KTsKK3N0YXRpYyBpbnQgaW1hZ2VfaGVhZGVyX2xvYWQoY29uc3Qgc3RydWN0IGd2dF9taWdyYXRp
b25fb2JqX3QgKm9iaiwgdTMyIHNpemUpOworc3RhdGljIGludCBpbWFnZV9oZWFkZXJfc2F2ZShj
b25zdCBzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCAqb2JqKTsKK3N0YXRpYyBpbnQgdnJlZ19s
b2FkKGNvbnN0IHN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpvYmosIHUzMiBzaXplKTsKK3N0
YXRpYyBpbnQgdnJlZ19zYXZlKGNvbnN0IHN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpvYmop
Oworc3RhdGljIGludCBzcmVnX2xvYWQoY29uc3Qgc3RydWN0IGd2dF9taWdyYXRpb25fb2JqX3Qg
Km9iaiwgdTMyIHNpemUpOworc3RhdGljIGludCBzcmVnX3NhdmUoY29uc3Qgc3RydWN0IGd2dF9t
aWdyYXRpb25fb2JqX3QgKm9iaik7CitzdGF0aWMgaW50IHZjZmdfc3BhY2VfbG9hZChjb25zdCBz
dHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCAqb2JqLCB1MzIgc2l6ZSk7CitzdGF0aWMgaW50IHZj
Zmdfc3BhY2Vfc2F2ZShjb25zdCBzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCAqb2JqKTsKK3N0
YXRpYyBpbnQgdmdndHRfbG9hZChjb25zdCBzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCAqb2Jq
LCB1MzIgc2l6ZSk7CitzdGF0aWMgaW50IHZnZ3R0X3NhdmUoY29uc3Qgc3RydWN0IGd2dF9taWdy
YXRpb25fb2JqX3QgKm9iaik7CitzdGF0aWMgaW50IHdvcmtsb2FkX2xvYWQoY29uc3Qgc3RydWN0
IGd2dF9taWdyYXRpb25fb2JqX3QgKm9iaiwgdTMyIHNpemUpOworc3RhdGljIGludCB3b3JrbG9h
ZF9zYXZlKGNvbnN0IHN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpvYmopOworc3RhdGljIGlu
dCBwcGd0dF9sb2FkKGNvbnN0IHN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpvYmosIHUzMiBz
aXplKTsKK3N0YXRpYyBpbnQgcHBndHRfc2F2ZShjb25zdCBzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9v
YmpfdCAqb2JqKTsKK3N0YXRpYyBpbnQgZXhlY2xpc3RfbG9hZChjb25zdCBzdHJ1Y3QgZ3Z0X21p
Z3JhdGlvbl9vYmpfdCAqb2JqLCB1MzIgc2l6ZSk7CitzdGF0aWMgaW50IGV4ZWNsaXN0X3NhdmUo
Y29uc3Qgc3RydWN0IGd2dF9taWdyYXRpb25fb2JqX3QgKm9iaik7CisKKy8qKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgorICogSW50ZXJuYWwgU3RhdGljIEZ1
bmN0aW9ucworICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
Lworc3RydWN0IGd2dF9taWdyYXRpb25fb3BlcmF0aW9uX3QgdlJlZ19vcHMgPSB7CisJLnByZV9j
b3B5ID0gTlVMTCwKKwkucHJlX3NhdmUgPSB2cmVnX3NhdmUsCisJLnByZV9sb2FkID0gdnJlZ19s
b2FkLAorCS5wb3N0X2xvYWQgPSBOVUxMLAorfTsKKworc3RydWN0IGd2dF9taWdyYXRpb25fb3Bl
cmF0aW9uX3Qgc1JlZ19vcHMgPSB7CisJLnByZV9jb3B5ID0gTlVMTCwKKwkucHJlX3NhdmUgPSBz
cmVnX3NhdmUsCisJLnByZV9sb2FkID0gc3JlZ19sb2FkLAorCS5wb3N0X2xvYWQgPSBOVUxMLAor
fTsKKworc3RydWN0IGd2dF9taWdyYXRpb25fb3BlcmF0aW9uX3QgdmNmZ19zcGFjZV9vcHMgPSB7
CisJLnByZV9jb3B5ID0gTlVMTCwKKwkucHJlX3NhdmUgPSB2Y2ZnX3NwYWNlX3NhdmUsCisJLnBy
ZV9sb2FkID0gdmNmZ19zcGFjZV9sb2FkLAorCS5wb3N0X2xvYWQgPSBOVUxMLAorfTsKKworc3Ry
dWN0IGd2dF9taWdyYXRpb25fb3BlcmF0aW9uX3Qgdmd0dF9pbmZvX29wcyA9IHsKKwkucHJlX2Nv
cHkgPSBOVUxMLAorCS5wcmVfc2F2ZSA9IHZnZ3R0X3NhdmUsCisJLnByZV9sb2FkID0gdmdndHRf
bG9hZCwKKwkucG9zdF9sb2FkID0gTlVMTCwKK307CisKK3N0cnVjdCBndnRfbWlncmF0aW9uX29w
ZXJhdGlvbl90IGltYWdlX2hlYWRlcl9vcHMgPSB7CisJLnByZV9jb3B5ID0gTlVMTCwKKwkucHJl
X3NhdmUgPSBpbWFnZV9oZWFkZXJfc2F2ZSwKKwkucHJlX2xvYWQgPSBpbWFnZV9oZWFkZXJfbG9h
ZCwKKwkucG9zdF9sb2FkID0gTlVMTCwKK307CisKK3N0cnVjdCBndnRfbWlncmF0aW9uX29wZXJh
dGlvbl90IHdvcmtsb2FkX29wcyA9IHsKKwkucHJlX2NvcHkgPSBOVUxMLAorCS5wcmVfc2F2ZSA9
IHdvcmtsb2FkX3NhdmUsCisJLnByZV9sb2FkID0gd29ya2xvYWRfbG9hZCwKKwkucG9zdF9sb2Fk
ID0gTlVMTCwKK307CisKK3N0cnVjdCBndnRfbWlncmF0aW9uX29wZXJhdGlvbl90IHBwZ3R0X29w
cyA9IHsKKwkucHJlX2NvcHkgPSBOVUxMLAorCS5wcmVfc2F2ZSA9IHBwZ3R0X3NhdmUsCisJLnBy
ZV9sb2FkID0gcHBndHRfbG9hZCwKKwkucG9zdF9sb2FkID0gTlVMTCwKK307CisKK3N0cnVjdCBn
dnRfbWlncmF0aW9uX29wZXJhdGlvbl90IGV4ZWNsaXN0X29wcyA9IHsKKwkucHJlX2NvcHkgPSBO
VUxMLAorCS5wcmVfc2F2ZSA9IGV4ZWNsaXN0X3NhdmUsCisJLnByZV9sb2FkID0gZXhlY2xpc3Rf
bG9hZCwKKwkucG9zdF9sb2FkID0gTlVMTCwKK307CisKKy8qIGd2dF9kZXZpY2Vfb2Jqc1tdIGFy
ZSBsaXN0IG9mIGd2dF9taWdyYXRpb25fb2JqX3Qgb2JqcworICogRWFjaCBvYmogaGFzIGl0cyBv
cGVyYXRpb24gbWV0aG9kIHRvIHNhdmUgdG8gcWVtdSBpbWFnZQorICogYW5kIHJlc3RvcmUgZnJv
bSBxZW11IGltYWdlIGR1cmluZyB0aGUgbWlncmF0aW9uLgorICoKKyAqIGZvciBlYWNoIHNhdmVk
IGJqZWN0LCBpdCB3aWxsIGhhdmUgYSByZWdpb24gaGVhZGVyCisgKiBzdHJ1Y3QgZ3Z0X3JlZ2lv
bl90IHsKKyAqICAgcmVnaW9uX3R5cGU7CisgKiAgIHJlZ2lvbl9zaXplOworICogfQorICpfX19f
X19fX19fX19fX19fX18gIF9fX19fX19fX19fX19fX19fICAgX19fX19fX19fX19fX19fX19fCisg
Knx4NjQgKFNvdXJjZSkgICAgfCAgfGltYWdlIHJlZ2lvbiAgICB8ICB8eDY0IChUYXJnZXQpICAg
IHwKKyAqfF9fX19fX19fX19fX19fX198ICB8X19fX19fX19fX19fX19fX3wgIHxfX19fX19fX19f
X19fX19ffAorICp8ICAgIFJlZ2lvbiBBICAgIHwgIHwgICBSZWdpb24gQSAgICAgfCAgfCAgIFJl
Z2lvbiBBICAgICB8CisgKnwgICAgSGVhZGVyICAgICAgfCAgfCAgIG9mZnNldD0wICAgICB8ICB8
IGFsbG9jYXRlIGEgcGFnZXwKKyAqfCAgICBjb250ZW50ICAgICB8ICB8ICAgICAgICAgICAgICAg
IHwgIHwgY29weSBkYXRhIGhlcmUgfAorICp8LS0tLS0tLS0tLS0tLS0tLXwgIHwgICAgIC4uLiAg
ICAgICAgfCAgfC0tLS0tLS0tLS0tLS0tLS18CisgKnwgICAgUmVnaW9uIEIgICAgfCAgfCAgICAg
Li4uICAgICAgICB8ICB8ICAgUmVnaW9uIEIgICAgIHwKKyAqfCAgICBIZWFkZXIgICAgICB8ICB8
LS0tLS0tLS0tLS0tLS0tLXwgIHwgICAgICAgICAgICAgICAgfAorICp8ICAgIGNvbnRlbnQgICAg
ICAgIHwgICBSZWdpb24gQiAgICAgfCAgfCAgICAgICAgICAgICAgICB8CisgKnwtLS0tLS0tLS0t
LS0tLS0tfCAgfCAgIG9mZnNldD00MDk2ICB8ICB8LS0tLS0tLS0tLS0tLS0tLXwKKyAqICAgICAg
ICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgIHwKKyAqICAgICAgICAgICAgICAgICAgICB8
LS0tLS0tLS0tLS0tLS0tLXwKKyAqCisgKiBPbiB0aGUgdGFyZ2V0IHNpZGUsIGl0IHdpbGwgcGFy
c2VyIHRoZSBpbmNvbWluZyBkYXRhIGNvcHkKKyAqIGZyb20gUWVtdSBpbWFnZSwgYW5kIGFwcGx5
IGRpZmZlcmVuY2UgcmVzdG9yZSBoYW5kbGVycyBkZXBlbmRzCisgKiBvbiB0aGUgcmVnaW9uIHR5
cGUuCisgKi8KK3N0YXRpYyBzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCBndnRfZGV2aWNlX29i
anNbXSA9IHsKKwlNSUdSQVRJT05fVU5JVChzdHJ1Y3QgaW50ZWxfdmdwdSwKKwkJCUdWVF9NSUdS
QVRJT05fSEVBRCwKKwkJCXNpemVvZihzdHJ1Y3QgZ3Z0X2ltYWdlX2hlYWRlcl90KSwKKwkJCWlt
YWdlX2hlYWRlcl9vcHMpLAorCU1JR1JBVElPTl9VTklUKHN0cnVjdCBpbnRlbF92Z3B1LAorCQkJ
R1ZUX01JR1JBVElPTl9DRkdfU1BBQ0UsCisJCQlQQ0lfQ0ZHX1NQQUNFX0VYUF9TSVpFLAorCQkJ
dmNmZ19zcGFjZV9vcHMpLAorCU1JR1JBVElPTl9VTklUKHN0cnVjdCBpbnRlbF92Z3B1LAorCQkJ
R1ZUX01JR1JBVElPTl9TUkVHLAorCQkJR1ZUX01NSU9fU0laRSwgc1JlZ19vcHMpLAorCU1JR1JB
VElPTl9VTklUKHN0cnVjdCBpbnRlbF92Z3B1LAorCQkJR1ZUX01JR1JBVElPTl9WUkVHLAorCQkJ
R1ZUX01NSU9fU0laRSwgdlJlZ19vcHMpLAorCU1JR1JBVElPTl9VTklUKHN0cnVjdCBpbnRlbF92
Z3B1LAorCQkJR1ZUX01JR1JBVElPTl9HVFQsCisJCQkwLCB2Z3R0X2luZm9fb3BzKSwKKwlNSUdS
QVRJT05fVU5JVChzdHJ1Y3QgaW50ZWxfdmdwdSwKKwkJCUdWVF9NSUdSQVRJT05fUFBHVFQsCisJ
CQkwLCBwcGd0dF9vcHMpLAorCU1JR1JBVElPTl9VTklUKHN0cnVjdCBpbnRlbF92Z3B1LAorCQkJ
R1ZUX01JR1JBVElPTl9XT1JLTE9BRCwKKwkJCTAsIHdvcmtsb2FkX29wcyksCisJTUlHUkFUSU9O
X1VOSVQoc3RydWN0IGludGVsX3ZncHUsCisJCQlHVlRfTUlHUkFUSU9OX0VYRUNMSVNULAorCQkJ
MCwgZXhlY2xpc3Rfb3BzKSwKKwlNSUdSQVRJT05fRU5ELAorfTsKKworc3RhdGljIGlubGluZSB2
b2lkCit1cGRhdGVfaW1hZ2VfcmVnaW9uX3N0YXJ0X3BvcyhzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9v
YmpfdCAqb2JqLCBpbnQgcG9zKQoreworCW9iai0+b2Zmc2V0ID0gcG9zOworfQorCitzdGF0aWMg
aW5saW5lIHZvaWQKK3VwZGF0ZV9pbWFnZV9yZWdpb25fYmFzZShzdHJ1Y3QgZ3Z0X21pZ3JhdGlv
bl9vYmpfdCAqb2JqLCB2b2lkICpiYXNlKQoreworCW9iai0+aW1nID0gYmFzZTsKK30KKworc3Rh
dGljIGlubGluZSB2b2lkCit1cGRhdGVfc3RhdHVzX3JlZ2lvbl9iYXNlKHN0cnVjdCBndnRfbWln
cmF0aW9uX29ial90ICpvYmosIHZvaWQgKmJhc2UpCit7CisJb2JqLT52Z3B1ID0gYmFzZTsKK30K
Kworc3RhdGljIGlubGluZSBzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCAqCitmaW5kX21pZ3Jh
dGlvbl9vYmooZW51bSBndnRfbWlncmF0aW9uX3R5cGVfdCB0eXBlKQoreworCXN0cnVjdCBndnRf
bWlncmF0aW9uX29ial90ICpvYmo7CisKKwlmb3IgKG9iaiA9IGd2dF9kZXZpY2Vfb2JqczsKKwkJ
b2JqLT5yZWdpb24udHlwZSAhPSBHVlRfTUlHUkFUSU9OX05PTkU7IG9iaisrKQorCQlpZiAob2Jq
LT5yZWdpb24udHlwZSA9PSB0eXBlKQorCQkJcmV0dXJuIG9iajsKKwlyZXR1cm4gTlVMTDsKK30K
Kworc3RhdGljIGludCBpbWFnZV9oZWFkZXJfc2F2ZShjb25zdCBzdHJ1Y3QgZ3Z0X21pZ3JhdGlv
bl9vYmpfdCAqb2JqKQoreworCXN0cnVjdCBndnRfcmVnaW9uX3QgcmVnaW9uOworCXN0cnVjdCBn
dnRfaW1hZ2VfaGVhZGVyX3QgaGVhZGVyOworCisJcmVnaW9uLnR5cGUgPSBHVlRfTUlHUkFUSU9O
X0hFQUQ7CisJcmVnaW9uLnNpemUgPSBzaXplb2Yoc3RydWN0IGd2dF9pbWFnZV9oZWFkZXJfdCk7
CisJbWVtY3B5KG9iai0+aW1nLCAmcmVnaW9uLCBzaXplb2Yoc3RydWN0IGd2dF9yZWdpb25fdCkp
OworCisJaGVhZGVyLnZlcnNpb24gPSBHVlRfTUlHUkFUSU9OX1ZFUlNJT047CisJaGVhZGVyLmRh
dGFfc2l6ZSA9IG9iai0+b2Zmc2V0OworCWhlYWRlci5jcmNfY2hlY2sgPSAwOyAvKiBDUkMgY2hl
Y2sgc2tpcHBlZCBmb3Igbm93Ki8KKworCW1lbWNweShvYmotPmltZyArIHNpemVvZihzdHJ1Y3Qg
Z3Z0X3JlZ2lvbl90KSwgJmhlYWRlciwKKwkJCXNpemVvZihzdHJ1Y3QgZ3Z0X2ltYWdlX2hlYWRl
cl90KSk7CisKKwlyZXR1cm4gc2l6ZW9mKHN0cnVjdCBndnRfcmVnaW9uX3QpICsgc2l6ZW9mKHN0
cnVjdCBndnRfaW1hZ2VfaGVhZGVyX3QpOworfQorCitzdGF0aWMgaW50IGltYWdlX2hlYWRlcl9s
b2FkKGNvbnN0IHN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpvYmosIHUzMiBzaXplKQorewor
CXN0cnVjdCBndnRfaW1hZ2VfaGVhZGVyX3QgaGVhZGVyOworCisJaWYgKHVubGlrZWx5KHNpemUg
IT0gc2l6ZW9mKHN0cnVjdCBndnRfaW1hZ2VfaGVhZGVyX3QpKSkgeworCQlndnRfZXJyKCJtaWdy
YXRpb24gb2JqIHNpemUgaXNuJ3QgbWF0Y2ggYmV0d2VlbiB0YXJnZXQgYW5kIGltYWdlISBtZW1z
aXplPSVkIGltZ3NpemU9JWRcbiIsCisJCW9iai0+cmVnaW9uLnNpemUsCisJCXNpemUpOworCQly
ZXR1cm4gSU5WOworCX0KKworCW1lbWNweSgmaGVhZGVyLCBvYmotPmltZyArIG9iai0+b2Zmc2V0
LAorCQlzaXplb2Yoc3RydWN0IGd2dF9pbWFnZV9oZWFkZXJfdCkpOworCisJcmV0dXJuIGhlYWRl
ci5kYXRhX3NpemU7Cit9CisKK3N0YXRpYyBpbnQgdmNmZ19zcGFjZV9zYXZlKGNvbnN0IHN0cnVj
dCBndnRfbWlncmF0aW9uX29ial90ICpvYmopCit7CisJc3RydWN0IGludGVsX3ZncHUgKnZncHUg
PSAoc3RydWN0IGludGVsX3ZncHUgKikgb2JqLT52Z3B1OworCWludCBuX3RyYW5zZmVyID0gSU5W
OworCXZvaWQgKnNyYyA9IHZncHUtPmNmZ19zcGFjZS52aXJ0dWFsX2NmZ19zcGFjZTsKKwl2b2lk
ICpkZXMgPSBvYmotPmltZyArIG9iai0+b2Zmc2V0OworCisJbWVtY3B5KGRlcywgJm9iai0+cmVn
aW9uLCBzaXplb2Yoc3RydWN0IGd2dF9yZWdpb25fdCkpOworCisJZGVzICs9IHNpemVvZihzdHJ1
Y3QgZ3Z0X3JlZ2lvbl90KTsKKwluX3RyYW5zZmVyID0gb2JqLT5yZWdpb24uc2l6ZTsKKworCW1l
bWNweShkZXMsIHNyYywgbl90cmFuc2Zlcik7CisJcmV0dXJuIHNpemVvZihzdHJ1Y3QgZ3Z0X3Jl
Z2lvbl90KSArIG5fdHJhbnNmZXI7Cit9CisKK3N0YXRpYyBpbnQgdmNmZ19zcGFjZV9sb2FkKGNv
bnN0IHN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpvYmosIHUzMiBzaXplKQoreworCXN0cnVj
dCBpbnRlbF92Z3B1ICp2Z3B1ID0gKHN0cnVjdCBpbnRlbF92Z3B1ICopIG9iai0+dmdwdTsKKwl2
b2lkICpkZXN0ID0gdmdwdS0+Y2ZnX3NwYWNlLnZpcnR1YWxfY2ZnX3NwYWNlOworCWludCBuX3Ry
YW5zZmVyID0gSU5WOworCisJaWYgKHVubGlrZWx5KHNpemUgIT0gb2JqLT5yZWdpb24uc2l6ZSkp
IHsKKwkJZ3Z0X2VycigibWlncmF0aW9uIG9iaiBzaXplIGlzbid0IG1hdGNoIGJldHdlZW4gdGFy
Z2V0IGFuZCBpbWFnZSEgbWVtc2l6ZT0lZCBpbWdzaXplPSVkXG4iLAorCQlvYmotPnJlZ2lvbi5z
aXplLAorCQlzaXplKTsKKwl9IGVsc2UgeworCQluX3RyYW5zZmVyID0gb2JqLT5yZWdpb24uc2l6
ZTsKKwkJbWVtY3B5KGRlc3QsIG9iai0+aW1nICsgb2JqLT5vZmZzZXQsIG5fdHJhbnNmZXIpOwor
CX0KKworCXJldHVybiBuX3RyYW5zZmVyOworfQorCitzdGF0aWMgaW50IHNyZWdfc2F2ZShjb25z
dCBzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCAqb2JqKQoreworCXN0cnVjdCBpbnRlbF92Z3B1
ICp2Z3B1ID0gKHN0cnVjdCBpbnRlbF92Z3B1ICopIG9iai0+dmdwdTsKKwlpbnQgbl90cmFuc2Zl
ciA9IElOVjsKKwl2b2lkICpzcmMgPSB2Z3B1LT5tbWlvLnNyZWc7CisJdm9pZCAqZGVzID0gb2Jq
LT5pbWcgKyBvYmotPm9mZnNldDsKKworCW1lbWNweShkZXMsICZvYmotPnJlZ2lvbiwgc2l6ZW9m
KHN0cnVjdCBndnRfcmVnaW9uX3QpKTsKKworCWRlcyArPSBzaXplb2Yoc3RydWN0IGd2dF9yZWdp
b25fdCk7CisJbl90cmFuc2ZlciA9IG9iai0+cmVnaW9uLnNpemU7CisKKwltZW1jcHkoZGVzLCBz
cmMsIG5fdHJhbnNmZXIpOworCXJldHVybiBzaXplb2Yoc3RydWN0IGd2dF9yZWdpb25fdCkgKyBu
X3RyYW5zZmVyOworfQorCitzdGF0aWMgaW50IHNyZWdfbG9hZChjb25zdCBzdHJ1Y3QgZ3Z0X21p
Z3JhdGlvbl9vYmpfdCAqb2JqLCB1MzIgc2l6ZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdw
dSA9IChzdHJ1Y3QgaW50ZWxfdmdwdSAqKSBvYmotPnZncHU7CisJdm9pZCAqZGVzdCA9IHZncHUt
Pm1taW8uc3JlZzsKKwlpbnQgbl90cmFuc2ZlciA9IElOVjsKKworCWlmICh1bmxpa2VseShzaXpl
ICE9IG9iai0+cmVnaW9uLnNpemUpKSB7CisJCWd2dF9lcnIoIm1pZ3JhdGlvbiBvYmogc2l6ZSBp
c24ndCBtYXRjaCBiZXR3ZWVuIHRhcmdldCBhbmQgaW1hZ2UhIG1lbXNpemU9JWQgaW1nc2l6ZT0l
ZFxuIiwKKwkJb2JqLT5yZWdpb24uc2l6ZSwKKwkJc2l6ZSk7CisJfSBlbHNlIHsKKwkJbl90cmFu
c2ZlciA9IG9iai0+cmVnaW9uLnNpemU7CisJCW1lbWNweShkZXN0LCBvYmotPmltZyArIG9iai0+
b2Zmc2V0LCBuX3RyYW5zZmVyKTsKKwl9CisKKwlyZXR1cm4gbl90cmFuc2ZlcjsKK30KKworc3Rh
dGljIGludCBwcGd0dF9zYXZlKGNvbnN0IHN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpvYmop
Cit7CisJc3RydWN0IGludGVsX3ZncHUgKnZncHUgPSAoc3RydWN0IGludGVsX3ZncHUgKikgb2Jq
LT52Z3B1OworCXN0cnVjdCBsaXN0X2hlYWQgKnBvczsKKwlzdHJ1Y3QgaW50ZWxfdmdwdV9tbSAq
bW07CisJc3RydWN0IGd2dF9wcGd0dF9lbnRyeV90IGVudHJ5OworCXN0cnVjdCBndnRfcmVnaW9u
X3QgcmVnaW9uOworCWludCBudW0gPSAwOworCXUzMiBzeiA9IHNpemVvZihzdHJ1Y3QgZ3Z0X3Bw
Z3R0X2VudHJ5X3QpOworCXZvaWQgKmRlcyA9IG9iai0+aW1nICsgb2JqLT5vZmZzZXQ7CisKKwls
aXN0X2Zvcl9lYWNoKHBvcywgJnZncHUtPmd0dC5wcGd0dF9tbV9saXN0X2hlYWQpIHsKKwkJbW0g
PSBjb250YWluZXJfb2YocG9zLCBzdHJ1Y3QgaW50ZWxfdmdwdV9tbSwgcHBndHRfbW0ubGlzdCk7
CisJCWlmIChtbS0+dHlwZSAhPSBJTlRFTF9HVlRfTU1fUFBHVFQpCisJCQljb250aW51ZTsKKwor
CQllbnRyeS5wYWdlX3RhYmxlX2xldmVsID0gbW0tPnBwZ3R0X21tLnJvb3RfZW50cnlfdHlwZTsK
KwkJbWVtY3B5KGVudHJ5LnBkcCwgbW0tPnBwZ3R0X21tLmd1ZXN0X3BkcHMsIDMyKTsKKworCQlt
ZW1jcHkoZGVzICsgc2l6ZW9mKHN0cnVjdCBndnRfcmVnaW9uX3QpICsgKG51bSAqIHN6KSwKKwkJ
CSZlbnRyeSwgc3opOworCQludW0rKzsKKwl9CisKKwlyZWdpb24udHlwZSA9IEdWVF9NSUdSQVRJ
T05fUFBHVFQ7CisJcmVnaW9uLnNpemUgPSBudW0gKiBzejsKKwltZW1jcHkoZGVzLCAmcmVnaW9u
LCBzaXplb2Yoc3RydWN0IGd2dF9yZWdpb25fdCkpOworCisJcmV0dXJuIHNpemVvZihzdHJ1Y3Qg
Z3Z0X3JlZ2lvbl90KSArIHJlZ2lvbi5zaXplOworfQorCitzdGF0aWMgaW50IHBwZ3R0X2xvYWQo
Y29uc3Qgc3RydWN0IGd2dF9taWdyYXRpb25fb2JqX3QgKm9iaiwgdTMyIHNpemUpCit7CisJc3Ry
dWN0IGludGVsX3ZncHUgKnZncHUgPSAoc3RydWN0IGludGVsX3ZncHUgKikgb2JqLT52Z3B1Owor
CWludCBuX3RyYW5zZmVyID0gSU5WOworCXN0cnVjdCBndnRfcHBndHRfZW50cnlfdCBlbnRyeTsK
KwlzdHJ1Y3QgaW50ZWxfdmdwdV9tbSAqbW07CisJdm9pZCAqc3JjID0gb2JqLT5pbWcgKyBvYmot
Pm9mZnNldDsKKwlpbnQgaTsKKwl1MzIgc3ogPSBzaXplb2Yoc3RydWN0IGd2dF9wcGd0dF9lbnRy
eV90KTsKKworCWlmIChzaXplID09IDApCisJCXJldHVybiBzaXplOworCisJaWYgKHVubGlrZWx5
KHNpemUgJSBzeikgIT0gMCkgeworCQlndnRfZXJyKCJtaWdyYXRpb24gb2JqIHNpemUgaXNuJ3Qg
bWF0Y2ggYmV0d2VlbiB0YXJnZXQgYW5kIGltYWdlISBtZW1zaXplPSVkIGltZ3NpemU9JWRcbiIs
CisJCW9iai0+cmVnaW9uLnNpemUsCisJCXNpemUpOworCQlyZXR1cm4gbl90cmFuc2ZlcjsKKwl9
CisKKwlmb3IgKGkgPSAwOyBpIDwgc2l6ZSAvIHN6OyBpKyspIHsKKwkJbWVtY3B5KCZlbnRyeSwg
c3JjICsgKGkgKiBzeiksIHN6KTsKKwkJbW0gPSBpbnRlbF92Z3B1X2NyZWF0ZV9wcGd0dF9tbSh2
Z3B1LCBlbnRyeS5wYWdlX3RhYmxlX2xldmVsLAorCQkJCQkJZW50cnkucGRwKTsKKwkJaWYgKElT
X0VSUihtbSkpIHsKKwkJCWd2dF92Z3B1X2VycigiZmFpbCB0byBjcmVhdGUgbW0gb2JqZWN0Llxu
Iik7CisJCQlyZXR1cm4gbl90cmFuc2ZlcjsKKwkJfQorCX0KKworCW5fdHJhbnNmZXIgPSBzaXpl
OworCisJcmV0dXJuIG5fdHJhbnNmZXI7Cit9CisKK3N0YXRpYyBpbnQgdnJlZ19zYXZlKGNvbnN0
IHN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpvYmopCit7CisJc3RydWN0IGludGVsX3ZncHUg
KnZncHUgPSAoc3RydWN0IGludGVsX3ZncHUgKikgb2JqLT52Z3B1OworCWludCBuX3RyYW5zZmVy
ID0gSU5WOworCXZvaWQgKnNyYyA9IHZncHUtPm1taW8udnJlZzsKKwl2b2lkICpkZXMgPSBvYmot
PmltZyArIG9iai0+b2Zmc2V0OworCisJbWVtY3B5KGRlcywgJm9iai0+cmVnaW9uLCBzaXplb2Yo
c3RydWN0IGd2dF9yZWdpb25fdCkpOworCisJZGVzICs9IHNpemVvZihzdHJ1Y3QgZ3Z0X3JlZ2lv
bl90KTsKKwluX3RyYW5zZmVyID0gb2JqLT5yZWdpb24uc2l6ZTsKKworCW1lbWNweShkZXMsIHNy
Yywgbl90cmFuc2Zlcik7CisJcmV0dXJuIHNpemVvZihzdHJ1Y3QgZ3Z0X3JlZ2lvbl90KSArIG5f
dHJhbnNmZXI7Cit9CisKK3N0YXRpYyBpbnQgdnJlZ19sb2FkKGNvbnN0IHN0cnVjdCBndnRfbWln
cmF0aW9uX29ial90ICpvYmosIHUzMiBzaXplKQoreworCXN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1
ID0gKHN0cnVjdCBpbnRlbF92Z3B1ICopIG9iai0+dmdwdTsKKwl2b2lkICpkZXN0ID0gdmdwdS0+
bW1pby52cmVnOworCWludCBuX3RyYW5zZmVyID0gSU5WOworCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7CisJc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCWVudW0gcGlwZSBwaXBl
OworCisJaWYgKHVubGlrZWx5KHNpemUgIT0gb2JqLT5yZWdpb24uc2l6ZSkpIHsKKwkJZ3Z0X2Vy
cigibWlncmF0aW9uIG9iaiBzaXplIGlzbid0IG1hdGNoIGJldHdlZW4gdGFyZ2V0IGFuZCBpbWFn
ZSEgbWVtc2l6ZT0lZCBpbWdzaXplPSVkXG4iLAorCQlvYmotPnJlZ2lvbi5zaXplLAorCQlzaXpl
KTsKKwkJZ290byBleGl0OworCX0gZWxzZSB7CisJCW5fdHJhbnNmZXIgPSBvYmotPnJlZ2lvbi5z
aXplOworCQltZW1jcHkoZGVzdCwgb2JqLT5pbWcgKyBvYmotPm9mZnNldCwgbl90cmFuc2Zlcik7
CisJfQorCisJLy9yZXN0b3JlIHZibGFuayBlbXVsYXRpb24KKwlmb3IgKHBpcGUgPSBQSVBFX0E7
IHBpcGUgPCBJOTE1X01BWF9QSVBFUzsgKytwaXBlKQorCQlNSUdfVlJFR19SRVNUT1JFKHZncHUs
IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFBJUEVDT05GKHBpcGUpKSk7CisKKwkvL3Jlc3RvcmUgcmlu
ZyBtb2RlIHJlZ2lzdGVyIGZvciBleGVjbGlzdCBpbml0CisJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZGV2X3ByaXYsIGlkKQorCQlNSUdfVlJFR19SRVNUT1JFKHZncHUsCisJCQkJaTkxNV9tbWlv
X3JlZ19vZmZzZXQoUklOR19NT0RFX0dFTjcoZW5naW5lKSkpOworCisJZm9yX2VhY2hfZW5naW5l
KGVuZ2luZSwgZGV2X3ByaXYsIGlkKQorCQlNSUdfVlJFR19SRVNUT1JFKHZncHUsCisJCQlpOTE1
X21taW9fcmVnX29mZnNldChSSU5HX0hXU19QR0EoZW5naW5lLT5tbWlvX2Jhc2UpKSk7CisKKwlt
ZW1jcHkoZGVzdCwgb2JqLT5pbWcgKyBvYmotPm9mZnNldCwgbl90cmFuc2Zlcik7CitleGl0Ogor
CXJldHVybiBuX3RyYW5zZmVyOworfQorCitzdGF0aWMgaW50IGV4ZWNsaXN0X3NhdmUoY29uc3Qg
c3RydWN0IGd2dF9taWdyYXRpb25fb2JqX3QgKm9iaikKK3sKKwlzdHJ1Y3QgaW50ZWxfdmdwdSAq
dmdwdSA9IChzdHJ1Y3QgaW50ZWxfdmdwdSAqKSBvYmotPnZncHU7CisJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKKwlzdHJ1Y3QgZ3Z0X3Jl
Z2lvbl90IHJlZ2lvbjsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJdTMyIHN6
ID0gc2l6ZW9mKHN0cnVjdCBpbnRlbF92Z3B1X2Vsc3BfZHdvcmRzKTsKKwl1bnNpZ25lZCBpbnQg
aTsKKworCXZvaWQgKmRlcyA9IG9iai0+aW1nICsgb2JqLT5vZmZzZXQ7CisKKwlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaSkgeworCQltZW1jcHkoZGVzICsgc2l6ZW9mKHN0cnVj
dCBndnRfcmVnaW9uX3QpICsgKGkgKiBzeiksCisJCQkmdmdwdS0+c3VibWlzc2lvbi5leGVjbGlz
dFtlbmdpbmUtPmlkXS5lbHNwX2R3b3Jkcywgc3opOworCX0KKworCXJlZ2lvbi50eXBlID0gR1ZU
X01JR1JBVElPTl9FWEVDTElTVDsKKwlyZWdpb24uc2l6ZSA9IGkgKiBzejsKKwltZW1jcHkoZGVz
LCAmcmVnaW9uLCBzaXplb2Yoc3RydWN0IGd2dF9yZWdpb25fdCkpOworCXJldHVybiBzaXplb2Yo
c3RydWN0IGd2dF9yZWdpb25fdCkgKyByZWdpb24uc2l6ZTsKK30KKworc3RhdGljIGludCBleGVj
bGlzdF9sb2FkKGNvbnN0IHN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpvYmosIHUzMiBzaXpl
KQoreworCXN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1ID0gKHN0cnVjdCBpbnRlbF92Z3B1ICopIG9i
ai0+dmdwdTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQt
PmRldl9wcml2OworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwl1MzIgc3ogPSBz
aXplb2Yoc3RydWN0IGludGVsX3ZncHVfZWxzcF9kd29yZHMpOworCXZvaWQgKnNyYyA9IG9iai0+
aW1nICsgb2JqLT5vZmZzZXQ7CisJaW50IG5fdHJhbnNmZXIgPSBJTlY7CisJdW5zaWduZWQgaW50
IGk7CisKKwlpZiAoc2l6ZSA9PSAwKQorCQlyZXR1cm4gc2l6ZTsKKworCWlmICh1bmxpa2VseShz
aXplICUgc3opICE9IDApIHsKKwkJZ3Z0X2VycigibWlncmF0aW9uIG9iaiBzaXplIGlzbid0IG1h
dGNoIGJldHdlZW4gdGFyZ2V0IGFuZCBpbWFnZSEgbWVtc2l6ZT0lZCBpbWdzaXplPSVkXG4iLAor
CQlvYmotPnJlZ2lvbi5zaXplLAorCQlzaXplKTsKKwkJcmV0dXJuIG5fdHJhbnNmZXI7CisJfQor
CisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGkpIHsKKwkJbWVtY3B5KCZ2Z3B1
LT5zdWJtaXNzaW9uLmV4ZWNsaXN0W2VuZ2luZS0+aWRdLmVsc3BfZHdvcmRzLAorCQkJc3JjICsg
KGkgKiBzeiksIHN6KTsKKwl9CisKKwluX3RyYW5zZmVyID0gc2l6ZTsKKworCXJldHVybiBuX3Ry
YW5zZmVyOworfQorCitzdGF0aWMgaW50IHdvcmtsb2FkX3NhdmUoY29uc3Qgc3RydWN0IGd2dF9t
aWdyYXRpb25fb2JqX3QgKm9iaikKK3sKKwlzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSA9IChzdHJ1
Y3QgaW50ZWxfdmdwdSAqKSBvYmotPnZncHU7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKKwlzdHJ1Y3QgZ3Z0X3JlZ2lvbl90IHJlZ2lv
bjsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJc3RydWN0IGludGVsX3ZncHVf
d29ya2xvYWQgKnBvcywgKm47CisJdW5zaWduZWQgaW50IGk7CisJc3RydWN0IGd2dF9wZW5kaW5n
X3dvcmtsb2FkX3Qgd29ya2xvYWQ7CisJdm9pZCAqZGVzID0gb2JqLT5pbWcgKyBvYmotPm9mZnNl
dDsKKwl1bnNpZ25lZCBpbnQgbnVtID0gMDsKKwl1MzIgc3ogPSBzaXplb2Yoc3RydWN0IGd2dF9w
ZW5kaW5nX3dvcmtsb2FkX3QpOworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYs
IGkpIHsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKHBvcywgbiwKKwkJCSZ2Z3B1LT5zdWJt
aXNzaW9uLndvcmtsb2FkX3FfaGVhZFtlbmdpbmUtPmlkXSwgbGlzdCkgeworCQkJd29ya2xvYWQu
cmluZ19pZCA9IHBvcy0+cmluZ19pZDsKKwkJCXdvcmtsb2FkLmN0eF9kZXNjID0gcG9zLT5jdHhf
ZGVzYzsKKwkJCXdvcmtsb2FkLmVtdWxhdGVfc2NoZWR1bGVfaW4gPSBwb3MtPmVtdWxhdGVfc2No
ZWR1bGVfaW47CisJCQl3b3JrbG9hZC5lbHNwX2R3b3JkcyA9IHBvcy0+ZWxzcF9kd29yZHM7CisJ
CQlsaXN0X2RlbF9pbml0KCZwb3MtPmxpc3QpOworCQkJaW50ZWxfdmdwdV9kZXN0cm95X3dvcmts
b2FkKHBvcyk7CisJCQltZW1jcHkoZGVzICsgc2l6ZW9mKHN0cnVjdCBndnRfcmVnaW9uX3QpICsg
KG51bSAqIHN6KSwKKwkJCQkmd29ya2xvYWQsIHN6KTsKKwkJCW51bSsrOworCQl9CisJfQorCisJ
cmVnaW9uLnR5cGUgPSBHVlRfTUlHUkFUSU9OX1dPUktMT0FEOworCXJlZ2lvbi5zaXplID0gbnVt
ICogc3o7CisJbWVtY3B5KGRlcywgJnJlZ2lvbiwgc2l6ZW9mKHN0cnVjdCBndnRfcmVnaW9uX3Qp
KTsKKworCXJldHVybiBzaXplb2Yoc3RydWN0IGd2dF9yZWdpb25fdCkgKyByZWdpb24uc2l6ZTsK
K30KKworc3RhdGljIGludCB3b3JrbG9hZF9sb2FkKGNvbnN0IHN0cnVjdCBndnRfbWlncmF0aW9u
X29ial90ICpvYmosIHUzMiBzaXplKQoreworCXN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1ID0gKHN0
cnVjdCBpbnRlbF92Z3B1ICopIG9iai0+dmdwdTsKKwlpbnQgbl90cmFuc2ZlciA9IElOVjsKKwlz
dHJ1Y3QgZ3Z0X3BlbmRpbmdfd29ya2xvYWRfdCB3b3JrbG9hZDsKKwl2b2lkICpzcmMgPSBvYmot
PmltZyArIG9iai0+b2Zmc2V0OworCXUzMiBzeiA9IHNpemVvZihzdHJ1Y3QgZ3Z0X3BlbmRpbmdf
d29ya2xvYWRfdCk7CisJaW50IGk7CisKKwlpZiAoc2l6ZSA9PSAwKQorCQlyZXR1cm4gc2l6ZTsK
KworCWlmICh1bmxpa2VseShzaXplICUgc3opICE9IDApIHsKKwkJZ3Z0X2VycigibWlncmF0aW9u
IG9iaiBzaXplIGlzbid0IG1hdGNoIGJldHdlZW4gdGFyZ2V0IGFuZCBpbWFnZSEgbWVtc2l6ZT0l
ZCBpbWdzaXplPSVkXG4iLAorCQlvYmotPnJlZ2lvbi5zaXplLAorCQlzaXplKTsKKwkJcmV0dXJu
IG5fdHJhbnNmZXI7CisJfQorCWZvciAoaSA9IDA7IGkgPCBzaXplIC8gc3o7IGkrKykgeworCQlz
dHJ1Y3QgaW50ZWxfdmdwdV9leGVjbGlzdCAqZXhlY2xpc3Q7CisKKwkJZXhlY2xpc3QgPSAmdmdw
dS0+c3VibWlzc2lvbi5leGVjbGlzdFt3b3JrbG9hZC5yaW5nX2lkXTsKKwkJbWVtY3B5KCZ3b3Jr
bG9hZCwgc3JjICsgKGkgKiBzeiksIHN6KTsKKwkJaWYgKHdvcmtsb2FkLmVtdWxhdGVfc2NoZWR1
bGVfaW4pIHsKKwkJCWV4ZWNsaXN0LT5lbHNwX2R3b3JkcyA9IHdvcmtsb2FkLmVsc3BfZHdvcmRz
OworCQkJZXhlY2xpc3QtPmVsc3BfZHdvcmRzLmluZGV4ID0gMDsKKwkJfQorCQlzdWJtaXRfY29u
dGV4dCh2Z3B1LCB3b3JrbG9hZC5yaW5nX2lkLAorCQkJJndvcmtsb2FkLmN0eF9kZXNjLCB3b3Jr
bG9hZC5lbXVsYXRlX3NjaGVkdWxlX2luKTsKKwl9CisKKwluX3RyYW5zZmVyID0gc2l6ZTsKKwor
CXJldHVybiBuX3RyYW5zZmVyOworfQorCitzdGF0aWMgaW50CittaWdfZ2d0dF9zYXZlX3Jlc3Rv
cmUoc3RydWN0IGludGVsX3ZncHVfbW0gKmdndHRfbW0sCisJCXZvaWQgKmRhdGEsIHU2NCBnbV9v
ZmZzZXQsCisJCXU2NCBnbV9zeiwKKwkJYm9vbCBzYXZlX3RvX2ltYWdlKQoreworCXN0cnVjdCBp
bnRlbF92Z3B1ICp2Z3B1ID0gZ2d0dF9tbS0+dmdwdTsKKwlzdHJ1Y3QgaW50ZWxfZ3Z0X2d0dF9n
bWFfb3BzICpnbWFfb3BzID0gdmdwdS0+Z3Z0LT5ndHQuZ21hX29wczsKKworCXZvaWQgKnB0YWJs
ZTsKKwlpbnQgc3o7CisJaW50IHNoaWZ0ID0gdmdwdS0+Z3Z0LT5kZXZpY2VfaW5mby5ndHRfZW50
cnlfc2l6ZV9zaGlmdDsKKworCXB0YWJsZSA9IGdndHRfbW0tPmdndHRfbW0udmlydHVhbF9nZ3R0
ICsKKwkgICAgKGdtYV9vcHMtPmdtYV90b19nZ3R0X3B0ZV9pbmRleChnbV9vZmZzZXQpIDw8IHNo
aWZ0KTsKKwlzeiA9IChnbV9zeiA+PiBJOTE1X0dUVF9QQUdFX1NISUZUKSA8PCBzaGlmdDsKKwor
CWlmIChzYXZlX3RvX2ltYWdlKQorCQltZW1jcHkoZGF0YSwgcHRhYmxlLCBzeik7CisJZWxzZQor
CQltZW1jcHkocHRhYmxlLCBkYXRhLCBzeik7CisKKwlyZXR1cm4gc3o7Cit9CisKK3N0YXRpYyBp
bnQgdmdndHRfc2F2ZShjb25zdCBzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCAqb2JqKQorewor
CWludCByZXQgPSBJTlY7CisJc3RydWN0IGludGVsX3ZncHUgKnZncHUgPSAoc3RydWN0IGludGVs
X3ZncHUgKikgb2JqLT52Z3B1OworCXN0cnVjdCBpbnRlbF92Z3B1X21tICpnZ3R0X21tID0gdmdw
dS0+Z3R0LmdndHRfbW07CisJdm9pZCAqZGVzID0gb2JqLT5pbWcgKyBvYmotPm9mZnNldDsKKwlz
dHJ1Y3QgZ3Z0X3JlZ2lvbl90IHJlZ2lvbjsKKwlpbnQgc3o7CisKKwl1NjQgYXBlcnR1cmVfb2Zm
c2V0ID0gdmdwdV9ndWVzdF9hcGVydHVyZV9vZmZzZXQodmdwdSk7CisJdTY0IGFwZXJ0dXJlX3N6
ID0gdmdwdV9hcGVydHVyZV9zeih2Z3B1KTsKKwl1NjQgaGlkZGVuX2dtX29mZnNldCA9IHZncHVf
Z3Vlc3RfaGlkZGVuX29mZnNldCh2Z3B1KTsKKwl1NjQgaGlkZGVuX2dtX3N6ID0gdmdwdV9oaWRk
ZW5fc3oodmdwdSk7CisKKwlkZXMgKz0gc2l6ZW9mKHN0cnVjdCBndnRfcmVnaW9uX3QpOworCisJ
LypUT0RPOjUxMk1CIEdUVCB0YWtlcyB0b3RhbCAxMDI0S0IgcGFnZSB0YWJsZSBzaXplLCBvcHRp
bWl6YXRpb24gaGVyZSovCisKKwlndnRfZGJnX2NvcmUoIkd1ZXN0IGFwZXJ0dXJlPTB4JWxseCAo
SFc6IDB4JWxseCksR3Vlc3QgSGlkZGVuPTB4JWxseCAoSFc6MHglbGx4KVxuIiwKKwkJYXBlcnR1
cmVfb2Zmc2V0LCB2Z3B1X2FwZXJ0dXJlX29mZnNldCh2Z3B1KSwKKwkJaGlkZGVuX2dtX29mZnNl
dCwgdmdwdV9oaWRkZW5fb2Zmc2V0KHZncHUpKTsKKworCS8qVE9ETzp0byBiZSBmaXhlZCBhZnRl
ciByZW1vdmFsIG9mIGFkZHJlc3MgYmFsbG9vbmluZyAqLworCXJldCA9IDA7CisKKwkvKiBhcGVy
dHVyZSAqLworCXN6ID0gbWlnX2dndHRfc2F2ZV9yZXN0b3JlKGdndHRfbW0sIGRlcywKKwkJYXBl
cnR1cmVfb2Zmc2V0LCBhcGVydHVyZV9zeiwgdHJ1ZSk7CisJZGVzICs9IHN6OworCXJldCArPSBz
ejsKKworCS8qIGhpZGRlbiBnbSAqLworCXN6ID0gbWlnX2dndHRfc2F2ZV9yZXN0b3JlKGdndHRf
bW0sIGRlcywKKwkJaGlkZGVuX2dtX29mZnNldCwgaGlkZGVuX2dtX3N6LCB0cnVlKTsKKwlkZXMg
Kz0gc3o7CisJcmV0ICs9IHN6OworCisJLyogU2F2ZSB0aGUgdG90YWwgc2l6ZSBvZiB0aGlzIHNl
c3Npb24gKi8KKwlyZWdpb24udHlwZSA9IEdWVF9NSUdSQVRJT05fR1RUOworCXJlZ2lvbi5zaXpl
ID0gcmV0OworCW1lbWNweShvYmotPmltZyArIG9iai0+b2Zmc2V0LCAmcmVnaW9uLCBzaXplb2Yo
c3RydWN0IGd2dF9yZWdpb25fdCkpOworCisJcmV0ICs9IHNpemVvZihzdHJ1Y3QgZ3Z0X3JlZ2lv
bl90KTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgdmdndHRfbG9hZChjb25zdCBz
dHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCAqb2JqLCB1MzIgc2l6ZSkKK3sKKwlpbnQgcmV0Owor
CXUzMiBnZ3R0X2luZGV4OworCXZvaWQgKnNyYzsKKwlpbnQgc3o7CisKKwlzdHJ1Y3QgaW50ZWxf
dmdwdSAqdmdwdSA9IChzdHJ1Y3QgaW50ZWxfdmdwdSAqKSBvYmotPnZncHU7CisJc3RydWN0IGlu
dGVsX3ZncHVfbW0gKmdndHRfbW0gPSB2Z3B1LT5ndHQuZ2d0dF9tbTsKKworCWludCBzaGlmdCA9
IHZncHUtPmd2dC0+ZGV2aWNlX2luZm8uZ3R0X2VudHJ5X3NpemVfc2hpZnQ7CisKKwkvKiBvZmZz
ZXQgdG8gYmFyMSBiZWdpbm5pbmcgKi8KKwl1NjQgZGVzdF9hcGVydHVyZV9vZmZzZXQgPSB2Z3B1
X2d1ZXN0X2FwZXJ0dXJlX29mZnNldCh2Z3B1KTsKKwl1NjQgYXBlcnR1cmVfc3ogPSB2Z3B1X2Fw
ZXJ0dXJlX3N6KHZncHUpOworCXU2NCBkZXN0X2hpZGRlbl9nbV9vZmZzZXQgPSB2Z3B1X2d1ZXN0
X2hpZGRlbl9vZmZzZXQodmdwdSk7CisJdTY0IGhpZGRlbl9nbV9zeiA9IHZncHVfaGlkZGVuX3N6
KHZncHUpOworCisJZ3Z0X2RiZ19jb3JlKCJHdWVzdCBhcGVydHVyZT0weCVsbHggKEhXOiAweCVs
bHgpLCBHdWVzdCBIaWRkZW49MHglbGx4IChIVzoweCVsbHgpXG4iLAorCQlkZXN0X2FwZXJ0dXJl
X29mZnNldCwgdmdwdV9hcGVydHVyZV9vZmZzZXQodmdwdSksCisJCWRlc3RfaGlkZGVuX2dtX29m
ZnNldCwgdmdwdV9oaWRkZW5fb2Zmc2V0KHZncHUpKTsKKworCWlmICgoc2l6ZT4+c2hpZnQpICE9
CisJCQkoKGFwZXJ0dXJlX3N6ICsgaGlkZGVuX2dtX3N6KSA+PiBJOTE1X0dUVF9QQUdFX1NISUZU
KSkgeworCQlndnRfZXJyKCJnZ3R0IHJlc3RvcmUgZmFpbGVkIGR1ZSB0byBwYWdlIHRhYmxlIHNp
emUgbm90IG1hdGNoXG4iKTsKKwkJcmV0dXJuIElOVjsKKwl9CisKKwlyZXQgPSAwOworCXNyYyA9
IG9iai0+aW1nICsgb2JqLT5vZmZzZXQ7CisKKwkvKiBhcGVydHVyZSAqLworCXN6ID0gbWlnX2dn
dHRfc2F2ZV9yZXN0b3JlKGdndHRfbW0sCisJCXNyYywgZGVzdF9hcGVydHVyZV9vZmZzZXQsIGFw
ZXJ0dXJlX3N6LCBmYWxzZSk7CisJc3JjICs9IHN6OworCXJldCArPSBzejsKKworCS8qIGhpZGRl
biBHTSAqLworCXN6ID0gbWlnX2dndHRfc2F2ZV9yZXN0b3JlKGdndHRfbW0sIHNyYywKKwkJCWRl
c3RfaGlkZGVuX2dtX29mZnNldCwgaGlkZGVuX2dtX3N6LCBmYWxzZSk7CisJcmV0ICs9IHN6Owor
CisJLyogYXBlcnR1cmUvaGlkZGVuIEdUVCBlbXVsYXRpb24gZnJvbSBTb3VyY2UgdG8gVGFyZ2V0
ICovCisJZm9yIChnZ3R0X2luZGV4ID0gMDsKKwkgICAgIGdndHRfaW5kZXggPCAoZ3Z0X2dndHRf
Z21fc3oodmdwdS0+Z3Z0KSA+PiBJOTE1X0dUVF9QQUdFX1NISUZUKTsKKwkgICAgIGdndHRfaW5k
ZXgrKykgeworCisJCWlmICh2Z3B1X2dtYWRyX2lzX3ZhbGlkKHZncHUsCisJCQkJCWdndHRfaW5k
ZXggPDwgSTkxNV9HVFRfUEFHRV9TSElGVCkpIHsKKwkJCXN0cnVjdCBpbnRlbF9ndnRfZ3R0X3B0
ZV9vcHMgKm9wcyA9CisJCQkJCXZncHUtPmd2dC0+Z3R0LnB0ZV9vcHM7CisJCQlzdHJ1Y3QgaW50
ZWxfZ3Z0X2d0dF9lbnRyeSBlOworCQkJdTY0IG9mZnNldDsKKwkJCXU2NCBwYTsKKworCQkJLyog
VE9ETzogaGFyZGNvZGUgdG8gNjRiaXQgcmlnaHQgbm93ICovCisJCQlvZmZzZXQgPSB2Z3B1LT5n
dnQtPmRldmljZV9pbmZvLmd0dF9zdGFydF9vZmZzZXQKKwkJCQkrIChnZ3R0X2luZGV4PDxzaGlm
dCk7CisKKwkJCXBhID0gaW50ZWxfdmdwdV9tbWlvX29mZnNldF90b19ncGEodmdwdSwgb2Zmc2V0
KTsKKworCQkJLyogcmVhZCBvdXQgdmlydHVhbCBHVFQgZW50aXR5IGFuZAorCQkJICogdHJpZ2dl
ciBlbXVsYXRlIHdyaXRlCisJCQkgKi8KKwkJCWdndHRfZ2V0X2d1ZXN0X2VudHJ5KGdndHRfbW0s
ICZlLCBnZ3R0X2luZGV4KTsKKwkJCWlmIChvcHMtPnRlc3RfcHJlc2VudCgmZSkpIHsKKwkJCS8q
IHNhbWUgYXMgZ3R0X2VtdWxhdGUKKwkJCSAqIF93cml0ZSh2Z3QsIG9mZnNldCwgJmUudmFsNjQs
IDE8PHNoaWZ0KTsKKwkJCSAqIFVzaW5nIHZndF9lbXVsYXRlX3dyaXRlIGFzIHRvIGFsaWduIHdp
dGggdlJlZyBsb2FkCisJCQkgKi8KKwkJCQlpbnRlbF92Z3B1X2VtdWxhdGVfbW1pb193cml0ZSh2
Z3B1LCBwYSwKKwkJCQkJCQkmZS52YWw2NCwgMTw8c2hpZnQpOworCQkJfQorCQl9CisJfQorCisJ
cmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCB2Z3B1X3NhdmUoY29uc3Qgdm9pZCAqaW1nKQor
eworCXN0cnVjdCBndnRfbWlncmF0aW9uX29ial90ICpub2RlOworCWludCBuX2ltZ19hY3R1YWxf
c2F2ZWQgPSAwOworCisJLyogZ28gYnkgb2JqIHJ1bGVzIG9uZSBieSBvbmUgKi8KKwlGT1JfRUFD
SF9PQkoobm9kZSwgZ3Z0X2RldmljZV9vYmpzKSB7CisJCWludCBuX2ltZyA9IElOVjsKKworCQkv
KiBvYmogd2lsbCBjb3B5IGRhdGEgdG8gaW1hZ2UgZmlsZSBpbWcub2Zmc2V0ICovCisJCXVwZGF0
ZV9pbWFnZV9yZWdpb25fc3RhcnRfcG9zKG5vZGUsIG5faW1nX2FjdHVhbF9zYXZlZCk7CisJCWlm
IChub2RlLT5vcHMtPnByZV9zYXZlID09IE5VTEwpIHsKKwkJCW5faW1nID0gMDsKKwkJfSBlbHNl
IHsKKwkJCW5faW1nID0gbm9kZS0+b3BzLT5wcmVfc2F2ZShub2RlKTsKKwkJCWlmIChuX2ltZyA9
PSBJTlYpIHsKKwkJCQlndnRfZXJyKCJTYXZlIG9iaiAlcyBmYWlsZWRcbiIsCisJCQkJCQlub2Rl
LT5uYW1lKTsKKwkJCQluX2ltZ19hY3R1YWxfc2F2ZWQgPSBJTlY7CisJCQkJYnJlYWs7CisJCQl9
CisJCX0KKwkJLyogc2hvdyBHUkVFTiBvbiBzY3JlZW4gd2l0aCBjb2xvcnJlZCB0ZXJtICovCisJ
CWd2dF9kYmdfY29yZSgiU2F2ZSBvYmogJXMgc3VjY2VzcyB3aXRoICVkIGJ5dGVzXG4iLAorCQkJ
ICAgICAgIG5vZGUtPm5hbWUsIG5faW1nKTsKKwkJbl9pbWdfYWN0dWFsX3NhdmVkICs9IG5faW1n
OworCisJCWlmIChuX2ltZ19hY3R1YWxfc2F2ZWQgPj0gTUlHUkFUSU9OX0lNR19NQVhfU0laRSkg
eworCQkJZ3Z0X2VycigiSW1hZ2Ugc2l6ZSBvdmVyZmxvdyEhISBkYXRhPSVkIE1BWD0lbGRcbiIs
CisJCQkJbl9pbWdfYWN0dWFsX3NhdmVkLAorCQkJCU1JR1JBVElPTl9JTUdfTUFYX1NJWkUpOwor
CQkJLyogTWFyayBhcyBpbnZhbGlkICovCisJCQluX2ltZ19hY3R1YWxfc2F2ZWQgPSBJTlY7CisJ
CQlicmVhazsKKwkJfQorCX0KKwkvKiB1cGRhdGUgdGhlIGhlYWRlciB3aXRoIHJlYWwgaW1hZ2Ug
c2l6ZSAqLworCW5vZGUgPSBmaW5kX21pZ3JhdGlvbl9vYmooR1ZUX01JR1JBVElPTl9IRUFEKTsK
Kwl1cGRhdGVfaW1hZ2VfcmVnaW9uX3N0YXJ0X3Bvcyhub2RlLCBuX2ltZ19hY3R1YWxfc2F2ZWQp
OworCW5vZGUtPm9wcy0+cHJlX3NhdmUobm9kZSk7CisJcmV0dXJuIG5faW1nX2FjdHVhbF9zYXZl
ZDsKK30KKworc3RhdGljIGludCB2Z3B1X3Jlc3RvcmUodm9pZCAqaW1nKQoreworCXN0cnVjdCBn
dnRfbWlncmF0aW9uX29ial90ICpub2RlOworCXN0cnVjdCBndnRfcmVnaW9uX3QgcmVnaW9uOwor
CWludCBuX2ltZ19hY3R1YWxfcmVjdiA9IDA7CisJdTMyIG5faW1nX2FjdHVhbF9zaXplOworCisJ
LyogbG9hZCBpbWFnZSBoZWFkZXIgYXQgZmlyc3QgdG8gZ2V0IHJlYWwgc2l6ZSAqLworCW1lbWNw
eSgmcmVnaW9uLCBpbWcsIHNpemVvZihzdHJ1Y3QgZ3Z0X3JlZ2lvbl90KSk7CisJaWYgKHJlZ2lv
bi50eXBlICE9IEdWVF9NSUdSQVRJT05fSEVBRCkgeworCQlndnRfZXJyKCJJbnZhbGlkIGltYWdl
LiBEb2Vzbid0IHN0YXJ0IHdpdGggaW1hZ2VfaGVhZFxuIik7CisJCXJldHVybiBJTlY7CisJfQor
CisJbl9pbWdfYWN0dWFsX3JlY3YgKz0gc2l6ZW9mKHN0cnVjdCBndnRfcmVnaW9uX3QpOworCW5v
ZGUgPSBmaW5kX21pZ3JhdGlvbl9vYmoocmVnaW9uLnR5cGUpOworCXVwZGF0ZV9pbWFnZV9yZWdp
b25fc3RhcnRfcG9zKG5vZGUsIG5faW1nX2FjdHVhbF9yZWN2KTsKKwluX2ltZ19hY3R1YWxfc2l6
ZSA9IG5vZGUtPm9wcy0+cHJlX2xvYWQobm9kZSwgcmVnaW9uLnNpemUpOworCWlmIChuX2ltZ19h
Y3R1YWxfc2l6ZSA9PSBJTlYpIHsKKwkJZ3Z0X2VycigiTG9hZCBpbWcgJXMgZmFpbGVkXG4iLCBu
b2RlLT5uYW1lKTsKKwkJcmV0dXJuIElOVjsKKwl9CisKKwlpZiAobl9pbWdfYWN0dWFsX3NpemUg
Pj0gTUlHUkFUSU9OX0lNR19NQVhfU0laRSkgeworCQlndnRfZXJyKCJJbnZhbGlkIGltYWdlLiBt
YWdpY19pZCBvZmZzZXQgPSAweCV4XG4iLAorCQkJCW5faW1nX2FjdHVhbF9zaXplKTsKKwkJcmV0
dXJuIElOVjsKKwl9CisKKwluX2ltZ19hY3R1YWxfcmVjdiArPSBzaXplb2Yoc3RydWN0IGd2dF9p
bWFnZV9oZWFkZXJfdCk7CisKKwlkbyB7CisJCWludCBuX2ltZyA9IElOVjsKKwkJLyogcGFyc2Ug
ZWFjaCByZWdpb24gaGVhZCB0byBnZXQgdHlwZSBhbmQgc2l6ZSAqLworCQltZW1jcHkoJnJlZ2lv
biwgaW1nICsgbl9pbWdfYWN0dWFsX3JlY3YsCisJCQkJc2l6ZW9mKHN0cnVjdCBndnRfcmVnaW9u
X3QpKTsKKwkJbm9kZSA9IGZpbmRfbWlncmF0aW9uX29iaihyZWdpb24udHlwZSk7CisJCWlmIChu
b2RlID09IE5VTEwpCisJCQlicmVhazsKKwkJbl9pbWdfYWN0dWFsX3JlY3YgKz0gc2l6ZW9mKHN0
cnVjdCBndnRfcmVnaW9uX3QpOworCQl1cGRhdGVfaW1hZ2VfcmVnaW9uX3N0YXJ0X3Bvcyhub2Rl
LCBuX2ltZ19hY3R1YWxfcmVjdik7CisKKwkJaWYgKG5vZGUtPm9wcy0+cHJlX2xvYWQgPT0gTlVM
TCkgeworCQkJbl9pbWcgPSAwOworCQl9IGVsc2UgeworCQkJbl9pbWcgPSBub2RlLT5vcHMtPnBy
ZV9sb2FkKG5vZGUsIHJlZ2lvbi5zaXplKTsKKwkJCWlmIChuX2ltZyA9PSBJTlYpIHsKKwkJCQkv
KiBFcnJvciBvY2N1cnJlZC4gY29sb3JlZCBhcyBSRUQgKi8KKwkJCQlndnRfZXJyKCJMb2FkIG9i
aiAlcyBmYWlsZWRcbiIsCisJCQkJCQlub2RlLT5uYW1lKTsKKwkJCQluX2ltZ19hY3R1YWxfcmVj
diA9IElOVjsKKwkJCQlicmVhazsKKwkJCX0KKwkJfQorCQkvKiBzaG93IEdSRUVOIG9uIHNjcmVl
biB3aXRoIGNvbG9ycmVkIHRlcm0gKi8KKwkJZ3Z0X2RiZ19jb3JlKCJMb2FkIG9iaiAlcyBzdWNj
ZXNzIHdpdGggJWQgYnl0ZXMuXG4iLAorCQkJICAgICAgIG5vZGUtPm5hbWUsIG5faW1nKTsKKwkJ
bl9pbWdfYWN0dWFsX3JlY3YgKz0gbl9pbWc7CisJfSB3aGlsZSAobl9pbWdfYWN0dWFsX3JlY3Yg
PCBNSUdSQVRJT05fSU1HX01BWF9TSVpFKTsKKworCXJldHVybiBuX2ltZ19hY3R1YWxfcmVjdjsK
K30KKworaW50IGludGVsX2d2dF9zYXZlX3Jlc3RvcmUoc3RydWN0IGludGVsX3ZncHUgKnZncHUs
IGNoYXIgKmJ1Ziwgc2l6ZV90IGNvdW50LAorCQkJICAgdm9pZCAqYmFzZSwgdWludDY0X3Qgb2Zm
LCBib29sIHJlc3RvcmUpCit7CisJc3RydWN0IGd2dF9taWdyYXRpb25fb2JqX3QgKm5vZGU7CisJ
aW50IHJldCA9IDA7CisKKwltdXRleF9sb2NrKCZndnRfbWlncmF0aW9uKTsKKworCUZPUl9FQUNI
X09CSihub2RlLCBndnRfZGV2aWNlX29ianMpIHsKKwkJdXBkYXRlX2ltYWdlX3JlZ2lvbl9iYXNl
KG5vZGUsIGJhc2UgKyBvZmYpOworCQl1cGRhdGVfaW1hZ2VfcmVnaW9uX3N0YXJ0X3Bvcyhub2Rl
LCBJTlYpOworCQl1cGRhdGVfc3RhdHVzX3JlZ2lvbl9iYXNlKG5vZGUsIHZncHUpOworCX0KKwor
CWlmIChyZXN0b3JlKSB7CisJCXZncHUtPnB2X25vdGlmaWVkID0gdHJ1ZTsKKwkJaWYgKHZncHVf
cmVzdG9yZShiYXNlICsgb2ZmKSA9PSBJTlYpIHsKKwkJCXJldCA9IC1FRkFVTFQ7CisJCQlnb3Rv
IGV4aXQ7CisJCX0KKwl9IGVsc2UgeworCQlpZiAodmdwdV9zYXZlKGJhc2UgKyBvZmYpID09IElO
VikgeworCQkJcmV0ID0gLUVGQVVMVDsKKwkJCWdvdG8gZXhpdDsKKwkJfQorCisJfQorCitleGl0
OgorCW11dGV4X3VubG9jaygmZ3Z0X21pZ3JhdGlvbik7CisKKwlyZXR1cm4gcmV0OworfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21pZ3JhdGUuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d2dC9taWdyYXRlLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi45OWVjYjRlZGE1NTMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvbWlncmF0ZS5oCkBAIC0wLDAgKzEsOTcgQEAKKy8qCisgKiBDb3B5cmlnaHQoYykg
MjAxMS0yMDE2IEludGVsIENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAq
IFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVy
c29uIG9idGFpbmluZyBhCisgKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQg
ZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLAorICogdG8gZGVhbCBpbiB0aGUg
U29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlv
bgorICogdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRp
c3RyaWJ1dGUsIHN1YmxpY2Vuc2UsCisgKiBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3
YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUKKyAqIFNvZnR3YXJlIGlzIGZ1
cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6Cisg
KgorICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3Rp
Y2UgKGluY2x1ZGluZyB0aGUgbmV4dAorICogcGFyYWdyYXBoKSBzaGFsbCBiZSBpbmNsdWRlZCBp
biBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZQorICogU29mdHdhcmUu
CisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFO
VFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9U
IExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICogRklUTkVT
UyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVW
RU5UIFNIQUxMCisgKiBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUg
Rk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUgorICogTElBQklMSVRZLCBXSEVUSEVSIElO
IEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwK
KyAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0Ug
T1IgT1RIRVIgREVBTElOR1MgSU4gVEhFCisgKiBTT0ZUV0FSRS4KKyAqCisgKiBBdXRob3JzOgor
ICogICAgWXVsZWkgWmhhbmcgPHl1bGVpLnpoYW5nQGludGVsLmNvbT4KKyAqICAgIFhpYW8gWmhl
bmcgPHhpYW8uemhlbmdAaW50ZWwuY29tPgorICovCisKKyNpZm5kZWYgX19HVlRfTUlHUkFURV9I
X18KKyNkZWZpbmUgX19HVlRfTUlHUkFURV9IX18KKworI2RlZmluZSBNSUdSQVRJT05fRElSVFlf
QklUTUFQX1NJWkUgKDE2KjEwMjRVTCkKKworLyogQXNzdW1lIDlNQiBpcyBlbm91Z2ggdG8gZGVz
Y3JpcHQgVk0ga2VybmVsIHN0YXRlICovCisjZGVmaW5lIE1JR1JBVElPTl9JTUdfTUFYX1NJWkUg
KDkqMTAyNFVMKjEwMjRVTCkKKyNkZWZpbmUgR1ZUX01NSU9fU0laRSAoMioxMDI0VUwqMTAyNFVM
KQorI2RlZmluZSBHVlRfTUlHUkFUSU9OX1ZFUlNJT04JMAorCitlbnVtIGd2dF9taWdyYXRpb25f
dHlwZV90IHsKKwlHVlRfTUlHUkFUSU9OX05PTkUsCisJR1ZUX01JR1JBVElPTl9IRUFELAorCUdW
VF9NSUdSQVRJT05fQ0ZHX1NQQUNFLAorCUdWVF9NSUdSQVRJT05fVlJFRywKKwlHVlRfTUlHUkFU
SU9OX1NSRUcsCisJR1ZUX01JR1JBVElPTl9HVFQsCisJR1ZUX01JR1JBVElPTl9QUEdUVCwKKwlH
VlRfTUlHUkFUSU9OX1dPUktMT0FELAorCUdWVF9NSUdSQVRJT05fRVhFQ0xJU1QsCit9OworCitz
dHJ1Y3QgZ3Z0X3BwZ3R0X2VudHJ5X3QgeworCWludCBwYWdlX3RhYmxlX2xldmVsOworCXU2NCBw
ZHBbNF07Cit9OworCitzdHJ1Y3QgZ3Z0X3BlbmRpbmdfd29ya2xvYWRfdCB7CisJaW50IHJpbmdf
aWQ7CisJYm9vbCBlbXVsYXRlX3NjaGVkdWxlX2luOworCXN0cnVjdCBleGVjbGlzdF9jdHhfZGVz
Y3JpcHRvcl9mb3JtYXQgY3R4X2Rlc2M7CisJc3RydWN0IGludGVsX3ZncHVfZWxzcF9kd29yZHMg
ZWxzcF9kd29yZHM7Cit9OworCitzdHJ1Y3QgZ3Z0X3JlZ2lvbl90IHsKKwllbnVtIGd2dF9taWdy
YXRpb25fdHlwZV90IHR5cGU7CisJdTMyIHNpemU7CQkvKiBvYmogc2l6ZSBvZiBieXRlcyB0byBy
ZWFkL3dyaXRlICovCit9OworCitzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCB7CisJdm9pZCAq
aW1nOworCXZvaWQgKnZncHU7CisJdTMyIG9mZnNldDsKKwlzdHJ1Y3QgZ3Z0X3JlZ2lvbl90IHJl
Z2lvbjsKKwkvKiBvcGVyYXRpb24gZnVuYyBkZWZpbmVzIGhvdyBkYXRhIHNhdmUtcmVzdG9yZSAq
LworCXN0cnVjdCBndnRfbWlncmF0aW9uX29wZXJhdGlvbl90ICpvcHM7CisJY2hhciAqbmFtZTsK
K307CisKK3N0cnVjdCBndnRfbWlncmF0aW9uX29wZXJhdGlvbl90IHsKKwkvKiBjYWxsZWQgZHVy
aW5nIHByZS1jb3B5IHN0YWdlLCBWTSBpcyBzdGlsbCBhbGl2ZSAqLworCWludCAoKnByZV9jb3B5
KShjb25zdCBzdHJ1Y3QgZ3Z0X21pZ3JhdGlvbl9vYmpfdCAqb2JqKTsKKwkvKiBjYWxsZWQgYmVm
b3JlIHdoZW4gVk0gd2FzIHBhdXNlZCwKKwkgKiByZXR1cm4gYnl0ZXMgdHJhbnNmZXJyZWQKKwkg
Ki8KKwlpbnQgKCpwcmVfc2F2ZSkoY29uc3Qgc3RydWN0IGd2dF9taWdyYXRpb25fb2JqX3QgKm9i
aik7CisJLyogY2FsbGVkIGJlZm9yZSBsb2FkIHRoZSBzdGF0ZSBvZiBkZXZpY2UgKi8KKwlpbnQg
KCpwcmVfbG9hZCkoY29uc3Qgc3RydWN0IGd2dF9taWdyYXRpb25fb2JqX3QgKm9iaiwgdTMyIHNp
emUpOworCS8qIGNhbGxlZCBhZnRlciBsb2FkIHRoZSBzdGF0ZSBvZiBkZXZpY2UsIFZNIGFscmVh
ZHkgYWxpdmUgKi8KKwlpbnQgKCpwb3N0X2xvYWQpKGNvbnN0IHN0cnVjdCBndnRfbWlncmF0aW9u
X29ial90ICpvYmosIHUzMiBzaXplKTsKK307CisKK3N0cnVjdCBndnRfaW1hZ2VfaGVhZGVyX3Qg
eworCWludCB2ZXJzaW9uOworCWludCBkYXRhX3NpemU7CisJdTY0IGNyY19jaGVjazsKKwl1NjQg
Z2xvYmFsX2RhdGFbNjRdOworfTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndnQvbW1pby5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21taW8uYwppbmRl
eCA0M2Y2NTg0OGVjZDYuLjYyMjFkMmYyNzRmYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L21taW8uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pby5jCkBA
IC01MCw2ICs1MCwxOSBAQCBpbnQgaW50ZWxfdmdwdV9ncGFfdG9fbW1pb19vZmZzZXQoc3RydWN0
IGludGVsX3ZncHUgKnZncHUsIHU2NCBncGEpCiAJcmV0dXJuIGdwYSAtIGd0dG1taW9fZ3BhOwog
fQogCisvKioKKyAqIGludGVsX3ZncHVfbW1pb19vZmZzZXRfdG9fR1BBIC0gdHJhbnNsYXRlIGEg
TU1JTyBvZmZzZXQgdG8gR1BBCisgKiBAdmdwdTogYSB2R1BVCisgKgorICogUmV0dXJuczoKKyAq
IFplcm8gb24gc3VjY2VzcywgbmVnYXRpdmUgZXJyb3IgY29kZSBpZiBmYWlsZWQKKyAqLworaW50
IGludGVsX3ZncHVfbW1pb19vZmZzZXRfdG9fZ3BhKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB1
NjQgb2Zmc2V0KQoreworCXJldHVybiBvZmZzZXQgKyAoKCoodTY0ICopKHZncHVfY2ZnX3NwYWNl
KHZncHUpICsgUENJX0JBU0VfQUREUkVTU18wKSkgJgorCQl+R0VOTUFTSygzLCAwKSk7Cit9CisK
ICNkZWZpbmUgcmVnX2lzX21taW8oZ3Z0LCByZWcpICBcCiAJKHJlZyA+PSAwICYmIHJlZyA8IGd2
dC0+ZGV2aWNlX2luZm8ubW1pb19zaXplKQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvbW1pby5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21taW8uaAppbmRleCAx
ZmZjNjllYmEzMGUuLmEyYmRkYjAyNTdjZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L21taW8uaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pby5oCkBAIC04
Miw2ICs4Miw3IEBAIHZvaWQgaW50ZWxfdmdwdV9yZXNldF9tbWlvKHN0cnVjdCBpbnRlbF92Z3B1
ICp2Z3B1LCBib29sIGRtbHIpOwogdm9pZCBpbnRlbF92Z3B1X2NsZWFuX21taW8oc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUpOwogCiBpbnQgaW50ZWxfdmdwdV9ncGFfdG9fbW1pb19vZmZzZXQoc3Ry
dWN0IGludGVsX3ZncHUgKnZncHUsIHU2NCBncGEpOworaW50IGludGVsX3ZncHVfbW1pb19vZmZz
ZXRfdG9fZ3BhKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB1NjQgb2Zmc2V0KTsKIAogaW50IGlu
dGVsX3ZncHVfZW11bGF0ZV9tbWlvX3JlYWQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHU2NCBw
YSwKIAkJCQl2b2lkICpwX2RhdGEsIHVuc2lnbmVkIGludCBieXRlcyk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvdmdwdS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0
L3ZncHUuYwppbmRleCBmY2NjZGEzNWE0NTYuLjc2NzZkY2ZkY2EwOSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3ZncHUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dnQvdmdwdS5jCkBAIC0yMTMsNiArMjEzLDcgQEAgdm9pZCBpbnRlbF9ndnRfYWN0aXZhdGVfdmdw
dShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIHsKIAltdXRleF9sb2NrKCZ2Z3B1LT5ndnQtPmxv
Y2spOwogCXZncHUtPmFjdGl2ZSA9IHRydWU7CisJaW50ZWxfdmdwdV9zdGFydF9zY2hlZHVsZSh2
Z3B1KTsKIAltdXRleF91bmxvY2soJnZncHUtPmd2dC0+bG9jayk7CiB9CiAKLS0gCjIuMTcuMQoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KaW50ZWwtZ3Z0
LWRldiBtYWlsaW5nIGxpc3QKaW50ZWwtZ3Z0LWRldkBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1ndnQtZGV2
